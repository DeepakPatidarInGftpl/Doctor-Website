"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[2730],{2730:(x,f,c)=>{c.r(f),c.d(f,{EditbrandModule:()=>D});var d=c(36895),u=c(88996),a=c(24006),t=c(94650),v=c(80927),S=c(97185),g=c(42917);function A(n,s){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Enter Title "),t.qZA())}function b(n,s){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Enter code "),t.qZA())}function _(n,s){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Enter discount (ex-1-100) "),t.qZA())}const l=function(n){return{"is-invalid":n}};function p(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"a",28)(1,"input",29,30),t.NdJ("change",function(i){t.CHM(o);const r=t.oxw();return t.KtG(r.onCheckCategory(i))}),t.qZA(),t.TgZ(3,"label",31),t.NdJ("click",function(i){t.CHM(o);const r=t.oxw();return t.KtG(r.onLabelClick(i))}),t._uU(4),t.qZA()()}if(2&n){const o=s.$implicit,e=s.index,i=t.oxw();t.xp6(1),t.Q6J("value",o.id)("checked",i.selectCat.includes(o.id))("ngClass",t.VKq(6,l,i.f.category.touched&&i.f.category.invalid))("id","checkboxCat-"+e),t.xp6(2),t.Q6J("for","checkboxCat-"+e),t.xp6(1),t.Oqu(o.title)}}function h(n,s){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const o=t.oxw();t.xp6(1),t.Oqu(o.selectedCat+" Category Selected")}}function m(n,s){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Select Category "),t.qZA())}function y(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"a",28)(1,"input",32),t.NdJ("change",function(i){t.CHM(o);const r=t.oxw();return t.KtG(r.onCheckSize(i))}),t.qZA(),t.TgZ(2,"label",31),t.NdJ("click",function(i){t.CHM(o);const r=t.oxw();return t.KtG(r.onLabelClick(i))}),t._uU(3),t.qZA()()}if(2&n){const o=s.$implicit,e=s.index,i=t.oxw();t.xp6(1),t.Q6J("value",o.id)("ngClass",t.VKq(6,l,i.f.subcategory_group.touched&&i.f.subcategory_group.invalid))("id","checkbox-"+e)("checked",i.subcatGroup.includes(o.id)),t.xp6(1),t.Q6J("for","checkbox-"+e),t.xp6(1),t.Oqu(o.title)}}function C(n,s){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const o=t.oxw();t.xp6(1),t.Oqu(o.selectedSubCatGrp+" Subcategory group Selected")}}function T(n,s){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Select subcategory group "),t.qZA())}function E(n,s){if(1&n){const o=t.EpF();t.TgZ(0,"a",28)(1,"input",33),t.NdJ("change",function(i){t.CHM(o);const r=t.oxw();return t.KtG(r.onCheckChange(i))}),t.qZA(),t.TgZ(2,"label",31),t.NdJ("click",function(i){t.CHM(o);const r=t.oxw();return t.KtG(r.onLabelClick(i))}),t._uU(3),t.qZA()()}if(2&n){const o=s.$implicit,e=s.index,i=t.oxw();t.xp6(1),t.Q6J("value",o.id)("checked",i.selectSubcat.includes(o.id))("ngClass",t.VKq(6,l,i.f.subcategory.touched&&i.f.subcategory.invalid))("id","checkboxSub-"+e),t.xp6(1),t.Q6J("for","checkboxSub-"+e),t.xp6(1),t.Oqu(o.title)}}function F(n,s){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const o=t.oxw();t.xp6(1),t.Oqu(o.selectedSubcat+" Subcategory Selected")}}function I(n,s){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Select subcategory "),t.qZA())}function w(n,s){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Select image"),t.qZA())}function G(n,s){if(1&n&&t._UZ(0,"img",34),2&n){const o=t.oxw();t.Q6J("src",o.url,t.LSH)}}function N(n,s){if(1&n&&t._UZ(0,"img",34),2&n){const o=t.oxw();t.Q6J("src",o.imgUrl+o.updateData.image,t.LSH)}}function U(n,s){1&n&&(t.TgZ(0,"button",35),t._uU(1,"Submit"),t.qZA())}function J(n,s){1&n&&(t.TgZ(0,"button",36),t._UZ(1,"span",37),t._uU(2,"Submit"),t.qZA())}const M=[{path:"",component:(()=>{class n{constructor(o,e,i,r,Z,L){this.coreService=o,this.fb=e,this.Arout=i,this.toastr=r,this.router=Z,this.cs=L,this.show=!1,this.imgUrl="https://pv.greatfuturetechno.com",this.dropdownList=[],this.selectedItems=[],this.dropdownSettings={},this.subcatGroup=[],this.selectSubcat=[],this.selectCat=[],this.selectedCat=0,this.subcategories=[],this.selectedSubcat=0,this.selectedSubCatGrp=0,this.loaders=!1}get f(){return this.brandForm.controls}ngOnInit(){this.id=this.Arout.snapshot.paramMap.get("id"),this.brandForm=new a.cw({title:new a.NI("",[a.kI.required]),code:new a.NI(""),image:new a.NI(""),discount:new a.NI("",[a.kI.pattern(/^(100|[0-9]{1,2})$/)]),category:new a.Oe([]),subcategory_group:new a.Oe([],[a.kI.required]),subcategory:new a.Oe([],[a.kI.required])}),this.dropdownSettings={singleSelection:!1,idField:"id",textField:"product_title",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:3,allowSearchFilter:!0},this.coreService.getbrandById(this.id).subscribe(o=>{console.log(o),this.url="",this.id==o.id&&(console.log(o),this.updateData=o,this.subcatId=o.subcategory_group[0].id,console.log(this.subcatId),this.subcatGroup=o?.subcategory_group.map(e=>e.id),this.selectSubcat=o?.subcategory.map(e=>e.id),this.selectCat=o?.category.map(e=>e?.id),this.brandForm.patchValue({title:o.title,code:o.code,discount:o.discount}),o?.category.length>0?(console.log("categry"),this.getSubcatGroupByCategory(this.selectCat)):this.getSubcatGroup(),this.getSubcategoryBySubcatGroup(this.subcatGroup),this.getCategory())})}onItemSelect(o){console.log(o),this.brandForm.get("variant").push(new a.NI(o.id))}onItemDeselect(o){console.log("Item deselected:",o);let e=this.brandForm.get("variant");console.log(e);const i=e.controls.findIndex(r=>r.value===o.id);console.log(i),-1!==i&&e.removeAt(i)}onSelectAll(o){console.log(o);let e=this.brandForm.get("variant");o.forEach(i=>{e.push(new a.NI(i.id))})}onDeselectAll(o){console.log("All items deselected:",o),this.brandForm.get("variant").clear()}getCategory(){this.coreService.getCategory().subscribe(o=>{this.categoryList=o,this.categoryList.map(e=>{console.log(this.selectCat),console.log(this.selectCat.includes(e?.id),"category"),this.selectCat.includes(e.id)&&this.brandForm.get("category").push(new a.NI(e.id))})})}onCheckCategory(o){const e=this.brandForm.get("category");if(o.target.checked)e.push(new a.NI(parseInt(o.target.value))),this.check=e,this.selectedCat++,this.getSubcatGroupByCategory(e.value);else{let i=0;e.controls.forEach(r=>{if(r.value==o.target.value)return e.removeAt(i),this.selectedCat--,void this.getSubcatGroupByCategory(e.value);i++})}}getSubcatGroupByCategory(o){console.log(o);const e=JSON.stringify(o);this.coreService.getSubcategoryGroupByCategoryid(e).subscribe(i=>{console.log(i),this.subcatGroupList=i,this.subcatGroupList.map(r=>{console.log(this.subcatGroup.includes(r.id),"subcategory_group"),this.subcatGroup.includes(r.id)&&(console.log(r.id),this.brandForm.get("subcategory_group").push(new a.NI(r.id)))})})}onSelect(o){const e=o.target.files[0];if(console.log(e),e){const i=new FileReader;i.readAsDataURL(e),i.onload=()=>{this.url=i.result}}this.brandForm.patchValue({image:e}),this.brandForm.get("image")?.updateValueAndValidity()}getSubcatGroup(){this.coreService.getSubcategoryGroup().subscribe(o=>{this.subcatGroupList=o,this.subcatGroupList.map(e=>{console.log(this.subcatGroup.includes(e.id),"subcategory_group"),this.subcatGroup.includes(e.id)&&(console.log(e.id),this.brandForm.get("subcategory_group").push(new a.NI(e.id)))})})}onCheckSize(o){const e=this.brandForm.get("subcategory_group");if(o.target.checked)e.push(new a.NI(parseInt(o.target.value))),this.check=e,this.selectedSubCatGrp++,this.getSubcategoryBySubcatGroup(e.value);else{let i=0;e.controls.forEach(r=>{if(r.value==o.target.value)return e.removeAt(i),this.selectedSubCatGrp--,void this.getSubcategoryBySubcatGroup(e.value);i++})}}getSubcategoryBySubcatGroup(o){const e=JSON.stringify(o);this.coreService.getSubcategoryBySubcatGroupid(e).subscribe(i=>{console.log(i),this.subcatbySubcatGroup=i,this.subcatbySubcatGroup.map(r=>{console.log(this.selectSubcat),console.log(this.selectSubcat.includes(r.id),"subcategory"),this.selectSubcat.includes(r.id)&&this.brandForm.get("subcategory").push(new a.NI(r.id))})})}onCheckChange(o){const e=this.brandForm.get("subcategory");if(o.target.checked)e.push(new a.NI(parseInt(o.target.value))),this.check=e,this.selectedSubcat++;else{let i=0;e.controls.forEach(r=>{if(r.value==o.target.value)return e.removeAt(i),void this.selectedSubcat--;i++})}}update(){console.log(this.brandForm.value);var o=new FormData;if(o.append("title",this.brandForm.get("title")?.value),o.append("code",this.brandForm.get("code")?.value),o.append("discount",this.brandForm.get("discount")?.value),o.append("category",JSON.stringify(this.brandForm.get("category")?.value)),o.append("subcategory_group",JSON.stringify(this.brandForm.get("subcategory_group")?.value)),o.append("subcategory",JSON.stringify(this.brandForm.get("subcategory")?.value)),this.brandForm.valid){this.loaders=!0;const e=this.brandForm.get("image")?.value;e&&e instanceof File?(o.append("image",e),this.coreService.updatebrand(o,this.id).subscribe(i=>{console.log(i),this.addRes=i,"Brands updated successfully"==this.addRes.msg?(this.loaders=!1,this.toastr.success(this.addRes.msg),this.router.navigate(["//product/brandlist"]),this.updateData="",this.url="",this.brandForm.reset(),this.selectedSubcat=0,this.selectedSubCatGrp=0):this.loaders=!1},i=>{console.log(i.error.gst)})):this.coreService.updatebrand(o,this.id).subscribe(i=>{console.log(i),this.addRes=i,"Brands updated successfully"==this.addRes.msg&&(this.loaders=!1,this.updateData="",this.url="",this.toastr.success(this.addRes.msg),this.router.navigate(["//product/brandlist"]),this.brandForm.reset(),this.selectedSubcat=0,this.selectedSubCatGrp=0)},i=>{console.log(i.error.gst)})}else this.brandForm.markAllAsTouched(),console.log("forms invalid")}get title(){return this.brandForm.get("title")}get image(){return this.brandForm.get("image")}get code(){return this.brandForm.get("code")}get subcategory_group(){return this.brandForm.get("subcategory_group")}get subcategory(){return this.brandForm.get("subcategory")}get discount(){return this.brandForm.get("discount")}get category(){return this.brandForm.get("category")}onLabelClick(o){o.stopPropagation()}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(v.p),t.Y36(a.qu),t.Y36(u.gz),t.Y36(S._W),t.Y36(u.F0),t.Y36(g.J))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-editbrand"]],decls:86,vars:27,consts:[[1,"page-header"],[1,"page-title"],[1,"card"],[1,"card-body"],[1,"row"],[3,"formGroup","ngSubmit"],[1,"col-lg-6","col-sm-6","col-12"],[1,"form-group"],["type","text","formControlName","title","id","title",3,"ngClass"],["class","text-danger",4,"ngIf"],["type","text","formControlName","code","id","code",3,"ngClass"],["type","text","formControlName","discount","id","discount",3,"ngClass"],[1,"dropdown"],["type","button","type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"dropdown-toggle","button"],[1,"dropdown-menu",2,"width","100%"],["class","dropdown-item",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-lg-6"],[1,"image-upload"],["type","file","formControlName","image",3,"change"],[1,"image-uploads"],["src","assets/img/icons/upload.svg","alt","img"],["alt","","class","p_img",3,"src",4,"ngIf"],[1,"col-lg-12"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],["routerLink","//product/brandlist",1,"btn","btn-cancel"],[1,"text-danger"],[1,"dropdown-item"],["type","checkbox","formArrayName","category",2,"margin-right","5px",3,"value","checked","ngClass","id","change"],["categoryValue",""],[2,"margin-bottom","0",3,"for","click"],["type","checkbox","formArrayName","subcategory_group",2,"margin-right","5px",3,"value","ngClass","id","checked","change"],["type","checkbox","formArrayName","subcategory",2,"margin-right","5px",3,"value","checked","ngClass","id","change"],["alt","",1,"p_img",3,"src"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h4"),t._uU(3,"Brand Edit"),t.qZA(),t.TgZ(4,"h6"),t._uU(5,"Update your Brand"),t.qZA()()(),t.TgZ(6,"div",2)(7,"div",3)(8,"div",4)(9,"form",5),t.NdJ("ngSubmit",function(){return e.update()}),t.TgZ(10,"div",4)(11,"div",6)(12,"div",7)(13,"label"),t._uU(14,"Title*"),t.qZA(),t._UZ(15,"input",8),t.YNc(16,A,2,0,"span",9),t.qZA()(),t.TgZ(17,"div",6)(18,"div",7)(19,"label"),t._uU(20,"Code"),t.qZA(),t._UZ(21,"input",10),t.YNc(22,b,2,0,"span",9),t.qZA()(),t.TgZ(23,"div",6)(24,"div",7)(25,"label"),t._uU(26,"Discount"),t.qZA(),t._UZ(27,"input",11),t.YNc(28,_,2,0,"span",9),t.qZA()(),t.TgZ(29,"div",6)(30,"div",7)(31,"label"),t._uU(32,"Category"),t.qZA(),t.TgZ(33,"div",12)(34,"button",13),t._uU(35,"Select Category"),t.qZA(),t.TgZ(36,"ul",14)(37,"li"),t.YNc(38,p,5,8,"a",15),t.qZA()()(),t.YNc(39,h,2,1,"p",16),t.YNc(40,m,2,0,"span",9),t.qZA()(),t.TgZ(41,"div",6)(42,"div",7)(43,"label"),t._uU(44,"Subcategory group"),t.qZA(),t.TgZ(45,"div",12)(46,"button",13),t._uU(47,"Select Subcategory group"),t.qZA(),t.TgZ(48,"ul",14)(49,"li"),t.YNc(50,y,4,8,"a",15),t.qZA()()(),t.YNc(51,C,2,1,"p",16),t.YNc(52,T,2,0,"span",9),t.qZA()(),t.TgZ(53,"div",6)(54,"div",7)(55,"label"),t._uU(56,"SubCategory*"),t.qZA(),t.TgZ(57,"div",12)(58,"button",13),t._uU(59,"Select Subcategory"),t.qZA(),t.TgZ(60,"ul",14)(61,"li"),t.YNc(62,E,4,8,"a",15),t.qZA()()(),t.YNc(63,F,2,1,"p",16),t.YNc(64,I,2,0,"span",9),t.qZA()(),t.TgZ(65,"div",6)(66,"div",7)(67,"label"),t._uU(68," Brand Image*"),t.qZA(),t.TgZ(69,"div",4)(70,"div",17)(71,"div",18)(72,"input",19),t.NdJ("change",function(r){return e.onSelect(r)}),t.qZA(),t.TgZ(73,"div",20),t._UZ(74,"img",21),t.TgZ(75,"h4"),t._uU(76,"Drag and drop a file to upload"),t.qZA()(),t.YNc(77,w,2,0,"span",9),t.qZA()(),t.TgZ(78,"div",17),t.YNc(79,G,1,1,"img",22),t.YNc(80,N,1,1,"img",22),t.qZA()()()(),t.TgZ(81,"div",23),t.YNc(82,U,2,0,"button",24),t.YNc(83,J,3,0,"button",25),t.TgZ(84,"a",26),t._uU(85,"Cancel"),t.qZA()()()()()()()),2&o&&(t.xp6(9),t.Q6J("formGroup",e.brandForm),t.xp6(6),t.Q6J("ngClass",t.VKq(21,l,e.f.title.touched&&e.f.title.invalid)),t.xp6(1),t.Q6J("ngIf",e.title&&e.title.invalid&&e.title.touched),t.xp6(5),t.Q6J("ngClass",t.VKq(23,l,e.f.code.touched&&e.f.code.invalid)),t.xp6(1),t.Q6J("ngIf",e.code&&e.code.invalid&&e.code.touched),t.xp6(5),t.Q6J("ngClass",t.VKq(25,l,e.f.discount.touched&&e.f.discount.invalid)),t.xp6(1),t.Q6J("ngIf",e.discount&&e.discount.invalid&&e.discount.touched),t.xp6(10),t.Q6J("ngForOf",e.categoryList),t.xp6(1),t.Q6J("ngIf",e.selectedCat>0),t.xp6(1),t.Q6J("ngIf",e.category&&e.category.invalid&&e.category.touched),t.xp6(10),t.Q6J("ngForOf",e.subcatGroupList),t.xp6(1),t.Q6J("ngIf",e.selectedSubCatGrp>0),t.xp6(1),t.Q6J("ngIf",e.subcategory_group&&e.subcategory_group.invalid&&e.subcategory_group.touched),t.xp6(10),t.Q6J("ngForOf",e.subcatbySubcatGroup),t.xp6(1),t.Q6J("ngIf",e.selectedSubcat>0),t.xp6(1),t.Q6J("ngIf",e.subcategory&&e.subcategory.invalid&&e.subcategory.touched),t.xp6(13),t.Q6J("ngIf",e.image&&e.image.invalid&&e.image.touched),t.xp6(2),t.Q6J("ngIf",e.url),t.xp6(1),t.Q6J("ngIf",!e.url),t.xp6(2),t.Q6J("ngIf",!e.loaders),t.xp6(1),t.Q6J("ngIf",e.loaders))},dependencies:[d.mk,d.sg,d.O5,u.yS,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,a.CE],styles:['.table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child){border-top:none!important}.labelSize[_ngcontent-%COMP%]{display:flex;align-items:center}.entries[_ngcontent-%COMP%]{font-size:12px;color:#5e5873;font-weight:600}.labelSize[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border:1px solid #ced4da;width:80px;height:30px;padding:0;border-radius:3px}.thone[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{float:unset;margin-left:5px}@media (max-width: 765px){.thone[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{float:inherit;margin-top:0}}.fa-sort[_ngcontent-%COMP%]:before{content:"\\f0dc";right:.5em;color:#babfc7;font-size:12px;opacity:1}.ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}select[_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;padding:10px 15px;border-radius:5px}.button[_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;display:flex;padding:10px 15px;border-radius:5px;justify-content:space-between;align-items:center;background:white}.p_img[_ngcontent-%COMP%]{margin-right:3rem!important;height:100px}']}),n})(),canActivate:[c(30597).l],data:{allowedRoles:["change_brands"]}}];let k=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.Bz.forChild(M),u.Bz]}),n})();var P=c(8468);let D=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez,k,P.I]}),n})()},30597:(x,f,c)=>{c.d(f,{l:()=>S});var d=c(94650),u=c(88996),a=c(97185),t=c(42917),v=c(80927);let S=(()=>{class g{constructor(b,_,l,p,h){this.router=b,this.Arout=_,this.toastr=l,this.profileService=p,this.coreService=h}canActivate(b,_){const l=JSON.parse(localStorage.getItem("auth"));if(this.profileService.userDetails$.subscribe(p=>{this.userDetails=p,this.permissions=this.userDetails?.permission}),l){const p=b.data.allowedRoles;console.log(p,"allowedRoles");const h=l.some(m=>p.includes(m.codename));if(this.coreService.getProfile().subscribe(m=>{this.userDetails=m,this.profileService.setUserDetails(this.userDetails);const y=m?.permission,C=this.profileService.getUserDetails();(!C||C.length!==y.length)&&(this.profileService.setUserPermission(y),window.location.reload())}),console.log(h),h)return!0}return console.log(this.permissions,"permisiion guard"),this.toastr.error("User have Not Permission to Access This page"),this.router.navigate(["/dashboard"]),!1}}return g.\u0275fac=function(b){return new(b||g)(d.LFG(u.F0),d.LFG(u.gz),d.LFG(a._W),d.LFG(t.J),d.LFG(v.p))},g.\u0275prov=d.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()}}]);