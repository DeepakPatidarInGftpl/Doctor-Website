"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[8302],{98302:(q,y,c)=>{c.r(y),c.d(y,{AddstockVerificationModule:()=>z});var l=c(36895),_=c(4392),i=c(24006),t=c(94650),k=c(97185),b=c(42236),u=c(47957),x=c(3238),m=c(44144);function C(n,a){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Select voucher_date"),t.qZA())}function g(n,a){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Enter Voucher Number "),t.qZA())}function p(n,a){1&n&&(t.TgZ(0,"span",27),t._uU(1,"Enter Updater Name"),t.qZA())}function f(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"mat-option",29),t.NdJ("onSelectionChange",function(){t.CHM(e);const r=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.oncheckProduct(r))}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.Q6J("value",(null==e?null:e.product_title)+" "+(null==e?null:e.variant_name)),t.xp6(1),t.hij(" ",(null==e?null:e.product_title)+" "+(null==e?null:e.variant_name),"")}}function h(n,a){if(1&n&&(t.ynx(0),t.YNc(1,f,2,2,"mat-option",28),t.BQk()),2&n){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf",1==e.is_active)}}function A(n,a){if(1&n&&(t.ynx(0),t.YNc(1,h,2,1,"ng-container",22),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.variantList)}}function Z(n,a){1&n&&(t.TgZ(0,"mat-option",30)(1,"a",31),t._uU(2,"+add Product"),t.qZA()()),2&n&&t.Q6J("value","No data found")}function N(n,a){1&n&&(t.TgZ(0,"mat-option",32),t._uU(1," Please Enter 3 or more characters"),t.qZA())}function U(n,a){1&n&&(t.TgZ(0,"span",51),t._uU(1,"Select Product"),t.qZA())}function F(n,a){1&n&&(t.TgZ(0,"span",51),t._uU(1,"Select Product"),t.qZA())}function S(n,a){1&n&&(t.TgZ(0,"span",52),t._uU(1,"Enter Unit"),t.qZA())}function P(n,a){1&n&&(t.TgZ(0,"span",52),t._uU(1,"Enter System QTY"),t.qZA())}function J(n,a){1&n&&(t.TgZ(0,"span",52),t._uU(1,"Enter Physical QTY"),t.qZA())}function Q(n,a){1&n&&(t.TgZ(0,"span",52),t._uU(1,"Enter Discrepancy"),t.qZA())}function M(n,a){1&n&&(t.TgZ(0,"span",52),t._uU(1,"Enter Reason For Adjustment"),t.qZA())}function E(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr",33)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td")(5,"div")(6,"div",34),t.O4$(),t.TgZ(7,"svg",35),t.NdJ("click",function(){const s=t.CHM(e).index,d=t.oxw();return t.KtG(d.removeCart(s))}),t._UZ(8,"path",36)(9,"path",37),t.qZA()()()(),t.kcU(),t.TgZ(10,"td",38)(11,"fieldset",39),t._UZ(12,"input",40),t.YNc(13,U,2,0,"span",41),t.qZA()(),t.TgZ(14,"td",38)(15,"div",42)(16,"fieldset",43),t._UZ(17,"input",44),t.YNc(18,F,2,0,"span",41),t.qZA()()(),t.TgZ(19,"td"),t._UZ(20,"input",45),t.YNc(21,S,2,0,"span",46),t.qZA(),t.TgZ(22,"td")(23,"fieldset",43),t._UZ(24,"input",47),t.YNc(25,P,2,0,"span",46),t.qZA()(),t.TgZ(26,"td"),t._UZ(27,"input",48),t.YNc(28,J,2,0,"span",46),t.qZA(),t.TgZ(29,"td"),t._UZ(30,"input",49),t.YNc(31,Q,2,0,"span",46),t.qZA(),t.TgZ(32,"td"),t._UZ(33,"input",50),t.YNc(34,M,2,0,"span",46),t.qZA()(),t.BQk()}if(2&n){const e=a.$implicit,o=a.index,r=t.oxw();let s,d;t.xp6(1),t.Q6J("formGroupName",o),t.xp6(2),t.Oqu(o+1+"."),t.xp6(10),t.Q6J("ngIf",e.get("item_code")&&(null==(s=e.get("item_code"))?null:s.invalid)&&(null==(s=e.get("item_code"))?null:s.touched)),t.xp6(5),t.Q6J("ngIf",e.get("item_name")&&(null==(d=e.get("item_name"))?null:d.invalid)&&(null==(d=e.get("item_name"))?null:d.touched)),t.xp6(3),t.Q6J("ngIf",r.unit(o)&&r.unit(o).invalid&&r.unit(o).touched),t.xp6(4),t.Q6J("ngIf",r.system_qty(o)&&r.system_qty(o).invalid&&r.system_qty(o).touched),t.xp6(3),t.Q6J("ngIf",r.physical_qty(o)&&r.physical_qty(o).invalid&&r.physical_qty(o).touched),t.xp6(2),t.Q6J("ngModel",r.calculateDifference(o)),t.xp6(1),t.Q6J("ngIf",r.discrepancy(o)&&r.discrepancy(o).invalid&&r.discrepancy(o).touched),t.xp6(3),t.Q6J("ngIf",r.reason_for_adjustment(o)&&r.reason_for_adjustment(o).invalid&&r.reason_for_adjustment(o).touched)}}function O(n,a){1&n&&(t.TgZ(0,"button",53),t._uU(1,"Submit"),t.qZA())}function D(n,a){1&n&&(t.TgZ(0,"button",54),t._UZ(1,"span",55),t._uU(2," \xa0 Submit"),t.qZA())}const T=function(n){return{"is-invalid":n}},Y=[{path:"",component:(()=>{class n{constructor(e,o,r,s){this.fb=e,this.toastrService=o,this.inventoryService=r,this.router=s,this.productControl=new i.NI(""),this.filteredOptions=[],this.filteredItemCode=[],this.supplierControl=new i.NI(""),this.isCart=!1,this.myControl=new i.NI(""),this.variantList=[],this.loader=!1,this.indexProduct=0}get f(){return this.stokeVerificationForm.controls}ngOnInit(){const e=(new Date).toISOString().split("T")[0];this.stokeVerificationForm=this.fb.group({voucher_no:new i.NI("",[i.kI.required]),voucher_date:new i.NI(e,[i.kI.required]),updater_name:new i.NI("",[i.kI.required]),cart_item:this.fb.array([])}),this.getPrefix()}getPrefix(){this.inventoryService.getStockVerificationPrefix().subscribe(e=>{console.log(e),1==e.success?this.prefixNo=e.prefix:this.toastrService.error(e.msg)},e=>{this.toastrService.error(e.error.msg)})}cart(){return this.fb.group({barcode:new i.NI("",[i.kI.required]),item_code:new i.NI("",[i.kI.required]),item_name:new i.NI("",[i.kI.required]),unit:new i.NI("",[i.kI.required]),system_qty:new i.NI(0,[i.kI.required]),physical_qty:new i.NI(0,[i.kI.required]),discrepancy:new i.NI(0,[i.kI.required]),reason_for_adjustment:new i.NI("",[i.kI.required])})}getCart(){return this.stokeVerificationForm.get("cart_item")}addCart(e){this.getCart().push(this.cart()),this.isCart=!1}addCart2(e){this.getCart()?.push(this.cart())}removeCart(e){this.getCart().removeAt(e),this.indexProduct--,console.log(this.indexProduct),0==this.stokeVerificationForm?.value?.cart_item?.length&&(this.isCart=!0)}get voucher_no(){return this.stokeVerificationForm.get("voucher_no")}get voucher_date(){return this.stokeVerificationForm.get("voucher_date")}get updater_name(){return this.stokeVerificationForm.get("updater_name")}get text_box(){return this.stokeVerificationForm.get("text_box")}unit(e){return this.getCart().controls[e].get("unit")}discrepancy(e){return this.getCart().controls[e].get("discrepancy")}reason_for_adjustment(e){return this.getCart().controls[e].get("reason_for_adjustment")}system_qty(e){return this.getCart().controls[e].get("system_qty")}physical_qty(e){return this.getCart().controls[e].get("physical_qty")}isLastCart(e){return e===this.getCart().controls.length-1}oncheckVariant(e,o){console.log(e);const r=e.id;this.stokeVerificationForm.get("cart_item").at(o).patchValue({barcode:r,item_code:e?.sku,item_name:e?.name})}submit(){if(console.log(this.stokeVerificationForm.value),this.stokeVerificationForm.valid){this.loader=!0;let e=new FormData;e.append("voucher_date",this.stokeVerificationForm.get("voucher_date")?.value),e.append("voucher_no",this.stokeVerificationForm.get("voucher_no")?.value),e.append("updater_name",this.stokeVerificationForm.get("updater_name")?.value);const o=this.stokeVerificationForm.get("cart_item"),r=[];o.controls.forEach(s=>{const d=s,v={};Object.keys(d.controls).forEach(V=>{const I=d.controls[V];v[V]=isNaN(I.value)?I.value:parseFloat(I.value)}),r.push(v)}),e.append("cart_item",JSON.stringify(r)),this.inventoryService.addStockVerification(e).subscribe(s=>{console.log(s),s.success?(this.loader=!1,this.toastrService.success(s.msg),this.router.navigate(["/inventory/stock-verfication"]),this.stokeVerificationForm.reset(),this.ngOnInit()):(this.loader=!1,this.toastrService.success(s.msg))},s=>{this.loader=!1,this.toastrService.error(s.message)})}else this.stokeVerificationForm.markAllAsTouched()}oncheckProduct(e){console.log(e),this.supplierControl.reset(),this.getCart().length>0?(this.myControl.reset(),this.indexProduct++,this.indexProduct>0&&(console.log(this.indexProduct,"index product"),this.addCart(this.indexProduct),this.inventoryService.getStockByVariantId(e?.id).subscribe(o=>{this.stockList=o;const r=this.stokeVerificationForm.get("cart_item").at(this.indexProduct);console.log(e),r.patchValue({barcode:e?.id,item_code:e.sku,item_name:e?.product_title,system_qty:this.stockList?.available_qty})}))):(this.addCart(0),this.inventoryService.getStockByVariantId(e?.id).subscribe(o=>{this.stockList=o,this.stokeVerificationForm.get("cart_item").at(0).patchValue({barcode:e?.id,item_code:e.sku,item_name:e?.product_title,system_qty:this.stockList?.available_qty})}),console.warn(this.getCart().length)),console.log(this.stokeVerificationForm.value)}calculateDifference(e){const o=this.getCart().at(e),r=o.get("system_qty"),s=o.get("physical_qty");return r&&s?r.value-s.value:0}getVariant(e){this.inventoryService.filterVariant("","",e).subscribe(o=>{console.log(o),this.variantList=o,console.log(this.variantList)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(i.qu),t.Y36(k._W),t.Y36(b.q),t.Y36(_.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-addstock-verification"]],decls:70,vars:22,consts:[[1,"page-header"],[1,"page-title"],["id","purchaseForm",1,"card"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-3","col-sm-4","col-12"],[1,"form-group"],["type","date","formControlName","voucher_date",3,"ngClass"],["class","text-danger",4,"ngIf"],["type","text","formControlName","voucher_no","placeholder","Enter Voucher Number ",3,"ngModel","ngClass"],["type","text","formControlName","updater_name","placeholder","Enter Updater Name",3,"ngClass"],[1,"card"],[1,"col-lg-4","col-sm-6","col-12"],["type","text","placeholder","Search Product","aria-label","Search Products","matInput","",2,"box-sizing","border-box",3,"formControl","matAutocomplete","input"],["autos","matAutocomplete"],[4,"ngIf"],[3,"value",4,"ngIf"],["class","is-loading",4,"ngIf"],[1,"table-responsive"],[1,"table","datanew"],["formArrayName","cart_item"],[4,"ngFor","ngForOf"],[1,"col-lg-12"],["routerLink","//inventory/stock-verfication",1,"btn","btn-cancel"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],[1,"text-danger"],["style","color:#FF9F43",3,"value","onSelectionChange",4,"ngIf"],[2,"color","#FF9F43",3,"value","onSelectionChange"],[3,"value"],["routerLink","//product/addproduct",2,"color","#FF9F43"],[1,"is-loading"],[3,"formGroupName"],[1,"me-2"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-x-circle",2,"color","red",3,"click"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"],["d","M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"],["colspan","1"],["disabled","disabled",2,"margin-bottom","0"],["type","text","placeholder","Item Code","formControlName","item_code",1,"input"],["class","text-danger","style","display: block;",4,"ngIf"],[1,"form-group",2,"margin-bottom","0"],["disabled","disabled"],["type","text","placeholder","Item Name","formControlName","item_name",1,"input"],["type","text","placeholder","Enter Unit","formControlName","unit",1,"input"],["class","text-danger d-block",4,"ngIf"],["type","number","placeholder","Enter System qty","formControlName","system_qty",1,"input"],["type","number","placeholder","Enter Physical qty","formControlName","physical_qty",1,"input"],["type","text","placeholder","Difference qty","formControlName","discrepancy",1,"input",3,"ngModel"],["type","text","placeholder","Reason For Adjustment","formControlName","reason_for_adjustment",1,"input"],[1,"text-danger",2,"display","block"],[1,"text-danger","d-block"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h4"),t._uU(3,"Stock Verification Add"),t.qZA()()(),t.TgZ(4,"div",2)(5,"div",3)(6,"form",4),t.NdJ("ngSubmit",function(){return o.submit()}),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"label"),t._uU(11,"Date*"),t.qZA(),t._UZ(12,"input",8),t.YNc(13,C,2,0,"span",9),t.qZA()(),t.TgZ(14,"div",6)(15,"div",7)(16,"label"),t._uU(17,"Voucher Number"),t.qZA(),t._UZ(18,"input",10),t.YNc(19,g,2,0,"span",9),t.qZA()(),t.TgZ(20,"div",6)(21,"div",7)(22,"label"),t._uU(23,"Updater Name"),t.qZA(),t._UZ(24,"input",11),t.YNc(25,p,2,0,"span",9),t.qZA()()(),t.TgZ(26,"div",12)(27,"div",3)(28,"div",5)(29,"div",13)(30,"div",7)(31,"strong"),t._uU(32,"Select Product"),t.qZA(),t.TgZ(33,"input",14),t.NdJ("input",function(s){return o.getVariant(s.target.value)}),t.qZA(),t.TgZ(34,"mat-autocomplete",null,15),t.YNc(36,A,2,1,"ng-container",16),t.YNc(37,Z,3,1,"mat-option",17),t.YNc(38,N,2,0,"mat-option",18),t.qZA()()()(),t.TgZ(39,"div",19)(40,"table",20)(41,"thead")(42,"tr")(43,"th"),t._uU(44,"#"),t.qZA(),t._UZ(45,"th"),t.TgZ(46,"th"),t._uU(47,"Barcode"),t.qZA(),t.TgZ(48,"th"),t._uU(49,"Item Name"),t.qZA(),t.TgZ(50,"th"),t._uU(51,"Unit"),t.qZA(),t.TgZ(52,"th"),t._uU(53,"System Qty"),t.qZA(),t.TgZ(54,"th"),t._uU(55,"Physical Qty"),t.qZA(),t.TgZ(56,"th"),t._uU(57,"Difference Qty"),t.qZA(),t.TgZ(58,"th"),t._uU(59,"Remark"),t.qZA(),t._UZ(60,"th"),t.qZA()(),t.TgZ(61,"tbody"),t.ynx(62,21),t.YNc(63,E,35,10,"ng-container",22),t.BQk(),t.qZA()()()()(),t.TgZ(64,"div",23)(65,"a",24),t._uU(66,"Cancel"),t.qZA(),t._uU(67,"\xa0\xa0\xa0 "),t.YNc(68,O,2,0,"button",25),t.YNc(69,D,3,0,"button",26),t.qZA()()()()),2&e){const r=t.MAs(35);t.xp6(6),t.Q6J("formGroup",o.stokeVerificationForm),t.xp6(6),t.Q6J("ngClass",t.VKq(16,T,o.f.voucher_date.touched&&o.f.voucher_date.invalid)),t.xp6(1),t.Q6J("ngIf",o.voucher_date&&o.voucher_date.invalid&&o.voucher_date.touched),t.xp6(5),t.Q6J("ngModel",o.prefixNo)("ngClass",t.VKq(18,T,o.f.voucher_no.touched&&o.f.voucher_no.invalid)),t.xp6(1),t.Q6J("ngIf",o.voucher_no&&o.voucher_no.invalid&&o.voucher_no.touched),t.xp6(5),t.Q6J("ngClass",t.VKq(20,T,o.f.updater_name.touched&&o.f.updater_name.invalid)),t.xp6(1),t.Q6J("ngIf",o.updater_name&&o.updater_name.invalid&&o.updater_name.touched),t.xp6(8),t.Q6J("formControl",o.myControl)("matAutocomplete",r),t.xp6(3),t.Q6J("ngIf",(null==o.myControl.value?null:o.myControl.value.length)>=1&&(null==o.myControl.value?null:o.myControl.value.length)>0),t.xp6(1),t.Q6J("ngIf",0===(null==o.variantList?null:o.variantList.length)),t.xp6(1),t.Q6J("ngIf",(null==o.myControl.value?null:o.myControl.value.length)<3),t.xp6(25),t.Q6J("ngForOf",o.getCart().controls),t.xp6(5),t.Q6J("ngIf",!o.loader),t.xp6(1),t.Q6J("ngIf",o.loader)}},dependencies:[l.mk,l.sg,l.O5,_.yS,i._Y,i.Fj,i.wV,i.JJ,i.JL,i.oH,i.sg,i.u,i.x0,i.CE,u.XC,u.ZL,x.ey,m.Nt],styles:[".mat-autocomplete-trigger.mat-input-element.mat-form-field-autofill-control.ng-tns-c116-0.ng-untouched.ng-pristine.ng-valid.cdk-text-field-autofill-monitored.is-invalid[_ngcontent-%COMP%], .mat-autocomplete-trigger.form-control.ng-pristine.ng-invalid.ng-touched[_ngcontent-%COMP%], .input.ng-pristine.ng-invalid.ng-touched[_ngcontent-%COMP%], .ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%], .ng-pristine.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}select[_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], input[type=datetime-local][_ngcontent-%COMP%], .input[_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;padding:10px 15px;border-radius:5px}"]}),n})(),canActivate:[c(30597).l],data:{allowedRoles:["add_stockverification"]}}];let B=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[_.Bz.forChild(Y),_.Bz]}),n})();var G=c(8468),R=c(59549),j=c(30906);let z=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[l.ez,B,G.I,j.ZU,i.u5,i.UX,u.Bb,R.lN,m.c]}),n})()},30597:(q,y,c)=>{c.d(y,{l:()=>b});var l=c(94650),_=c(4392),i=c(97185),t=c(42917),k=c(80927);let b=(()=>{class u{constructor(m,C,g,p,f){this.router=m,this.Arout=C,this.toastr=g,this.profileService=p,this.coreService=f}canActivate(m,C){const g=JSON.parse(localStorage.getItem("auth"));if(this.profileService.userDetails$.subscribe(p=>{this.userDetails=p,this.permissions=this.userDetails?.permission}),g){const p=m.data.allowedRoles;console.log(p,"allowedRoles");const f=g.some(h=>p.includes(h.codename));if(console.log(f),this.coreService.getProfile().subscribe(h=>{this.userDetails=h,this.profileService.setUserDetails(this.userDetails);const A=h?.permission,Z=this.profileService.getUserDetails();(!Z||Z.length!==A.length)&&(this.profileService.setUserPermission(A),window.location.reload())}),f)return!0}return this.toastr.error("User have Not Permission to Access This page"),this.router.navigate(["/dashboard"]),!1}}return u.\u0275fac=function(m){return new(m||u)(l.LFG(_.F0),l.LFG(_.gz),l.LFG(i._W),l.LFG(t.J),l.LFG(k.p))},u.\u0275prov=l.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()}}]);