"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[8302],{98302:(z,h,s)=>{s.r(h),s.d(h,{AddstockVerificationModule:()=>D});var u=s(36895),m=s(89299),i=s(24006),t=s(94650),y=s(97185),C=s(42236),p=s(47957),Z=s(3238),v=s(44144);function A(o,a){1&o&&(t.TgZ(0,"span",27),t._uU(1,"Select voucher_date"),t.qZA())}function k(o,a){1&o&&(t.TgZ(0,"span",27),t._uU(1,"Enter Voucher Number "),t.qZA())}function b(o,a){1&o&&(t.TgZ(0,"span",27),t._uU(1,"Enter Updater Name"),t.qZA())}function x(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"mat-option",29),t.NdJ("onSelectionChange",function(){t.CHM(e);const r=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.oncheckProduct(r))}),t._uU(1),t.qZA()}if(2&o){const e=t.oxw().$implicit;t.Q6J("value",(null==e?null:e.product_title)+" "+(null==e?null:e.variant_name)),t.xp6(1),t.hij(" ",(null==e?null:e.product_title)+" "+(null==e?null:e.variant_name),"")}}function V(o,a){if(1&o&&(t.ynx(0),t.YNc(1,x,2,2,"mat-option",28),t.BQk()),2&o){const e=a.$implicit;t.xp6(1),t.Q6J("ngIf",1==e.is_active)}}function q(o,a){if(1&o&&(t.ynx(0),t.YNc(1,V,2,1,"ng-container",22),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.variantList)}}function T(o,a){1&o&&(t.TgZ(0,"mat-option",30)(1,"a",31),t._uU(2,"+add Product"),t.qZA()()),2&o&&t.Q6J("value","No data found")}function N(o,a){1&o&&(t.TgZ(0,"mat-option",32),t._uU(1," Please Enter 3 or more characters"),t.qZA())}function I(o,a){1&o&&(t.TgZ(0,"span",51),t._uU(1,"Select Product"),t.qZA())}function U(o,a){1&o&&(t.TgZ(0,"span",51),t._uU(1,"Select Product"),t.qZA())}function F(o,a){1&o&&(t.TgZ(0,"span",52),t._uU(1,"Enter Unit"),t.qZA())}function S(o,a){1&o&&(t.TgZ(0,"span",52),t._uU(1,"Enter System QTY"),t.qZA())}function Q(o,a){1&o&&(t.TgZ(0,"span",52),t._uU(1,"Enter Physical QTY"),t.qZA())}function J(o,a){1&o&&(t.TgZ(0,"span",52),t._uU(1,"Enter Discrepancy"),t.qZA())}function P(o,a){1&o&&(t.TgZ(0,"span",52),t._uU(1,"Enter Reason For Adjustment"),t.qZA())}function w(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"tr",33)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td")(5,"div")(6,"div",34),t.O4$(),t.TgZ(7,"svg",35),t.NdJ("click",function(){const c=t.CHM(e).index,l=t.oxw();return t.KtG(l.removeCart(c))}),t._UZ(8,"path",36)(9,"path",37),t.qZA()()()(),t.kcU(),t.TgZ(10,"td",38)(11,"fieldset",39),t._UZ(12,"input",40),t.YNc(13,I,2,0,"span",41),t.qZA()(),t.TgZ(14,"td",38)(15,"div",42)(16,"fieldset",43),t._UZ(17,"input",44),t.YNc(18,U,2,0,"span",41),t.qZA()()(),t.TgZ(19,"td"),t._UZ(20,"input",45),t.YNc(21,F,2,0,"span",46),t.qZA(),t.TgZ(22,"td")(23,"fieldset",43),t._UZ(24,"input",47),t.YNc(25,S,2,0,"span",46),t.qZA()(),t.TgZ(26,"td"),t._UZ(27,"input",48),t.YNc(28,Q,2,0,"span",46),t.qZA(),t.TgZ(29,"td"),t._UZ(30,"input",49),t.YNc(31,J,2,0,"span",46),t.qZA(),t.TgZ(32,"td"),t._UZ(33,"input",50),t.YNc(34,P,2,0,"span",46),t.qZA()(),t.BQk()}if(2&o){const e=a.$implicit,n=a.index,r=t.oxw();let c,l;t.xp6(1),t.Q6J("formGroupName",n),t.xp6(2),t.Oqu(n+1+"."),t.xp6(10),t.Q6J("ngIf",e.get("item_code")&&(null==(c=e.get("item_code"))?null:c.invalid)&&(null==(c=e.get("item_code"))?null:c.touched)),t.xp6(5),t.Q6J("ngIf",e.get("item_name")&&(null==(l=e.get("item_name"))?null:l.invalid)&&(null==(l=e.get("item_name"))?null:l.touched)),t.xp6(3),t.Q6J("ngIf",r.unit(n)&&r.unit(n).invalid&&r.unit(n).touched),t.xp6(4),t.Q6J("ngIf",r.system_qty(n)&&r.system_qty(n).invalid&&r.system_qty(n).touched),t.xp6(3),t.Q6J("ngIf",r.physical_qty(n)&&r.physical_qty(n).invalid&&r.physical_qty(n).touched),t.xp6(2),t.Q6J("ngModel",r.calculateDifference(n)),t.xp6(1),t.Q6J("ngIf",r.discrepancy(n)&&r.discrepancy(n).invalid&&r.discrepancy(n).touched),t.xp6(3),t.Q6J("ngIf",r.reason_for_adjustment(n)&&r.reason_for_adjustment(n).invalid&&r.reason_for_adjustment(n).touched)}}function M(o,a){1&o&&(t.TgZ(0,"button",53),t._uU(1,"Submit"),t.qZA())}function Y(o,a){1&o&&(t.TgZ(0,"button",54),t._UZ(1,"span",55),t._uU(2," \xa0 Submit"),t.qZA())}const g=function(o){return{"is-invalid":o}},O=[{path:"",component:(()=>{class o{constructor(e,n,r,c){this.fb=e,this.toastrService=n,this.inventoryService=r,this.router=c,this.productControl=new i.NI(""),this.filteredOptions=[],this.filteredItemCode=[],this.supplierControl=new i.NI(""),this.isCart=!1,this.myControl=new i.NI(""),this.variantList=[],this.loader=!1,this.indexProduct=0}get f(){return this.stokeVerificationForm.controls}ngOnInit(){const e=(new Date).toISOString().split("T")[0];this.stokeVerificationForm=this.fb.group({voucher_no:new i.NI("",[i.kI.required]),voucher_date:new i.NI(e,[i.kI.required]),updater_name:new i.NI("",[i.kI.required]),cart_item:this.fb.array([])}),this.getPrefix()}getPrefix(){this.inventoryService.getStockVerificationPrefix().subscribe(e=>{console.log(e),1==e.success?this.prefixNo=e.prefix:this.toastrService.error(e.msg)},e=>{this.toastrService.error(e.error.msg)})}cart(){return this.fb.group({barcode:new i.NI("",[i.kI.required]),item_code:new i.NI("",[i.kI.required]),item_name:new i.NI("",[i.kI.required]),unit:new i.NI("",[i.kI.required]),system_qty:new i.NI("",[i.kI.required]),physical_qty:new i.NI(0,[i.kI.required]),discrepancy:new i.NI("",[i.kI.required]),reason_for_adjustment:new i.NI("")})}getCart(){return this.stokeVerificationForm.get("cart_item")}addCart(e){this.getCart().push(this.cart()),this.isCart=!1}addCart2(e){this.getCart()?.push(this.cart())}removeCart(e){this.getCart().removeAt(e),this.indexProduct--,console.log(this.indexProduct),0==this.stokeVerificationForm?.value?.cart_item?.length&&(this.isCart=!0)}get voucher_no(){return this.stokeVerificationForm.get("voucher_no")}get voucher_date(){return this.stokeVerificationForm.get("voucher_date")}get updater_name(){return this.stokeVerificationForm.get("updater_name")}get text_box(){return this.stokeVerificationForm.get("text_box")}unit(e){return this.getCart().controls[e].get("unit")}discrepancy(e){return this.getCart().controls[e].get("discrepancy")}reason_for_adjustment(e){return this.getCart().controls[e].get("reason_for_adjustment")}system_qty(e){return this.getCart().controls[e].get("system_qty")}physical_qty(e){return this.getCart().controls[e].get("physical_qty")}isLastCart(e){return e===this.getCart().controls.length-1}oncheckVariant(e,n){console.log(e);const r=e.id;this.stokeVerificationForm.get("cart_item").at(n).patchValue({barcode:r,item_code:e?.sku,item_name:e?.name})}submit(){if(console.log(this.stokeVerificationForm.value),this.stokeVerificationForm.valid){this.loader=!0;let e=new FormData;e.append("voucher_date",this.stokeVerificationForm.get("voucher_date")?.value),e.append("voucher_no",this.stokeVerificationForm.get("voucher_no")?.value),e.append("updater_name",this.stokeVerificationForm.get("updater_name")?.value);const n=this.stokeVerificationForm.get("cart_item"),r=[];n.controls.forEach(c=>{const l=c,d={};Object.keys(l.controls).forEach(_=>{const f=l.controls[_];d[_]=isNaN(f.value)?f.value:parseFloat(f.value)}),r.push(d)}),e.append("cart_item",JSON.stringify(r)),this.inventoryService.addStockVerification(e).subscribe(c=>{console.log(c),c.success?(this.loader=!1,this.toastrService.success(c.msg),this.router.navigate(["/inventory/stock-verfication"]),this.stokeVerificationForm.reset(),this.ngOnInit()):(this.loader=!1,this.toastrService.success(c.msg))},c=>{this.loader=!1,this.toastrService.error(c.message)})}else this.stokeVerificationForm.markAllAsTouched()}oncheckProduct(e){console.log(e),this.supplierControl.reset(),this.getCart().length>0?(this.indexProduct++,this.indexProduct>0&&(console.log(this.indexProduct,"index product"),this.addCart(this.indexProduct),this.inventoryService.getStock().subscribe(n=>{console.log(n),this.stockList=n;const r=this.stokeVerificationForm.get("cart_item").at(this.indexProduct);console.log(e),r.patchValue({barcode:e?.id,item_code:e.sku,item_name:e?.product_title,system_qty:1})}))):(this.addCart(0),this.inventoryService.getStock().subscribe(n=>{console.log(n),this.stockList=n,this.stokeVerificationForm.get("cart_item").at(0).patchValue({barcode:e?.id,item_code:e.sku,item_name:e?.product_title,system_qty:1})}),console.warn(this.getCart().length)),console.log(this.stokeVerificationForm.value)}calculateDifference(e){const n=this.getCart().at(e),r=n.get("system_qty"),c=n.get("physical_qty");return r&&c?r.value-c.value:0}getVariant(e){this.inventoryService.filterVariant("","",e).subscribe(n=>{console.log(n),this.variantList=n,console.log(this.variantList)})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(i.qu),t.Y36(y._W),t.Y36(C.q),t.Y36(m.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-addstock-verification"]],decls:70,vars:22,consts:[[1,"page-header"],[1,"page-title"],["id","purchaseForm",1,"card"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-3","col-sm-4","col-12"],[1,"form-group"],["type","date","formControlName","voucher_date",3,"ngClass"],["class","text-danger",4,"ngIf"],["type","text","formControlName","voucher_no","placeholder","Enter Voucher Number ",3,"ngModel","ngClass"],["type","text","formControlName","updater_name","placeholder","Enter Updater Name",3,"ngClass"],[1,"card"],[1,"col-lg-4","col-sm-6","col-12"],["type","text","placeholder","Search Product","aria-label","Search Products","matInput","",2,"box-sizing","border-box",3,"formControl","matAutocomplete","input"],["autos","matAutocomplete"],[4,"ngIf"],[3,"value",4,"ngIf"],["class","is-loading",4,"ngIf"],[1,"table-responsive"],[1,"table","datanew"],["formArrayName","cart_item"],[4,"ngFor","ngForOf"],[1,"col-lg-12"],["routerLink","//inventory/stock-verfication",1,"btn","btn-cancel"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],[1,"text-danger"],["style","color:#FF9F43",3,"value","onSelectionChange",4,"ngIf"],[2,"color","#FF9F43",3,"value","onSelectionChange"],[3,"value"],["routerLink","//product/addproduct",2,"color","#FF9F43"],[1,"is-loading"],[3,"formGroupName"],[1,"me-2"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-x-circle",2,"color","red",3,"click"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"],["d","M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"],["colspan","1"],["disabled","disabled",2,"margin-bottom","0"],["type","text","placeholder","Item Code","formControlName","item_code",1,"input"],["class","text-danger","style","display: block;",4,"ngIf"],[1,"form-group",2,"margin-bottom","0"],["disabled","disabled"],["type","text","placeholder","Item Name","formControlName","item_name",1,"input"],["type","text","placeholder","Enter Unit","formControlName","unit",1,"input"],["class","text-danger d-block",4,"ngIf"],["type","number","placeholder","Enter System qty","formControlName","system_qty",1,"input"],["type","number","placeholder","Enter Physical qty","formControlName","physical_qty",1,"input"],["type","text","placeholder","Difference qty","formControlName","discrepancy",1,"input",3,"ngModel"],["type","text","placeholder","Reason For Adjustment","formControlName","reason_for_adjustment",1,"input"],[1,"text-danger",2,"display","block"],[1,"text-danger","d-block"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h4"),t._uU(3,"Stock Verification Add"),t.qZA()()(),t.TgZ(4,"div",2)(5,"div",3)(6,"form",4),t.NdJ("ngSubmit",function(){return n.submit()}),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"label"),t._uU(11,"Date*"),t.qZA(),t._UZ(12,"input",8),t.YNc(13,A,2,0,"span",9),t.qZA()(),t.TgZ(14,"div",6)(15,"div",7)(16,"label"),t._uU(17,"Voucher Number"),t.qZA(),t._UZ(18,"input",10),t.YNc(19,k,2,0,"span",9),t.qZA()(),t.TgZ(20,"div",6)(21,"div",7)(22,"label"),t._uU(23,"Updater Name"),t.qZA(),t._UZ(24,"input",11),t.YNc(25,b,2,0,"span",9),t.qZA()()(),t.TgZ(26,"div",12)(27,"div",3)(28,"div",5)(29,"div",13)(30,"div",7)(31,"strong"),t._uU(32,"Select Product"),t.qZA(),t.TgZ(33,"input",14),t.NdJ("input",function(c){return n.getVariant(c.target.value)}),t.qZA(),t.TgZ(34,"mat-autocomplete",null,15),t.YNc(36,q,2,1,"ng-container",16),t.YNc(37,T,3,1,"mat-option",17),t.YNc(38,N,2,0,"mat-option",18),t.qZA()()()(),t.TgZ(39,"div",19)(40,"table",20)(41,"thead")(42,"tr")(43,"th"),t._uU(44,"#"),t.qZA(),t._UZ(45,"th"),t.TgZ(46,"th"),t._uU(47,"Barcode"),t.qZA(),t.TgZ(48,"th"),t._uU(49,"Item Name"),t.qZA(),t.TgZ(50,"th"),t._uU(51,"Unit"),t.qZA(),t.TgZ(52,"th"),t._uU(53,"System Qty"),t.qZA(),t.TgZ(54,"th"),t._uU(55,"Physical Qty"),t.qZA(),t.TgZ(56,"th"),t._uU(57,"Difference Qty"),t.qZA(),t.TgZ(58,"th"),t._uU(59,"Remark"),t.qZA(),t._UZ(60,"th"),t.qZA()(),t.TgZ(61,"tbody"),t.ynx(62,21),t.YNc(63,w,35,10,"ng-container",22),t.BQk(),t.qZA()()()()(),t.TgZ(64,"div",23)(65,"a",24),t._uU(66,"Cancel"),t.qZA(),t._uU(67,"\xa0\xa0\xa0 "),t.YNc(68,M,2,0,"button",25),t.YNc(69,Y,3,0,"button",26),t.qZA()()()()),2&e){const r=t.MAs(35);t.xp6(6),t.Q6J("formGroup",n.stokeVerificationForm),t.xp6(6),t.Q6J("ngClass",t.VKq(16,g,n.f.voucher_date.touched&&n.f.voucher_date.invalid)),t.xp6(1),t.Q6J("ngIf",n.voucher_date&&n.voucher_date.invalid&&n.voucher_date.touched),t.xp6(5),t.Q6J("ngModel",n.prefixNo)("ngClass",t.VKq(18,g,n.f.voucher_no.touched&&n.f.voucher_no.invalid)),t.xp6(1),t.Q6J("ngIf",n.voucher_no&&n.voucher_no.invalid&&n.voucher_no.touched),t.xp6(5),t.Q6J("ngClass",t.VKq(20,g,n.f.updater_name.touched&&n.f.updater_name.invalid)),t.xp6(1),t.Q6J("ngIf",n.updater_name&&n.updater_name.invalid&&n.updater_name.touched),t.xp6(8),t.Q6J("formControl",n.myControl)("matAutocomplete",r),t.xp6(3),t.Q6J("ngIf",(null==n.myControl.value?null:n.myControl.value.length)>=1&&(null==n.myControl.value?null:n.myControl.value.length)>0),t.xp6(1),t.Q6J("ngIf",0===(null==n.variantList?null:n.variantList.length)),t.xp6(1),t.Q6J("ngIf",(null==n.myControl.value?null:n.myControl.value.length)<3),t.xp6(25),t.Q6J("ngForOf",n.getCart().controls),t.xp6(5),t.Q6J("ngIf",!n.loader),t.xp6(1),t.Q6J("ngIf",n.loader)}},dependencies:[u.mk,u.sg,u.O5,m.yS,i._Y,i.Fj,i.wV,i.JJ,i.JL,i.oH,i.sg,i.u,i.x0,i.CE,p.XC,p.ZL,Z.ey,v.Nt],styles:[".mat-autocomplete-trigger.mat-input-element.mat-form-field-autofill-control.ng-tns-c116-0.ng-untouched.ng-pristine.ng-valid.cdk-text-field-autofill-monitored.is-invalid[_ngcontent-%COMP%], .mat-autocomplete-trigger.form-control.ng-pristine.ng-invalid.ng-touched[_ngcontent-%COMP%], .input.ng-pristine.ng-invalid.ng-touched[_ngcontent-%COMP%], .ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%], .ng-pristine.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}select[_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], input[type=datetime-local][_ngcontent-%COMP%], .input[_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;padding:10px 15px;border-radius:5px}"]}),o})()}];let E=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.Bz.forChild(O),m.Bz]}),o})();var L=s(8468),j=s(59549),B=s(30906);let D=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.ez,E,L.I,B.ZU,i.u5,i.UX,p.Bb,j.lN,v.c]}),o})()}}]);