"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[9733],{59733:(Z,g,c)=>{c.r(g),c.d(g,{UpdatePermissionGroupModule:()=>U});var m=c(36895),u=c(88996),r=c(24006),o=c(94650),h=c(25062),b=c(97185);function _(t,s){if(1&t){const e=o.EpF();o.TgZ(0,"div")(1,"div",27)(2,"input",31),o.NdJ("change",function(i){o.CHM(e);const l=o.oxw(3);return o.KtG(l.onCheckChange(i))}),o.qZA(),o.TgZ(3,"label",29),o._uU(4),o.qZA()()()}if(2&t){const e=s.$implicit,n=o.oxw(3);o.xp6(2),o.Q6J("id","permission_"+(null==e?null:e.id))("checked",e.selected)("value",e.id)("checked",n.permissions.includes(e.id)),o.xp6(1),o.Q6J("for","permission_"+(null==e?null:e.id)),o.xp6(1),o.Oqu(null==e?null:e.name)}}function v(t,s){if(1&t){const e=o.EpF();o.TgZ(0,"div",25)(1,"h4",26),o._uU(2),o.qZA(),o.TgZ(3,"div",27)(4,"input",28),o.NdJ("change",function(i){const a=o.CHM(e).$implicit,d=o.oxw().index,p=o.oxw();return o.KtG(p.selectAllPermissions(a.permissions,d,a.model_name,i))}),o.qZA(),o.TgZ(5,"label",29),o._uU(6,"Select all"),o.qZA()(),o.YNc(7,_,5,6,"div",30),o.qZA()}if(2&t){const e=s.$implicit,n=o.oxw().index;o.xp6(2),o.Oqu(null==e?null:e.model_name),o.xp6(2),o.Q6J("id","selectAll_"+n+"_"+e.model_name),o.xp6(1),o.Q6J("for","selectAll_"+n+"_"+e.model_name),o.xp6(2),o.Q6J("ngForOf",null==e?null:e.permissions)}}function x(t,s){if(1&t&&(o.TgZ(0,"div",17)(1,"div",18)(2,"div",19)(3,"h2",20)(4,"button",21),o._uU(5),o.ALo(6,"titlecase"),o.qZA()(),o.TgZ(7,"div",22)(8,"div",23),o.YNc(9,v,8,4,"div",24),o.qZA()()()()()),2&t){const e=s.$implicit,n=s.index;o.xp6(4),o.uIk("data-bs-target","#collapse"+n)("aria-expanded",!1)("aria-controls","collapse"+n)("id","heading"+n),o.xp6(1),o.Oqu(o.lcZ(6,8,e.content_type.app_label)),o.xp6(2),o.Q6J("id","collapse"+n),o.uIk("aria-labelledby","heading"+n),o.xp6(2),o.Q6J("ngForOf",null==e?null:e.model)}}function P(t,s){1&t&&(o.TgZ(0,"button",32),o._uU(1,"Submit"),o.qZA())}function C(t,s){1&t&&(o.TgZ(0,"button",33),o._UZ(1,"span",34),o._uU(2,"Submit"),o.qZA())}const O=[{path:"",component:(()=>{class t{constructor(e,n,i,l,a,d){this.contactService=e,this.fb=n,this.toastr=i,this.Arout=l,this.router=a,this.location=d,this.permissions=[],this.selectedSubcat=0,this.loaders=!1}ngOnInit(){this.id=this.Arout.snapshot.paramMap.get("id"),this.permissionForm=this.fb.group({group_name:new r.NI(""),permissions:new r.Oe([])}),this.contactService.getPermissionGroupById(this.id).subscribe(e=>{console.log(e),this.gName=e.Group,this.permissionForm.patchValue({group_name:e.Group}),this.permissions=[],e.data.forEach(n=>{n.model.forEach(i=>{i.permissions.forEach(l=>{this.permissions.push(l.id)})})}),console.log(this.permissions)}),this.getPermissionGroup()}selectAllPermissions(e,n,i,l){const a=l.target.checked,d=this.permissionForm.get("permissions");for(let p of e)if(p.selected=a,a)this.isPermissionSelected(p.id)||(d.push(new r.NI(p.id)),this.selectedSubcat++);else if(this.isPermissionSelected(p.id)){const f=d.controls.findIndex(y=>y.value===p.id);-1!==f&&(d.removeAt(f),this.selectedSubcat--)}}isPermissionSelected(e){return this.permissionForm.get("permissions").controls.some(i=>i.value===e)}getPermissionGroup(){this.contactService.getPermission().subscribe(e=>{console.log(e),this.groupList=e?.data,this.groupList.forEach(n=>{let i=[];i=n?.model,i.forEach(l=>{l.permissions.map(a=>{console.log(this.permissions.includes(a.id)),console.log(a),this.permissions.includes(a.id)&&(console.log(a),this.permissionForm.get("permissions").push(new r.NI(a.id)))})})})})}onCheckChange(e){const n=this.permissionForm.get("permissions");if(e.target.checked)n.push(new r.NI(parseInt(e.target.value))),this.selectedSubcat++;else{let i=0;n.controls.forEach(l=>{if(l.value==e.target.value)return n.removeAt(i),void this.selectedSubcat--;i++})}}submit(){if(console.log(this.permissionForm.value),this.permissionForm.valid){this.loaders=!0,console.log("valid");var e=new FormData;const n=this.permissionForm.get("permissions")?.value.filter(i=>null!==i);e.append("permissions",JSON.stringify(n)),this.contactService.updatePermissionGroup(e,this.id).subscribe(i=>{console.log(i),this.loaders=!1,this.addRes=i,"Group updated successfully"==this.addRes.msg&&(this.toastr.success(this.addRes.msg),this.loaders=!1,this.permissionForm.reset(),this.location.back())},i=>{console.log(i.error.gst)})}else this.permissionForm.markAllAsTouched(),console.log("forms invalid")}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(h.y),o.Y36(r.qu),o.Y36(b._W),o.Y36(u.gz),o.Y36(u.F0),o.Y36(m.Ye))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-update-permission-group"]],decls:25,vars:4,consts:[[1,"page-header"],[1,"page-title"],[1,"card"],[1,"card-body"],[3,"formGroup","ngSubmit"],["type","text","placeholder","User Role Name","formControlName","group_name","readonly","",1,"form-control","w-30"],["id","pills-tab","role","tablist",1,"nav","nav-pills","mb-4","mt-3"],["role","presentation",1,"nav-item"],["id","pills-home-tab","data-bs-toggle","pill","data-bs-target","#pills-home","type","button","role","tab","aria-controls","pills-home","aria-selected","true",1,"nav-link","active"],["id","pills-profile-tab","data-bs-toggle","pill","data-bs-target","#pills-profile","type","button","role","tab","aria-controls","pills-profile","aria-selected","false",1,"nav-link"],["id","pills-tabContent",1,"tab-content"],["id","pills-home","role","tabpanel","aria-labelledby","pills-home-tab",1,"tab-pane","fade","show","active"],["class","heading",4,"ngFor","ngForOf"],["id","pills-profile","role","tabpanel","aria-labelledby","pills-profile-tab",1,"tab-pane","fade"],[1,"col-lg-12"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],[1,"heading"],["id","accordionExample",1,"accordion"],[1,"accordion-item"],[1,"accordion-header"],["type","button","data-bs-toggle","collapse",1,"accordion-button","collapsed"],["data-bs-parent","#accordionExample",1,"accordion-collapse","collapse",3,"id"],[1,"row","w-100","m-0"],["class","col-sm-3 mb-3",4,"ngFor","ngForOf"],[1,"col-sm-3","mb-3"],[1,"f-18","mb-2"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"id","change"],[1,"form-check-label",3,"for"],[4,"ngFor","ngForOf"],["type","checkbox","formArrayName","permissions",1,"form-check-input",3,"id","checked","value","change"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(e,n){1&e&&(o.TgZ(0,"div",0)(1,"div",1)(2,"h4"),o._uU(3,"User Role"),o.qZA(),o.TgZ(4,"h6"),o._uU(5,"Manage your User"),o.qZA()()(),o.TgZ(6,"div",2)(7,"div",3)(8,"form",4),o.NdJ("ngSubmit",function(){return n.submit()}),o._UZ(9,"input",5),o.TgZ(10,"ul",6)(11,"li",7)(12,"button",8),o._uU(13,"User Role Details"),o.qZA()(),o.TgZ(14,"li",7)(15,"button",9),o._uU(16,"Report Details"),o.qZA()()(),o.TgZ(17,"div",10)(18,"div",11)(19,"div"),o.YNc(20,x,10,10,"div",12),o.qZA()(),o._UZ(21,"div",13),o.TgZ(22,"div",14),o.YNc(23,P,2,0,"button",15),o.YNc(24,C,3,0,"button",16),o.qZA()()()()()),2&e&&(o.xp6(8),o.Q6J("formGroup",n.permissionForm),o.xp6(12),o.Q6J("ngForOf",n.groupList),o.xp6(3),o.Q6J("ngIf",!n.loaders),o.xp6(1),o.Q6J("ngIf",n.loaders))},dependencies:[m.sg,m.O5,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,r.CE,m.rS],styles:[".w-30[_ngcontent-%COMP%]{width:20%}.nav-pills[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background:transparent;color:#f63;font-weight:500;border-bottom:2px solid #ff6633;border-radius:0;font-size:16px}.nav-pills[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{font-size:16px;color:#f63}.orangeb-btn[_ngcontent-%COMP%]{padding:5px 10px;border:2px solid #ff6633;background:transparent;color:#f63;border-radius:5px;font-weight:500}.orangeb-btn[_ngcontent-%COMP%]:hover{background-color:#f63;color:#fff;transition:.3s}.accordion-item[_ngcontent-%COMP%]{border:1px solid #EEEEEE}.accordion-button[_ngcontent-%COMP%]{font-size:17px;font-weight:500;padding:15px 20px}.accordion-button[_ngcontent-%COMP%]:not(.collapsed){background-color:#f9d9cc;color:#f63}.accordion-button.collapsed[_ngcontent-%COMP%]:after{width:30px;background-repeat:no-repeat;height:30px;background-size:auto}.accordion-button[_ngcontent-%COMP%]:not(.collapsed):after{transform:rotate(-180deg);width:30px;background-repeat:no-repeat;height:30px;background-size:auto}.accordion-body[_ngcontent-%COMP%]{color:#201e1f;font-size:20px}.accordion[_ngcontent-%COMP%]{margin-bottom:30px}.text-p[_ngcontent-%COMP%]{color:#483d53;font-size:15px;font-weight:400}.form-control[_ngcontent-%COMP%]:focus{border-color:#faddd1;outline:0;box-shadow:0 0 0 .25rem #ff8e5f63}.btn-close[_ngcontent-%COMP%]:focus{border-color:#faddd1;outline:0;box-shadow:0 0 0 .25rem #ff8e5f63}.form-check-input[_ngcontent-%COMP%]:focus{border-color:#faddd1;box-shadow:0 0 0 .25rem #ff8e5f63}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#f63;border-color:#f63}.accordion-button[_ngcontent-%COMP%]:focus{border-color:#faddd1;box-shadow:0 0 0 .25rem #ff8e5f63}.accordion-collapse[_ngcontent-%COMP%]{padding:15px}.f-18[_ngcontent-%COMP%]{font-size:18px;font-weight:500}@media (max-width: 765px){.purple-text[_ngcontent-%COMP%]{font-size:15px}.accordion-button[_ngcontent-%COMP%]{padding:10px 15px}.text-p[_ngcontent-%COMP%]{font-size:11px}.heading[_ngcontent-%COMP%]{width:100%}.accordion-button[_ngcontent-%COMP%], .accordion-body[_ngcontent-%COMP%]{font-size:12px}.accordion-button[_ngcontent-%COMP%]:not(.collapsed):after{width:20px;height:20px}.accordion-button.collapsed[_ngcontent-%COMP%]:after{width:20px;height:20px}}"]}),t})()}];let M=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[u.Bz.forChild(O),u.Bz]}),t})();var A=c(8468);let U=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[m.ez,M,A.I]}),t})()}}]);