"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[7838],{17838:(F,T,n)=>{n.r(T),n.d(T,{TaxSlabUpdatedModule:()=>L});var p=n(36895),S=n(88996),r=n(24006),t=n(94650),C=n(80927),u=n(97185);function i(a,l){if(1&a&&(t.TgZ(0,"option",29),t._uU(1),t.qZA()),2&a){const e=l.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.title," ")}}function s(a,l){1&a&&(t.TgZ(0,"span",30),t._uU(1,"Select Category "),t.qZA())}const g=function(a){return{"is-invalid":a}};function b(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"a",31)(1,"input",32),t.NdJ("change",function(c){t.CHM(e);const _=t.oxw();return t.KtG(_.onCheckChange(c))}),t.qZA(),t.TgZ(2,"label",33),t.NdJ("click",function(c){t.CHM(e);const _=t.oxw();return t.KtG(_.onLabelClick(c))}),t._uU(3),t.qZA()()}if(2&a){const e=l.$implicit,o=l.index,c=t.oxw();t.xp6(1),t.Q6J("value",e.id)("checked",c.selectSubcat.includes(e.id)||c.selectedSubCategoryIds.includes(e.id))("ngClass",t.VKq(6,g,c.f.subcategory.touched&&c.f.subcategory.invalid))("id","checkboxSize-"+o),t.xp6(1),t.Q6J("for","checkboxSize-"+o),t.xp6(1),t.Oqu(e.title)}}function d(a,l){if(1&a&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Oqu(e.selectedSubcat+" Subcategory Selected")}}function h(a,l){1&a&&(t.TgZ(0,"span",30),t._uU(1,"Select subcategory "),t.qZA())}function m(a,l){if(1&a&&(t.TgZ(0,"option",29),t._uU(1),t.qZA()),2&a){const e=l.$implicit;t.s9C("value",e.id),t.xp6(1),t.hij(" ",e.tax_percentage+"%"," ")}}function f(a,l){if(1&a){const e=t.EpF();t.TgZ(0,"button",39),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().index,_=t.oxw();return t.KtG(_.removeAmount(c))}),t._uU(1,"\u2212"),t.qZA()}}function x(a,l){if(1&a&&(t.ynx(0),t.TgZ(1,"tr",34)(2,"td"),t._UZ(3,"input",35),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"input",36),t.qZA(),t.TgZ(6,"td")(7,"select",37)(8,"option",11),t._uU(9,"Select tax"),t.qZA(),t.YNc(10,m,2,2,"option",12),t.qZA()(),t.TgZ(11,"td"),t.YNc(12,f,2,0,"button",38),t.qZA()(),t.BQk()),2&a){const e=l.index,o=t.oxw();t.xp6(1),t.Q6J("formGroupName",e),t.xp6(9),t.Q6J("ngForOf",o.taxList),t.xp6(2),t.Q6J("ngIf",e>0)}}function y(a,l){1&a&&(t.TgZ(0,"button",40),t._uU(1,"Submit"),t.qZA())}function v(a,l){1&a&&(t.TgZ(0,"button",41),t._UZ(1,"span",42),t._uU(2," Submit"),t.qZA())}const M=function(){return{standalone:!0}};let Z=(()=>{class a{constructor(e,o,c,_,A){this.fb=e,this.coreService=o,this.Arout=c,this.router=_,this.toastrService=A,this.checks=!0,this.subcatbySubcatGroup=[],this.filteredSubcategory=[],this.searchTerm="",this.selectSubcat=[],this.selectedSubcat=0,this.selectedSubCategoryIds=[],this.loaders=!1}get f(){return this.taxSlabForm.controls}ngOnInit(){this.id=this.Arout.snapshot.paramMap.get("id"),this.taxSlabForm=this.fb.group({subcategory_group:new r.NI("",[r.kI.required]),subcategory:new r.Oe([],[r.kI.required]),amount_tax_slabs:this.fb.array([])}),this.coreService.getTaxSlabById(this.id).subscribe(e=>{console.log(e),this.getRes=e,this.selectSubcat=this.getRes.subcategory.map(o=>o.id),console.log(this.selectSubcat),this.getSubcategoryBySubcatGroup(this.getRes.subcategory_group.id),this.taxSlabForm.patchValue({subcategory_group:this.getRes.subcategory_group.id}),this.taxSlabForm.setControl("amount_tax_slabs",this.udateAmount(this.getRes.amount_tax_slabs))}),this.addAmount(),this.getSubcateGroup(),this.getTax()}udateAmount(e){let o=new r.Oe([]);return e.forEach(c=>{o.push(this.fb.group({from_amount:c.from_amount,to_amount:c.to_amount,tax:c.tax.id}))}),o}udateSubcat(e){e.forEach(o=>{console.log(o)})}amount_tax_slabs(){return this.fb.group({from_amount:"",to_amount:"",tax:""})}getAmount(){return this.taxSlabForm.get("amount_tax_slabs")}addAmount(){this.getAmount().push(this.amount_tax_slabs())}removeAmount(e){this.getAmount().removeAt(e)}get subcategory_group(){return this.taxSlabForm.get("subcategory_group")}get subcategory(){return this.taxSlabForm.get("subcategory")}get tax(){return this.taxSlabForm.get("tax")}getSubcateGroup(){this.coreService.getSubcategoryGroup().subscribe(e=>{console.log(e),this.subcatGroupList=e})}getTax(){this.coreService.gettaxd().subscribe(e=>{console.log(e),this.taxList=e,console.log(this.taxList)})}getSubcategoryBySubcatGroup(e){this.coreService.getSubcategoryBySubcatGroup(e).subscribe(o=>{console.log(o.subcategories),this.subcatbySubcatGroup=o.subcategories,this.filteredSubcategory=[...this.subcatbySubcatGroup],this.subcatbySubcatGroup.map(c=>{console.log(c),this.selectedSubcat=this.selectSubcat.length,this.getd=this.selectSubcat.includes(c.id),console.log(this.getd),console.log(this.selectSubcat.includes(c.id),"subcategory"),this.selectSubcat.includes(c.id)&&this.taxSlabForm.get("subcategory").push(new r.NI(c.id))})})}filterSubcategory(){this.filteredSubcategory=""===this.searchTerm.trim()?[...this.subcatbySubcatGroup]:this.subcatbySubcatGroup.filter(e=>e.title.toLowerCase().includes(this.searchTerm.toLowerCase()))}onCheckChange(e){const o=this.taxSlabForm.get("subcategory");if(e.target.checked)o.push(new r.NI(parseInt(e.target.value))),this.check=o,this.selectedSubcat++,this.selectedSubCategoryIds=o.value;else{let c=0;o.controls.forEach(_=>{if(_.value==e.target.value)return o.removeAt(c),void this.selectedSubcat--;c++})}}submit(){console.log(this.taxSlabForm.value),console.log(this.id);let e=this.taxSlabForm.value;this.taxSlabForm.valid?(this.loaders=!0,this.coreService.updateTaxSlab(e,this.id).subscribe(o=>{console.log(o),this.updateRes=o,"Tax Slabs Updated"==this.updateRes.msg&&(this.loaders=!1,this.toastrService.success(this.updateRes.msg),this.router.navigate(["product/taxSlabList"]))})):(this.taxSlabForm.markAllAsTouched(),console.log("forms invalid"))}onLabelClick(e){e.stopPropagation()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(r.qu),t.Y36(C.p),t.Y36(S.gz),t.Y36(S.F0),t.Y36(u._W))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-tax-slab-updated"]],decls:57,vars:15,consts:[[1,"page-header","justify-content-center"],[1,"page-title"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"card"],[1,"card-body"],[1,"row","form-card"],[1,"col-lg-4","col-sm-4","col-12"],[1,"form-group"],["formControlName","subcategory_group","required","","id","subcategory_group",1,"w-100","h-100","border",3,"ngClass","change"],["category_idValue","","categoryValue",""],["value","","selected","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],[1,"dropdown"],["type","button","type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"dropdown-toggle","button"],[1,"dropdown-menu",2,"width","100%","max-height","300px","overflow-y","auto"],["type","text","placeholder","search subcategory",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],["class","dropdown-item",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-lg-8","col-sm-8","col-12"],[1,"table","amt-table"],["formArrayName","amount_tax_slabs"],[4,"ngFor","ngForOf"],[1,"w-100","text-right"],[1,"addMore",3,"click"],[1,"col-lg-8","text-end","mt-5"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],[3,"value"],[1,"text-danger"],[1,"dropdown-item"],["type","checkbox","formArrayName","subcategory",2,"margin-right","5px",3,"value","checked","ngClass","id","change"],[2,"margin-bottom","0",3,"for","click"],[3,"formGroupName"],["type","text","formControlName","from_amount","placeholder","ex-100",1,"form-control","inp"],["type","text","formControlName","to_amount","placeholder","ex-1000",1,"form-control","inp"],["formControlName","tax",1,"inp"],["class","btn","style","background: #FF9F43;",3,"click",4,"ngIf"],[1,"btn",2,"background","#FF9F43",3,"click"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(e,o){if(1&e){const c=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"h4"),t._uU(3,"Tax Slab Update"),t.qZA(),t.TgZ(4,"h6"),t._uU(5,"Edit Tax Slab"),t.qZA()()(),t.TgZ(6,"form",2),t.NdJ("ngSubmit",function(){return o.submit()}),t.TgZ(7,"div",3)(8,"div",4)(9,"div",5)(10,"div",6)(11,"div",7)(12,"div",8)(13,"label"),t._uU(14,"Subcategory Group*"),t.qZA(),t.TgZ(15,"select",9,10),t.NdJ("change",function(){t.CHM(c);const A=t.MAs(17);return t.KtG(o.getSubcategoryBySubcatGroup(A.value))}),t.TgZ(18,"option",11),t._uU(19,"select subcategory group"),t.qZA(),t.YNc(20,i,2,2,"option",12),t.qZA(),t.YNc(21,s,2,0,"span",13),t.qZA()(),t.TgZ(22,"div",7)(23,"div",8)(24,"label"),t._uU(25,"SubCategory*"),t.qZA(),t.TgZ(26,"div",14)(27,"button",15),t._uU(28,"Select Subcategory"),t.qZA(),t.TgZ(29,"ul",16)(30,"li")(31,"input",17),t.NdJ("ngModelChange",function(A){return o.searchTerm=A})("ngModelChange",function(){return o.filterSubcategory()}),t.qZA()(),t.TgZ(32,"li"),t.YNc(33,b,4,8,"a",18),t.qZA()()(),t.YNc(34,d,2,1,"p",19),t.YNc(35,h,2,0,"span",13),t.qZA()(),t.TgZ(36,"div",20)(37,"table",21)(38,"thead")(39,"tr")(40,"th"),t._uU(41,"From Amount"),t.qZA(),t.TgZ(42,"th"),t._uU(43,"To Amount"),t.qZA(),t.TgZ(44,"th"),t._uU(45,"Tax"),t.qZA(),t.TgZ(46,"th"),t._uU(47,"\xa0"),t.qZA()()(),t.TgZ(48,"tbody"),t.ynx(49,22),t.YNc(50,x,13,3,"ng-container",23),t.BQk(),t.qZA()(),t.TgZ(51,"div",24)(52,"span",25),t.NdJ("click",function(){return o.addAmount()}),t._uU(53,"+ Add more"),t.qZA()()(),t.TgZ(54,"div",26),t.YNc(55,y,2,0,"button",27),t.YNc(56,v,3,0,"button",28),t.qZA()()()()()()}2&e&&(t.xp6(6),t.Q6J("formGroup",o.taxSlabForm),t.xp6(9),t.Q6J("ngClass",t.VKq(12,g,o.f.subcategory_group.touched&&o.f.subcategory_group.invalid)),t.xp6(5),t.Q6J("ngForOf",o.subcatGroupList),t.xp6(1),t.Q6J("ngIf",o.subcategory_group&&o.subcategory_group.invalid&&o.subcategory_group.touched),t.xp6(10),t.Q6J("ngModel",o.searchTerm)("ngModelOptions",t.DdM(14,M)),t.xp6(2),t.Q6J("ngForOf",o.filteredSubcategory),t.xp6(1),t.Q6J("ngIf",o.selectedSubcat>0),t.xp6(1),t.Q6J("ngIf",o.subcategory&&o.subcategory.invalid&&o.subcategory.touched),t.xp6(15),t.Q6J("ngForOf",o.getAmount().controls),t.xp6(5),t.Q6J("ngIf",!o.loaders),t.xp6(1),t.Q6J("ngIf",o.loaders))},dependencies:[p.mk,p.sg,p.O5,r._Y,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.JL,r.Q7,r.On,r.sg,r.u,r.x0,r.CE],styles:['.ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}select[_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;padding:10px 15px;border-radius:5px}.button[_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;display:flex;padding:10px 15px;border-radius:5px;justify-content:space-between;align-items:center;background-color:#fff}.table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child){border-top:none!important}.labelSize[_ngcontent-%COMP%]{display:flex;align-items:center}.entries[_ngcontent-%COMP%]{font-size:12px;color:#5e5873;font-weight:600;float:left;margin-top:10px}.labelSize[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border:1px solid #ced4da;width:80px;height:30px;padding:0;border-radius:3px}.thone[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{float:right;margin-top:4px}@media (max-width: 765px){.thone[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{float:inherit;margin-top:0}}.fa-sort[_ngcontent-%COMP%]:before{content:"\\f0dc";right:.5em;color:#babfc7;font-size:12px;opacity:1}.inp[_ngcontent-%COMP%]{border:none}.amt-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#EEF0F8}.amt-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#FAFBFE}.addMore[_ngcontent-%COMP%]{color:#ff9f43;font-size:20px;font-weight:500;float:right}.form-card[_ngcontent-%COMP%]{width:100%;margin:auto;justify-content:center}']}),a})();var U=n(30597);const O=JSON.parse(localStorage.getItem("auth"));let P;O&&O.permission&&O.permission.map(l=>{"product"===l.content_type.app_label&&"taxslabs"===l.content_type.model&&"change_taxslabs"==l.codename&&(P=l.codename,console.log(P))});const N=[{path:"",component:Z,canActivate:[U.l],data:{allowedRoles:["change_taxslabs"]}}];let G=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[S.Bz.forChild(N),S.Bz]}),a})();var I=n(30906),w=n(65415),D=n(43189),J=n(54333),E=n(54040),R=n(84385),k=n(56709);let L=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[p.ez,G,I.ZU,r.u5,r.UX,w.T,D.h,J.JX,E.l,R.LD,k.p9]}),a})()},30597:(F,T,n)=>{n.d(T,{l:()=>u});var p=n(94650),S=n(88996),r=n(97185),t=n(42917),C=n(80927);let u=(()=>{class i{constructor(g,b,d,h,m){this.router=g,this.Arout=b,this.toastr=d,this.profileService=h,this.coreService=m}canActivate(g,b){const d=JSON.parse(localStorage.getItem("auth"));if(this.profileService.userDetails$.subscribe(h=>{this.userDetails=h,this.permissions=this.userDetails?.permission}),d){const h=g.data.allowedRoles;console.log(h,"allowedRoles");const m=d.some(f=>h.includes(f.codename));if(this.coreService.getProfile().subscribe(f=>{this.userDetails=f,this.profileService.setUserDetails(this.userDetails);const x=f?.permission,y=this.profileService.getUserDetails();(!y||y.length!==x.length)&&(this.profileService.setUserPermission(x),window.location.reload())}),console.log(m),m)return!0}return console.log(this.permissions,"permisiion guard"),this.toastr.error("User have Not Permission to Access This page"),this.router.navigate(["/dashboard"]),!1}}return i.\u0275fac=function(g){return new(g||i)(p.LFG(S.F0),p.LFG(S.gz),p.LFG(r._W),p.LFG(t.J),p.LFG(C.p))},i.\u0275prov=p.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},65415:(F,T,n)=>{n.d(T,{G:()=>r,T:()=>C});var p=n(94650),r=function(){function u(i,s,g){this.el=i,this.vcr=s,this.renderer=g,this.dtOptions={}}return u.prototype.ngOnInit=function(){var i=this;this.dtTrigger?this.dtTrigger.subscribe(function(s){i.displayTable(s)}):this.displayTable(null)},u.prototype.ngOnDestroy=function(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)},u.prototype.displayTable=function(i){var s=this;i&&(this.dtOptions=i),this.dtInstance=new Promise(function(g,b){Promise.resolve(s.dtOptions).then(function(d){0===Object.keys(d).length&&0===$("tbody tr",s.el.nativeElement).length?b("Both the table and dtOptions cannot be empty"):setTimeout(function(){var m={rowCallback:function(f,x,y){if(d.columns){var v=d.columns;s.applyNgPipeTransform(f,v),s.applyNgRefTemplate(f,v,x)}d.rowCallback&&d.rowCallback(f,x,y)}};m=Object.assign({},d,m),s.dt=$(s.el.nativeElement).DataTable(m),g(s.dt)})})})},u.prototype.applyNgPipeTransform=function(i,s){s.filter(function(b){return b.ngPipeInstance&&!b.ngTemplateRef}).forEach(function(b){var d=b.ngPipeInstance,h=b.ngPipeArgs||[],m=s.findIndex(function(v){return v.data===b.data}),f=i.childNodes.item(m),x=$(f).text(),y=d.transform.apply(d,function(u,i,s){if(s||2===arguments.length)for(var d,g=0,b=i.length;g<b;g++)(d||!(g in i))&&(d||(d=Array.prototype.slice.call(i,0,g)),d[g]=i[g]);return u.concat(d||Array.prototype.slice.call(i))}([x],h,!1));$(f).text(y)})},u.prototype.applyNgRefTemplate=function(i,s,g){var b=this;s.filter(function(h){return h.ngTemplateRef&&!h.ngPipeInstance}).forEach(function(h){var m=h.ngTemplateRef,f=m.ref,x=m.context,y=s.findIndex(function(U){return U.data===h.data}),v=i.childNodes.item(y);$(v).html("");var M=Object.assign({},x,x?.userData,{adtData:g}),Z=b.vcr.createEmbeddedView(f,M);b.renderer.appendChild(v,Z.rootNodes[0])})},u.\u0275fac=function(s){return new(s||u)(p.Y36(p.SBq),p.Y36(p.s_b),p.Y36(p.Qsj))},u.\u0275dir=p.lG2({type:u,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}}),u}(),t=n(36895),C=function(){function u(){}return u.forRoot=function(){return{ngModule:u}},u.\u0275fac=function(s){return new(s||u)},u.\u0275mod=p.oAB({type:u}),u.\u0275inj=p.cJS({imports:[t.ez]}),u}()}}]);