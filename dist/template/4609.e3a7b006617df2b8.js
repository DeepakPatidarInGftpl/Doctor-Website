"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[4609],{84609:(y,b,i)=>{i.r(b),i.d(b,{UpdateUserModule:()=>O});var a=i(96814),u=i(74408),r=i(56223),e=i(19212),Z=i(35350),T=i(58763);function d(s,o){1&s&&(e.TgZ(0,"span",31),e._uU(1,"Enter your Name "),e.qZA())}function N(s,o){1&s&&(e.TgZ(0,"span",31),e._uU(1,"Enter your Username "),e.qZA())}function m(s,o){1&s&&(e.TgZ(0,"span",31),e._uU(1,"Enter your Mobile No."),e.qZA())}function h(s,o){1&s&&(e.TgZ(0,"span",31),e._uU(1,"Enter Valid Email"),e.qZA())}function g(s,o){1&s&&(e.TgZ(0,"span",31),e._uU(1,"Select User Type"),e.qZA())}function p(s,o){if(1&s&&(e.TgZ(0,"option",32),e._uU(1),e.qZA()),2&s){const n=o.$implicit;e.s9C("value",n.id),e.xp6(1),e.Oqu(n.name)}}function f(s,o){1&s&&(e.TgZ(0,"span",31),e._uU(1,"Select User role"),e.qZA())}function _(s,o){if(1&s&&(e.TgZ(0,"option",32),e._uU(1),e.qZA()),2&s){const n=o.$implicit;e.s9C("value",null==n?null:n.id),e.xp6(1),e.Oqu(null==n?null:n.title)}}function U(s,o){1&s&&(e.TgZ(0,"span",31),e._uU(1,"Select branch"),e.qZA())}function v(s,o){1&s&&(e.TgZ(0,"button",33),e._uU(1,"Submit"),e.qZA())}function F(s,o){1&s&&(e.TgZ(0,"button",34),e._UZ(1,"span",35),e._uU(2," \xa0 Submit"),e.qZA())}const c=s=>({"is-invalid":s});let S=(()=>{class s{constructor(n,l,t,A,x){this.fb=n,this.contactService=l,this.toastr=t,this.router=A,this.Arout=x,this.dateError=null,this.loader=!1}get f(){return this.userForm.controls}ngOnInit(){this.id=this.Arout.snapshot.paramMap.get("id"),this.userForm=this.fb.group({phone_number:new r.NI("",[r.kI.required]),username:new r.NI(""),name:new r.NI(""),email:new r.NI(""),active:new r.NI(""),user_type:new r.NI(""),role:new r.NI(""),branch:new r.NI("")}),this.contactService.getUserById(this.id).subscribe(n=>{this.userForm.patchValue(n),this.userForm.get("branch")?.patchValue(n?.branch?.id),this.userForm.get("user_type")?.patchValue(n?.user_type),this.userForm.get("role")?.patchValue(n?.role)}),this.getBranch(),this.getGroup()}getBranch(){this.contactService.getBranch().subscribe(n=>{this.branchList=n})}getGroup(){this.contactService.getPermissionGroup().subscribe(n=>{this.groupList=n})}submit(){this.userForm.valid?(this.loader=!0,this.contactService.updateUser(this.userForm.value,this.id).subscribe(n=>{this.addRes=n,this.addRes.success?(this.loader=!1,this.toastr.success(this.addRes.msg),this.userForm.reset(),this.router.navigate(["//settings/user"])):(this.loader=!1,this.toastr.error(this.addRes.error),this.addRes.phone_number?this.toastr.error(this.addRes.phone_number):this.addRes.username&&this.toastr.error(this.addRes.username))},n=>{this.loader=!1,this.toastr.error("password",n?.error?.password[0])})):(this.userForm.markAllAsTouched(),this.toastr.error("Please Fill All The Required Fields"))}get mobile_no(){return this.userForm.get("phone_number")}get username(){return this.userForm.get("username")}get email(){return this.userForm.get("email")}get password(){return this.userForm.get("password")}get user_type(){return this.userForm.get("user_type")}get permission_group(){return this.userForm.get("user_permissions")}get name(){return this.userForm.get("name")}get branch(){return this.userForm.get("branch")}get role(){return this.userForm.get("role")}static#e=this.\u0275fac=function(l){return new(l||s)(e.Y36(r.qu),e.Y36(Z.y),e.Y36(T._W),e.Y36(u.F0),e.Y36(u.gz))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-update-user"]],decls:79,vars:36,consts:[[1,"page-header"],[1,"page-title"],[1,"card"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-3","col-sm-3","col-12"],[1,"form-group"],["type","text","formControlName","name","placeholder","Enter Name","id","name",3,"ngClass"],["class","text-danger",4,"ngIf"],["type","text","formControlName","username","placeholder","Enter User Name","id","username",3,"ngClass"],["type","text","formControlName","phone_number","placeholder","Enter Mobile No.","id","phone_number","minlength","10","maxlength","10",3,"ngClass"],["type","text","formControlName","email","id","email","placeholder","Enter Valid Email",3,"ngClass"],["formControlName","user_type","id","user_type",3,"ngClass"],["value","","selected","","disabled",""],["value","Supplier"],["value","Vendor"],["value","Employee"],["value","Customer"],["formControlName","role","id","role",3,"ngClass"],[3,"value",4,"ngFor","ngForOf"],["formControlName","branch","id","branch",3,"ngClass"],[1,"col-lg-3","col-sm-3","col-12","d-flex","align-items-center"],[1,"form-group","mt-4"],[1,"d-flex"],["type","checkbox","formControlName","active",3,"id","ngModel"],[1,"d_flex",2,"margin-bottom","0","margin-left","5px",3,"for"],[1,"col-lg-12"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],["routerLink","//settings/user",1,"btn","btn-cancel"],[1,"text-danger"],[3,"value"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(l,t){1&l&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4"),e._uU(3,"Update User"),e.qZA(),e.TgZ(4,"h6"),e._uU(5,"Edit Update "),e.qZA()()(),e.TgZ(6,"div",2)(7,"div",3)(8,"form",4),e.NdJ("ngSubmit",function(){return t.submit()}),e.TgZ(9,"div",5)(10,"div",6)(11,"div",7)(12,"label"),e._uU(13,"Name*"),e.qZA(),e._UZ(14,"input",8),e.YNc(15,d,2,0,"span",9),e.qZA()(),e.TgZ(16,"div",6)(17,"div",7)(18,"label"),e._uU(19,"User Name*"),e.qZA(),e._UZ(20,"input",10),e.YNc(21,N,2,0,"span",9),e.qZA()(),e.TgZ(22,"div",6)(23,"div",7)(24,"label"),e._uU(25,"Mobile Number*"),e.qZA(),e._UZ(26,"input",11),e.YNc(27,m,2,0,"span",9),e.qZA()(),e.TgZ(28,"div",6)(29,"div",7)(30,"label"),e._uU(31,"Email"),e.qZA(),e._UZ(32,"input",12),e.YNc(33,h,2,0,"span",9),e.qZA()(),e.TgZ(34,"div",6)(35,"div",7)(36,"label"),e._uU(37,"Select User Type"),e.qZA(),e.TgZ(38,"select",13)(39,"option",14),e._uU(40,"Select User Type"),e.qZA(),e.TgZ(41,"option",15),e._uU(42,"Supplier"),e.qZA(),e.TgZ(43,"option",16),e._uU(44,"Vendor"),e.qZA(),e.TgZ(45,"option",17),e._uU(46,"Employee"),e.qZA(),e.TgZ(47,"option",18),e._uU(48,"Customer"),e.qZA()(),e.YNc(49,g,2,0,"span",9),e.qZA()(),e.TgZ(50,"div",6)(51,"div",7)(52,"label"),e._uU(53,"Select User Role"),e.qZA(),e.TgZ(54,"select",19)(55,"option",14),e._uU(56,"Select User Role"),e.qZA(),e.YNc(57,p,2,2,"option",20),e.qZA(),e.YNc(58,f,2,0,"span",9),e.qZA()(),e.TgZ(59,"div",6)(60,"div",7)(61,"label"),e._uU(62,"Select Branch"),e.qZA(),e.TgZ(63,"select",21)(64,"option",14),e._uU(65,"Select Branch"),e.qZA(),e.YNc(66,_,2,2,"option",20),e.qZA(),e.YNc(67,U,2,0,"span",9),e.qZA()(),e.TgZ(68,"div",22)(69,"div",23)(70,"div",24),e._UZ(71,"input",25),e.TgZ(72,"label",26),e._uU(73,"Active"),e.qZA()()()(),e.TgZ(74,"div",27),e.YNc(75,v,2,0,"button",28)(76,F,3,0,"button",29),e.TgZ(77,"a",30),e._uU(78,"Cancel"),e.qZA()()()()()()),2&l&&(e.xp6(8),e.Q6J("formGroup",t.userForm),e.xp6(6),e.Q6J("ngClass",e.VKq(22,c,t.f.name.touched&&t.f.name.invalid)),e.xp6(1),e.Q6J("ngIf",t.name&&t.name.invalid&&t.name.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(24,c,t.f.username.touched&&t.f.username.invalid)),e.xp6(1),e.Q6J("ngIf",t.username&&t.username.invalid&&t.username.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(26,c,t.f.phone_number.touched&&t.f.phone_number.invalid)),e.xp6(1),e.Q6J("ngIf",t.mobile_no&&t.mobile_no.invalid&&t.mobile_no.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(28,c,t.f.email.touched&&t.f.email.invalid)),e.xp6(1),e.Q6J("ngIf",t.email&&t.email.invalid&&t.email.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(30,c,t.f.user_type.touched&&t.f.user_type.invalid)),e.xp6(11),e.Q6J("ngIf",t.user_type&&t.user_type.invalid&&t.user_type.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(32,c,t.f.role.touched&&t.f.role.invalid)),e.xp6(3),e.Q6J("ngForOf",t.groupList),e.xp6(1),e.Q6J("ngIf",t.role&&t.role.invalid&&t.role.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(34,c,t.f.branch.touched&&t.f.branch.invalid)),e.xp6(3),e.Q6J("ngForOf",t.branchList),e.xp6(1),e.Q6J("ngIf",t.branch&&t.branch.invalid&&t.branch.touched),e.xp6(4),e.Q6J("id","checkboxTax-")("ngModel",!0),e.xp6(1),e.Q6J("for","checkboxTax-"),e.xp6(3),e.Q6J("ngIf",!t.loader),e.xp6(1),e.Q6J("ngIf",t.loader))},dependencies:[a.mk,a.sg,a.O5,u.rH,r._Y,r.YN,r.Kr,r.Fj,r.Wl,r.EJ,r.JJ,r.JL,r.wO,r.nD,r.sg,r.u],styles:[".ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}select[_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;padding:10px 15px;border-radius:5px}.button[_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;display:flex;padding:10px 15px;border-radius:5px;justify-content:space-between;align-items:center;background:white}textarea[_ngcontent-%COMP%]{height:40px}"]})}return s})();var q=i(1971);const C=JSON.parse(localStorage.getItem("auth"));let E;C&&C.map(o=>{"master"===o.content_type.app_label&&"user"===o.content_type.model&&"change_user"==o.codename&&(E=o.codename)});const I=[{path:"",component:S,canActivate:[q.l],data:{allowedRoles:["change_user"]}}];let J=(()=>{class s{static#e=this.\u0275fac=function(l){return new(l||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({imports:[u.Bz.forChild(I),u.Bz]})}return s})(),O=(()=>{class s{static#e=this.\u0275fac=function(l){return new(l||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({imports:[a.ez,J,r.u5,r.UX]})}return s})()},1971:(y,b,i)=>{i.d(b,{l:()=>T});var a=i(19212),u=i(74408),r=i(58763),e=i(41789),Z=i(44293);let T=(()=>{class d{constructor(m,h,g,p,f){this.router=m,this.Arout=h,this.toastr=g,this.profileService=p,this.coreService=f}canActivate(m,h){const g=JSON.parse(localStorage.getItem("auth"));if(this.profileService.userDetails$.subscribe(p=>{this.userDetails=p,this.permissions=this.userDetails?.permission}),g){const p=m.data.allowedRoles;console.log(p,"allowedRoles");const f=g.some(_=>p.includes(_.codename));if(console.log(f),this.coreService.getProfile().subscribe(_=>{this.userDetails=_,this.profileService.setUserDetails(this.userDetails);const U=_?.permission,v=this.profileService.getUserDetails();(!v||v.length!==U.length)&&(this.profileService.setUserPermission(U),window.location.reload())}),f)return!0}return this.toastr.error("User have Not Permission to Access This page"),this.router.navigate(["/dashboard"]),!1}static#e=this.\u0275fac=function(h){return new(h||d)(a.LFG(u.F0),a.LFG(u.gz),a.LFG(r._W),a.LFG(e.J),a.LFG(Z.p))};static#t=this.\u0275prov=a.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);