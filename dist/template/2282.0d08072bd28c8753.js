"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[2282],{92282:(O,c,t)=>{t.r(c),t.d(c,{SigninModule:()=>q});var g=t(36895),l=t(4392),r=t(24006),n=t(94650),f=t(83631),m=t(10003),h=t(80927),u=t(97185),v=t(43672),S=t(23182);function b(e,o){1&e&&(n.TgZ(0,"span",26),n._uU(1,"Enter your username "),n.qZA())}function w(e,o){if(1&e&&(n.TgZ(0,"div",27),n._uU(1),n.qZA()),2&e){const i=n.oxw();n.xp6(1),n.hij(" ",i.CustomControler.message," ")}}function Z(e,o){1&e&&(n.TgZ(0,"div"),n._uU(1," username is required. "),n.qZA())}function C(e,o){1&e&&(n.TgZ(0,"div"),n._uU(1," Please, enter valid username address. "),n.qZA())}function _(e,o){if(1&e&&(n.TgZ(0,"div",27),n.YNc(1,Z,2,0,"div",28),n.YNc(2,C,2,0,"div",28),n.qZA()),2&e){const i=n.oxw();n.xp6(1),n.Q6J("ngIf",i.f.username.errors&&i.f.username.errors.required),n.xp6(1),n.Q6J("ngIf",i.f.username.errors&&i.f.username.errors.username)}}function T(e,o){1&e&&(n.TgZ(0,"span",26),n._uU(1,"Enter your password "),n.qZA())}function y(e,o){if(1&e){const i=n.EpF();n.TgZ(0,"span",29),n.NdJ("click",function(){n.CHM(i);const a=n.oxw();return n.KtG(a.onClick())}),n.qZA()}}function I(e,o){if(1&e){const i=n.EpF();n.TgZ(0,"span",30),n.NdJ("click",function(){n.CHM(i);const a=n.oxw();return n.KtG(a.onClick())}),n.qZA()}}function k(e,o){1&e&&(n.TgZ(0,"button",31),n._uU(1,"Sign In"),n.qZA())}function A(e,o){1&e&&(n.TgZ(0,"button",32),n._UZ(1,"span",33),n._uU(2,"\xa0 Sign In"),n.qZA())}function N(e,o){1&e&&(n.TgZ(0,"div",34)(1,"div",35)(2,"span",36),n._uU(3,"Loading..."),n.qZA()()())}const J=function(e){return{"blur-background-wrapper":e}},d=function(e){return{"is-invalid":e}},U=[{path:"",component:(()=>{class e{constructor(i,s,a,x,M,L,Q){this.storage=i,this.authService=s,this.coreService=a,this.toastr=x,this.router=M,this.afMessaging=L,this.messagingService=Q,this.show=!1,this.notificationLoading=!1,this.isSyncLoading=!1,this.loginStatus="",this.loaders=!1,this.subscription=this.storage.Loginvalue.subscribe(p=>{0!=p&&(this.CustomControler=p)})}get f(){return this.form.controls}ngOnInit(){this.form=new r.cw({username:new r.NI("",[r.kI.required]),password:new r.NI("",[r.kI.required])}),this.storage.Checkuser(),this.password="password",localStorage.getItem("token")&&this.router.navigate(["/dashboard"]),this.messagingService.receiveMessage(),this.messagingService.currentMessage.subscribe(i=>{i&&this.showNotification(i)})}requestPermission(){this.messagingService.requestPermission().then(i=>{i?(this.deviceToken=i,this.updateUserDeviceToken(),console.log(i)):alert("You have not given notification access, so you will not be notified."),this.isSyncLoading=!1,window.location.reload()}).catch(i=>{console.error("Error retrieving token:",i),alert("You have not given notification access, so you will not be notified."),window.location.reload(),this.isSyncLoading=!1})}showNotification(i){"granted"===Notification.permission?new Notification(i.notification?.title||"No title",{body:i.notification?.body||"No body",icon:i.notification?.icon||"assets/logo/logo.png"}):console.error("Notification permission not granted")}updateUserDeviceToken(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/firebase-messaging-sw.js").then(i=>{console.log("Service Worker registered with scope:",i.scope),this.deviceToken&&this.authService.updateUserDeviceToken({device_token:this.deviceToken}).subscribe(a=>{console.log(a)},a=>{console.error("Error updating device token:",a)})}).catch(i=>{console.error("Service Worker registration failed:",i)})}submit(){this.form.valid?(this.loaders=!0,this.authService.login(this.form.value).subscribe(i=>{this.loginRes=i,this.loginRes.token?(this.loaders=!1,this.toastr.success("Login Successfull"),this.isSyncLoading=!0,localStorage.setItem("token",this.loginRes?.token),localStorage.setItem("auth",JSON.stringify(this.loginRes?.permission)),this.coreService.getFinancialYearHeader().subscribe(s=>{console.warn(s),localStorage.setItem("financialYear",JSON.stringify(s?.id)),this.requestPermission()},s=>{this.isSyncLoading=!1})):this.loaders=!1},i=>{this.loaders=!1,0==i.error.User?this.toastr.error(i.error.msg):i.error.status&&this.toastr.error(i.error.status)})):(this.loaders=!1,this.form.markAllAsTouched(),console.log("invalid form"))}ngOnDestroy(){this.subscription.unsubscribe()}get username(){return this.form.get("username")}get passwords(){return this.form.get("password")}onClick(){"password"===this.password?(this.password="text",this.show=!0):(this.password="password",this.show=!1)}}return e.\u0275fac=function(i){return new(i||e)(n.Y36(f.T),n.Y36(m.u),n.Y36(h.p),n.Y36(u._W),n.Y36(l.F0),n.Y36(v.BG),n.Y36(S.M))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-signin"]],decls:38,vars:20,consts:[[1,"main-wrapper",3,"ngClass"],[1,"account-content"],[1,"login-wrapper"],[1,"login-content","w-50"],[1,"login-userset"],[1,"login-logo","logo-normal"],["src","assets/dummy/pos.png","alt","img"],["routerLink","//dashboard",1,"login-logo","logo-white"],["src","assets/img/logo-white.png","alt",""],[1,"login-userheading"],[3,"formGroup","ngSubmit"],[1,"form-login"],[1,"form-addons"],["type","text","placeholder","Enter your username","formControlName","username","id","username",3,"ngClass"],["src","assets/img/icons/mail.svg","alt","img"],["class","text-danger",4,"ngIf"],["class","invalid-feedback",4,"ngIf"],[1,"pass-group"],["placeholder","Enter your password","formControlName","password","id","password",1,"pass-input",3,"type","ngClass"],["class","fas toggle-password fa-eye",3,"click",4,"ngIf"],["class","fas toggle-password fa-eye-slash",3,"click",4,"ngIf"],["class","btn btn-login me-2","type","submit",4,"ngIf"],["class","btn btn-login me-2","type","submit","disabled","",4,"ngIf"],[1,"login-img","w-50"],["src","assets/img/LoginImage.webp","alt",""],["class","spinner-container",4,"ngIf"],[1,"text-danger"],[1,"invalid-feedback"],[4,"ngIf"],[1,"fas","toggle-password","fa-eye",3,"click"],[1,"fas","toggle-password","fa-eye-slash",3,"click"],["type","submit",1,"btn","btn-login","me-2"],["type","submit","disabled","",1,"btn","btn-login","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"spinner-container"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(i,s){1&i&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),n._UZ(6,"img",6),n.qZA(),n.TgZ(7,"a",7),n._UZ(8,"img",8),n.qZA(),n.TgZ(9,"div",9)(10,"h3"),n._uU(11,"Login"),n.qZA(),n.TgZ(12,"h4"),n._uU(13,"Please login to your account"),n.qZA()(),n.TgZ(14,"form",10),n.NdJ("ngSubmit",function(){return s.submit()}),n.TgZ(15,"div",11)(16,"label"),n._uU(17,"Username"),n.qZA(),n.TgZ(18,"div",12),n._UZ(19,"input",13)(20,"img",14),n.qZA(),n.YNc(21,b,2,0,"span",15),n.YNc(22,w,2,1,"div",16),n.YNc(23,_,3,2,"div",16),n.qZA(),n.TgZ(24,"div",11)(25,"label"),n._uU(26,"Password"),n.qZA(),n.TgZ(27,"div",17),n._UZ(28,"input",18),n.YNc(29,T,2,0,"span",15),n.YNc(30,y,1,0,"span",19),n.YNc(31,I,1,0,"span",20),n.qZA()(),n.TgZ(32,"div",11),n.YNc(33,k,2,0,"button",21),n.YNc(34,A,3,0,"button",22),n.qZA()()()(),n.TgZ(35,"div",23),n._UZ(36,"img",24),n.qZA()()()(),n.YNc(37,N,4,0,"div",25)),2&i&&(n.Q6J("ngClass",n.VKq(14,J,s.isSyncLoading)),n.xp6(14),n.Q6J("formGroup",s.form),n.xp6(5),n.Q6J("ngClass",n.VKq(16,d,s.f.username.touched&&s.f.username.invalid)),n.xp6(2),n.Q6J("ngIf",s.username&&s.username.invalid&&s.username.touched),n.xp6(1),n.Q6J("ngIf","username"===(null==s.CustomControler?null:s.CustomControler.status)),n.xp6(1),n.Q6J("ngIf",s.f.username.touched&&s.f.username.invalid),n.xp6(5),n.Q6J("type",s.password)("ngClass",n.VKq(18,d,s.f.password.touched&&s.f.password.invalid)),n.xp6(1),n.Q6J("ngIf",s.passwords&&s.passwords.invalid&&s.passwords.touched),n.xp6(1),n.Q6J("ngIf",s.show),n.xp6(1),n.Q6J("ngIf",!s.show),n.xp6(2),n.Q6J("ngIf",!s.loaders),n.xp6(1),n.Q6J("ngIf",s.loaders),n.xp6(3),n.Q6J("ngIf",s.isSyncLoading))},dependencies:[g.mk,g.O5,l.yS,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u],styles:[".ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%], .ng-pristine.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}.spinner-container[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:40px}.spinner-border[_ngcontent-%COMP%]{width:150px;height:150px;color:#ff9f43!important}.blur-background-wrapper[_ngcontent-%COMP%]{filter:blur(3px)}"]}),e})()}];let Y=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[l.Bz.forChild(U),l.Bz]}),e})(),q=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[g.ez,Y,r.UX,u.Rh.forRoot()]}),e})()}}]);