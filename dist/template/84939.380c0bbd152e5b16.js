"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[84939],{53506:(I,x,u)=>{u.d(x,{x:()=>A});var m=u(92340),y=u(94650),c=u(80529);let A=(()=>{class _{constructor(e){this.http=e,this.apiUrl=`${m.N.api}`}getBranch(){throw new Error("Method not implemented.")}getSupplier(e){return this.http.get(this.apiUrl+"/pv-api/supplier/?search="+e)}sale_and_purchase_qty_for_purchase_order(e){return this.http.get(this.apiUrl+"/pv-api/sale_and_purchase_qty_for_purchase_order/?id="+e)}Ckqut(e,r){const a=this.apiUrl+"/pv-api/stock_check/",l=new URLSearchParams;return l.append("id",e),l.append("mrp",r),this.http.get(a+(l.toString()?"?"+l.toString():""))}getPurchaseFY(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/purchase_order/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getPurchase(){return this.http.get(this.apiUrl+"/pv-api/purchase_order/")}getPurchaseOrderByUserId(e){return this.http.get(this.apiUrl+"/pv-api/purchase_order/?user_id="+e)}addPurchase(e){return this.http.post(this.apiUrl+"/pv-api/purchase_order/",e)}getPurchaseById(e){return this.http.get(`${this.apiUrl+"/pv-api/purchase_order/?id="}${e}`)}PurchaseIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/purchase_order/?id="}${e}`,r)}updatePurchase(e,r){return this.http.put(`${this.apiUrl+"/pv-api/purchase_order/?id="}${r}`,e)}deletePurchase(e){return this.http.delete(`${this.apiUrl+"/pv-api/purchase_order/?id="}${e}`)}searchProduct(e){return this.http.get(this.apiUrl+"/pv-api/product_search/?search="+e)}productVariant(){return this.http.get(this.apiUrl+"/pv-api/product_variant/")}getMaterialFY(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/material_inward/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getMaterial(){return this.http.get(this.apiUrl+"/pv-api/material_inward/")}addMaterial(e){return this.http.post(this.apiUrl+"/pv-api/material_inward/",e)}getMaterialById(e){return this.http.get(`${this.apiUrl+"/pv-api/material_inward/?id="}${e}`)}getMaterialByUserId(e){return this.http.get(`${this.apiUrl+"/pv-api/material_inward/?user_id="}${e}`)}MaterialIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/material_inward/?id="}${e}`,r)}updateMaterial(e,r){return this.http.put(`${this.apiUrl+"/pv-api/material_inward/?id="}${r}`,e)}deleteMaterial(e){return this.http.delete(`${this.apiUrl+"/pv-api/material_inward/?id="}${e}`)}getPurchaseBillFY(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/purchase_bill/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getPurchaseBill(){return this.http.get(this.apiUrl+"/pv-api/purchase_bill/")}addPurchaseBill(e){return this.http.post(this.apiUrl+"/pv-api/purchase_bill/",e)}getPurchaseBillById(e){return this.http.get(`${this.apiUrl+"/pv-api/purchase_bill/?id="}${e}`)}getPurchaseBillByUserId(e){return this.http.get(`${this.apiUrl+"/pv-api/purchase_bill/?user_id="}${e}`)}PurchaseBillIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/purchase_bill/?id="}${e}`,r)}updatePurchaseBill(e,r){return this.http.put(`${this.apiUrl+"/pv-api/purchase_bill/?id="}${r}`,e)}deletePurchaseBill(e){return this.http.delete(`${this.apiUrl+"/pv-api/purchase_bill/?id="}${e}`)}getDebitNotes(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/debit_note/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}addDebitNotes(e){return this.http.post(this.apiUrl+"/pv-api/debit_note/",e)}getDebitNotesById(e){return this.http.get(`${this.apiUrl+"/pv-api/debit_note/?id="}${e}`)}DebitNotesIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/debit_note/?id="}${e}`,r)}updateDebitNotes(e,r){return this.http.put(`${this.apiUrl+"/pv-api/debit_note/?id="}${r}`,e)}deleteDebitNotes(e){return this.http.delete(`${this.apiUrl+"/pv-api/debit_note/?id="}${e}`)}getSearchProductById(e){return this.http.get(`${this.apiUrl+"/pv-api/variant-search/?search="}${e}`)}getSearchProduct(){return this.http.get(this.apiUrl+"/pv-api/variant-search/")}getPurchaseOrderPrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=PurchaseOrder")}getPurchaseBillPrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=PurchaseBill")}getDebitNotePrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=PurchaseReturn")}getMaterialInwardPrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=MaterialInward")}productBySupplier(){return this.http.get(this.apiUrl+"/pv-api/purchase_product_filter/")}getAdditionalCharge(){return this.http.get(this.apiUrl+"/pv-api/pos/additional_charge_pos/")}getTax(){return this.http.get(this.apiUrl+"/pv-api/tax/")}getPurchaseReturnfy(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/purchase_return/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getPurchaseReturn(){return this.http.get(this.apiUrl+"/pv-api/purchase_return/")}addPurchaseReturn(e){return this.http.post(this.apiUrl+"/pv-api/purchase_return/",e)}getPurchaseReturnById(e){return this.http.get(`${this.apiUrl+"/pv-api/purchase_return/?id="}${e}`)}PurchaseReturnIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/purchase_return/?id="}${e}`,r)}updatePurchaseReturn(e,r){return this.http.put(`${this.apiUrl+"/pv-api/purchase_return/?id="}${r}`,e)}deletePurchaseReturn(e){return this.http.delete(`${this.apiUrl+"/pv-api/purchase_return/?id="}${e}`)}filterVariant(e,r,a,l){let s=this.apiUrl+"/pv-api/purchase_product_filter/";const f=[];return e&&f.push(`supplier=${e}`),r&&f.push(`category=${r}`),a&&f.push(`subcategory=${a}`),l&&f.push(`search=${l}`),f.length>0&&(s+="?"+f.join("&")),this.http.get(s)}purchaseReturnStatusUpdate(e){return this.http.post(this.apiUrl+"/pv-api/purchase_return_status_update/",e)}}return _.\u0275fac=function(e){return new(e||_)(y.LFG(c.eN))},_.\u0275prov=y.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},72170:(I,x,u)=>{u.d(x,{M:()=>A});var m=u(92340),y=u(94650),c=u(80529);let A=(()=>{class _{constructor(e){this.http=e,this.apiUrl=`${m.N.api}`}getSalesOrderfy(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/sale_order/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getSalesOrder(){return this.http.get(this.apiUrl+"/pv-api/sale_order/")}getSalesOrderByUserId(e){return this.http.get(this.apiUrl+"/pv-api/sale_order/?user_id="+e)}getSalesOrderById(e){return this.http.get(`${this.apiUrl+"/pv-api/sale_order/?id="}${e}`)}SalesOrderIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/sale_order/?id="}${e}`,r)}addSalesOrder(e){return this.http.post(this.apiUrl+"/pv-api/sale_order/",e)}updateSalesOrder(e,r){return this.http.put(`${this.apiUrl+"/pv-api/sale_order/?sale_order_id="}${r}`,e)}deleteSalesOrder(e){return this.http.delete(`${this.apiUrl+"/pv-api/sale_order/?id="}${e}`)}getSalesEstimatefy(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/estimate/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getSalesEstimate(){return this.http.get(this.apiUrl+"/pv-api/estimate/")}getSalesEstimateByUserId(e){return this.http.get(this.apiUrl+"/pv-api/estimate/?user_id="+e)}getSalesEstimateById(e){return this.http.get(`${this.apiUrl+"/pv-api/estimate/?id="}${e}`)}SalesEstimateIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/estimate/?id="}${e}`,r)}addSalesEstimate(e){return this.http.post(this.apiUrl+"/pv-api/estimate/",e)}updateSalesEstimate(e,r){return this.http.put(`${this.apiUrl+"/pv-api/estimate/?estimate_id="}${r}`,e)}deleteSalesEstimate(e){return this.http.delete(`${this.apiUrl+"/pv-api/estimate/?id="}${e}`)}getSalesBillfyWithProductId(e,r,a){let l=this.apiUrl+"/pv-api/sale_bill/";const s=new URLSearchParams;return s.append("financial_year",e),s.append("product_id",String(r)),s.append("start_date",a.s),s.append("end_date",a.e),this.http.get(l+(s.toString()?"?"+s.toString():""))}getSalesBillfy(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/sale_bill/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getSalesBill(){return this.http.get(this.apiUrl+"/pv-api/sale_bill/")}getSalesBillById(e){return this.http.get(`${this.apiUrl+"/pv-api/sale_bill/?id="}${e}`)}getSalesBillByUserId(e){return this.http.get(`${this.apiUrl+"/pv-api/sale_bill/?user_id="}${e}`)}SalesBillIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/sale_bill/?id="}${e}`,r)}addSalesBill(e){return this.http.post(this.apiUrl+"/pv-api/sale_bill/",e)}updateSalesBill(e,r){return this.http.put(`${this.apiUrl+"/pv-api/sale_bill/?sale_bill_id="}${r}`,e)}deleteSalesBill(e){return this.http.delete(`${this.apiUrl+"/pv-api/sale_bill/?id="}${e}`)}getSalesMaterialOutwardfy(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/material_outward/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getSalesMaterialOutward(){return this.http.get(this.apiUrl+"/pv-api/material_outward/")}getSalesMaterialOutwardById(e){return this.http.get(`${this.apiUrl+"/pv-api/material_outward/?id="}${e}`)}SalesMaterialOutwardIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/material_outward/?id="}${e}`,r)}addSalesMaterialOutward(e){return this.http.post(this.apiUrl+"/pv-api/material_outward/",e)}updateSalesMaterialOutward(e,r){return this.http.put(`${this.apiUrl+"/pv-api/material_outward/?material_outward_id="}${r}`,e)}deleteSalesMaterialOutward(e){return this.http.delete(`${this.apiUrl+"/pv-api/material_outward/?id="}${e}`)}getSaleReturnfy(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/sale_return/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getSaleReturn(){return this.http.get(this.apiUrl+"/pv-api/sale_return/")}getSaleReturnById(e){return this.http.get(`${this.apiUrl+"/pv-api/sale_return/?id="}${e}`)}SaleReturnIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/sale_return/?id="}${e}`,r)}addSaleReturn(e){return this.http.post(this.apiUrl+"/pv-api/sale_return/",e)}updateSaleReturn(e,r){return this.http.put(`${this.apiUrl+"/pv-api/sale_return/?sale_return_id="}${r}`,e)}deleteSaleReturn(e){return this.http.delete(`${this.apiUrl+"/pv-api/sale_return/?id="}${e}`)}getSearchProductById(e){return this.http.get(`${this.apiUrl+"/pv-api/variant-search/?search="}${e}`)}getSearchProduct(){return this.http.get(this.apiUrl+"/pv-api/variant-search/")}filterVariant(e,r,a){let l=this.apiUrl+"/pv-api/sales_product_filter/";const s=[];return e&&s.push(`category=${e}`),r&&s.push(`subcategory=${r}`),a&&s.push(`search=${a}`),s.length>0&&(l+="?"+s.join("&")),this.http.get(l)}getSaleOrderPrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=SaleOrder")}getSaleBillPrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=SaleBill")}getSaleReturnPrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=SaleReturn")}getEstimatePrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=Estimate")}getMaterialOutwardPrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=MaterialOutward")}getAdvanceBookingPrefix(){return this.http.get(this.apiUrl+"/pv-api/prefix/?id=AdvanceBooking")}getUser(e){return this.http.get(this.apiUrl+"/pv-api/contact-user/?search="+e)}getAdvanceBookingfy(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/advance_booking/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getAdvanceBooking(){return this.http.get(this.apiUrl+"/pv-api/advance_booking/")}getAdvanceBookingById(e){return this.http.get(`${this.apiUrl+"/pv-api/advance_booking/?id="}${e}`)}AdvanceBookingIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/advance_booking/?id="}${e}`,r)}addAdvanceBooking(e){return this.http.post(this.apiUrl+"/pv-api/advance_booking/",e)}updateAdvanceBooking(e,r){return this.http.put(`${this.apiUrl+"/pv-api/advance_booking/?id="}${r}`,e)}deleteAdvanceBooking(e){return this.http.delete(`${this.apiUrl+"/pv-api/advance_booking/?id="}${e}`)}getDelivryChallanFY(e,r){console.log(r,"branch"),console.log(r.length,"branch");let a=this.apiUrl+"/pv-api/delivery_challan/";const l=[];if(e&&l.push(`financial_year=${e}`),r&&r.length>0){const s=JSON.stringify(r);console.log(s),console.log(s?.length),l.push(`branch=${s}`)}return l.length>0&&(a+="?"+l.join("&")),this.http.get(a)}getDelivryChallan(){return this.http.get(this.apiUrl+"/pv-api/delivery_challan/")}getDelivryChallanById(e){return this.http.get(`${this.apiUrl+"/pv-api/delivery_challan/?id="}${e}`)}DelivryChallanIsActive(e,r){return this.http.patch(`${this.apiUrl+"/pv-api/delivery_challan/?id="}${e}`,r)}addDelivryChallan(e){return this.http.post(this.apiUrl+"/pv-api/delivery_challan/",e)}updateDelivryChallan(e,r){return this.http.put(`${this.apiUrl+"/pv-api/delivery_challan/?id="}${r}`,e)}deleteDelivryChallan(e){return this.http.delete(`${this.apiUrl+"/pv-api/delivery_challan/?id="}${e}`)}advanceBookingStatusUpdate(e){return this.http.post(this.apiUrl+"/pv-api/advance_booking_status_update/",e)}deliveryChallanStatusUpdate(e){return this.http.post(this.apiUrl+"/pv-api/delivery_challan_status_update/",e)}}return _.\u0275fac=function(e){return new(e||_)(y.LFG(c.eN))},_.\u0275prov=y.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},84939:(I,x,u)=>{u.r(x),u.d(x,{AddScrapEntryModule:()=>et});var m=u(36895),y=u(4392),c=u(24006),A=u(68675),_=u(54004),t=u(94650),e=u(72170),r=u(80927),a=u(97185),l=u(53506),s=u(71071),f=u(43443),E=u(47957),P=u(3238),S=u(59549),$=u(44144);function Z(o,g){1&o&&(t.TgZ(0,"span",25),t._uU(1,"Select Date"),t.qZA())}function M(o,g){if(1&o&&(t.TgZ(0,"option",26),t._uU(1),t.qZA()),2&o){const i=g.$implicit;t.s9C("value",i.id),t.xp6(1),t.Oqu(i.prefix)}}function N(o,g){1&o&&(t.TgZ(0,"span",25),t._uU(1,"Enter Voucher No "),t.qZA())}function B(o,g){1&o&&(t.TgZ(0,"span",25),t._uU(1,"Enter Updater Name"),t.qZA())}function O(o,g){if(1&o){const i=t.EpF();t.TgZ(0,"span",27),t.NdJ("click",function(){t.CHM(i);const p=t.oxw();return t.KtG(p.addCart(0))}),t._uU(1,"Add Cart+"),t.qZA()}}function w(o,g){if(1&o){const i=t.EpF();t.O4$(),t.TgZ(0,"svg",59),t.NdJ("click",function(){t.CHM(i);const p=t.oxw().index,h=t.oxw();return t.KtG(h.addCart(p+1))}),t._UZ(1,"path",31)(2,"path",60),t.qZA()}}function F(o,g){if(1&o){const i=t.EpF();t.TgZ(0,"mat-option",62),t.NdJ("onSelectionChange",function(){t.CHM(i);const p=t.oxw().$implicit,h=t.oxw(2).index,d=t.oxw();return t.KtG(d.oncheckVariant(p,h))}),t._uU(1),t.qZA()}if(2&o){const i=t.oxw().$implicit;t.Q6J("value",(null==i?null:i.product_title)+" "+(null==i?null:i.variant_name)),t.xp6(1),t.hij(" ",(null==i?null:i.product_title)+" "+(null==i?null:i.variant_name)," ")}}function q(o,g){if(1&o&&(t.ynx(0),t.YNc(1,F,2,2,"mat-option",61),t.BQk()),2&o){const i=g.$implicit;t.xp6(1),t.Q6J("ngIf",1==i.is_active)}}function D(o,g){if(1&o&&(t.ynx(0),t.YNc(1,q,2,1,"ng-container",20),t.BQk()),2&o){const i=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",i.variantList)}}function J(o,g){1&o&&(t.TgZ(0,"mat-option",63),t._uU(1,"Loading..."),t.qZA())}function k(o,g){1&o&&(t.TgZ(0,"mat-option",26)(1,"a",64),t._uU(2,"+add Product"),t.qZA()()),2&o&&t.Q6J("value","No data found")}function L(o,g){1&o&&(t.TgZ(0,"mat-option",65),t._uU(1," Please Enter 3 or more characters "),t.qZA())}function R(o,g){1&o&&(t.TgZ(0,"span",66),t._uU(1,"Enter Unit"),t.qZA())}function Y(o,g){1&o&&(t.TgZ(0,"span",66),t._uU(1,"Enter QTY"),t.qZA())}function Q(o,g){if(1&o){const i=t.EpF();t.TgZ(0,"tr")(1,"td",68),t._uU(2),t.qZA(),t.TgZ(3,"td",68),t._uU(4),t.qZA(),t.TgZ(5,"td",68),t._uU(6),t.qZA(),t.TgZ(7,"td",68),t._uU(8),t.qZA(),t.TgZ(9,"td",68),t._uU(10),t.qZA(),t.TgZ(11,"td")(12,"button",69),t.NdJ("click",function(){const h=t.CHM(i).$implicit,d=t.oxw(3);return t.KtG(d.selecBatchtModel(h,d.batchCartIndex))}),t._uU(13,"Select"),t.qZA()()()}if(2&o){const i=g.$implicit,n=g.index;t.xp6(2),t.Oqu(n+1+"."),t.xp6(2),t.Oqu(null==i?null:i.mrp),t.xp6(2),t.hij("",null==i?null:i.cost_price," "),t.xp6(2),t.hij("",(null==i?null:i.discount)+"%"," "),t.xp6(2),t.Oqu((null==i?null:i.additional_discount)+"%")}}function G(o,g){if(1&o&&(t.TgZ(0,"div",7)(1,"div",5)(2,"div",15)(3,"table",16)(4,"thead")(5,"tr")(6,"th",67),t._uU(7," Sr.No."),t.qZA(),t.TgZ(8,"th",67),t._uU(9," MRP"),t.qZA(),t.TgZ(10,"th",67),t._uU(11," Purchase Price"),t.qZA(),t.TgZ(12,"th",67),t._uU(13," Discount %"),t.qZA(),t.TgZ(14,"th",67),t._uU(15," Additional Discount % "),t.qZA(),t.TgZ(16,"th",67),t._uU(17," Action"),t.qZA()()(),t.TgZ(18,"tbody"),t.YNc(19,Q,14,5,"tr",20),t.qZA()()()()()),2&o){const i=t.oxw(2);t.xp6(19),t.Q6J("ngForOf",i.selectBatch)}}function K(o,g){if(1&o){const i=t.EpF();t.ynx(0),t.TgZ(1,"tr",28)(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td")(5,"div")(6,"div",29),t.O4$(),t.TgZ(7,"svg",30),t.NdJ("click",function(){const h=t.CHM(i).index,d=t.oxw();return t.KtG(d.removeCart(h))}),t._UZ(8,"path",31)(9,"path",32),t.qZA()(),t.YNc(10,w,3,0,"svg",33),t.qZA()(),t.kcU(),t.TgZ(11,"td")(12,"input",34,35),t.NdJ("keyup",function(){const h=t.CHM(i).index,d=t.MAs(13),v=t.oxw();return t.KtG(v.getVariant(d.value,h,"barcode"))})("blur",function(){t.CHM(i);const p=t.oxw();return t.KtG(p.hideSearch())}),t.qZA()(),t.TgZ(14,"td",36)(15,"div",37)(16,"mat-form-field",38)(17,"input",39),t.NdJ("input",function(p){const d=t.CHM(i).index,v=t.oxw();return t.KtG(v.getVariant(p.target.value,d,""))}),t.qZA(),t.TgZ(18,"mat-autocomplete",null,40),t.YNc(20,D,2,1,"ng-container",41),t.YNc(21,J,2,0,"mat-option",42),t.YNc(22,k,3,1,"mat-option",43),t.YNc(23,L,2,0,"mat-option",44),t.qZA()()()(),t.TgZ(24,"td"),t._UZ(25,"input",45),t.YNc(26,R,2,0,"span",46),t.qZA(),t.TgZ(27,"td"),t._UZ(28,"input",47),t.YNc(29,Y,2,0,"span",46),t.TgZ(30,"i",48),t.NdJ("click",function(){const h=t.CHM(i).index,d=t.oxw();return t.KtG(d.openModalBatch(h))}),t.qZA(),t.TgZ(31,"div",49)(32,"div",50)(33,"div",51)(34,"div",52)(35,"h1",53),t._uU(36," Batch"),t.qZA(),t.TgZ(37,"button",54),t.NdJ("click",function(){t.CHM(i);const p=t.oxw();return t.KtG(p.closeModalBatch())}),t.TgZ(38,"span",55),t._uU(39,"\xd7"),t.qZA()()(),t.TgZ(40,"div",56),t.YNc(41,G,20,1,"div",57),t.qZA()()()()(),t.TgZ(42,"td"),t._UZ(43,"input",58),t.qZA()(),t.BQk()}if(2&o){const i=g.index,n=t.MAs(19),p=t.oxw();let h,d;t.xp6(1),t.Q6J("formGroupName",i),t.xp6(2),t.Oqu(i+1+"."),t.xp6(7),t.Q6J("ngIf",p.isLastCart(i)),t.xp6(2),t.Q6J("value",void 0!==p.barcode[i]?p.barcode[i]:""),t.uIk("data-index",i),t.xp6(5),t.Q6J("matAutocomplete",n),t.xp6(3),t.Q6J("ngIf",(null==(h=p.item_name(i))||null==h.value?null:h.value.length)>=1&&(null==(h=p.item_name(i))||null==h.value?null:h.value.length)>0),t.xp6(1),t.Q6J("ngIf",p.isSearch),t.xp6(1),t.Q6J("ngIf",0===(null==p.variantList?null:p.variantList.length)&&!p.isSearch),t.xp6(1),t.Q6J("ngIf",(null==(d=p.item_name(i))||null==d.value?null:d.value.length)<3),t.xp6(3),t.Q6J("ngIf",p.unit(i)&&p.unit(i).invalid&&p.unit(i).touched),t.xp6(3),t.Q6J("ngIf",p.qty(i)&&p.qty(i).invalid&&p.qty(i).touched),t.xp6(12),t.Q6J("ngIf",p.selectBatch)}}function V(o,g){1&o&&(t.TgZ(0,"button",70),t._uU(1,"Submit"),t.qZA())}function j(o,g){1&o&&(t.TgZ(0,"button",71),t._UZ(1,"span",72),t._uU(2," \xa0 Submit"),t.qZA())}const T=function(o){return{"is-invalid":o}},H=[{path:"",component:(()=>{class o{constructor(i,n,p,h,d,v,U,C){this.fb=i,this.saleService=n,this.coreService=p,this.toastrService=h,this.purchaseService=d,this.transactionService=v,this.router=U,this.commonService=C,this.minDate="",this.maxDate="",this.coastprice=[],this.originalPrice=[],this.isTaxAvailable=[],this.taxIntoRupees=[],this.tax=[],this.batchCostPrice=[],this.productControl=new c.NI(""),this.filteredOptions=[],this.filteredItemCode=[],this.isCart=!1,this.productList=[],this.isSearch=!1,this.loader=!1,this.variantList=[],this.myControl=new c.NI(""),this.barcode=[]}get f(){return this.scrapEntryForm.controls}ngOnInit(){const i=(new Date).toLocaleString("en-CA",{timeZone:"America/Vancouver"}).split(",")[0];this.scrapEntryForm=this.fb.group({voucher_no:new c.NI("",[c.kI.required]),date:new c.NI(i,[c.kI.required]),updater_name:new c.NI("",[c.kI.required]),cart_item:this.fb.array([])}),this.addCart(0),this.getProduct(),this.getPrefix(),this.ManageNameControl(0),this.ManageItemCodeControl(0);const n=localStorage.getItem("financialYear");this.dateValidation(n)}dateValidation(i){const n=this.scrapEntryForm.get("date"),{formattedMinDate:p,formattedMaxDate:h}=this.commonService.setMinMaxDates(n,i);this.minDate=p,this.maxDate=h}getPrefix(){this.transactionService.getScrapEntryVoucherPrefix().subscribe(i=>{console.log(i),i.success?(this.prefixNo=i?.data,this.scrapEntryForm.get("voucher_no").patchValue(this.prefixNo[0]?.id)):this.toaster.error(i.msg)},i=>{this.toastrService.error(i.error.msg)})}cart(){return this.fb.group({barcode:new c.NI("",[c.kI.required]),item_code:new c.NI("",[c.kI.required]),item_name:new c.NI("",[c.kI.required]),unit:new c.NI("",[c.kI.required]),qty:new c.NI(1,[c.kI.required]),reason:new c.NI(""),mrp:0})}getCart(){return this.scrapEntryForm.get("cart_item")}addCart(i){this.getCart().push(this.cart()),this.scrapEntryForm?.value?.cart_item?.length>0&&(this.ManageNameControl(i),this.ManageItemCodeControl(i)),this.isCart=!1}addCart2(i){const n=this.scrapEntryForm?.get("cart_item");this.getCart()?.push(this.cart()),this.ManageNameControl(n?.length-1),this.ManageItemCodeControl(n?.length-1)}removeCart(i){this.getCart().removeAt(i),0==this.scrapEntryForm?.value?.cart_item?.length&&(this.isCart=!0)}get voucher_no(){return this.scrapEntryForm.get("voucher_no")}get date(){return this.scrapEntryForm.get("date")}get updater_name(){return this.scrapEntryForm.get("updater_name")}unit(i){return this.getCart().controls[i].get("unit")}qty(i){return this.getCart().controls[i].get("qty")}item_name(i){return this.getCart().controls[i].get("item_name")}item_code(i){return this.getCart().controls[i].get("item_code")}getProduct(){this.coreService.getProducts().subscribe(i=>{console.log(i,"user"),this.productList=i})}ManageNameControl(i){console.log("index",i);var n=this.scrapEntryForm?.get("cart_item");this.filteredOptions[i]=n.at(i)?.get("item_name")?.valueChanges.pipe((0,A.O)(""),(0,_.U)(p=>this._filter5(p)))}_filter5(i){const n=i?.toLowerCase();return this.productList?.filter(p=>0===p?.title?.toLowerCase().indexOf(n))}ManageItemCodeControl(i){console.log("index",i);var n=this.scrapEntryForm?.get("cart_item");console.log(n,"arrayControl"),this.filteredItemCode[i]=n.at(i)?.get("item_code")?.valueChanges.pipe((0,A.O)(""),(0,_.U)(p=>this._filter6(p))),console.log(this.filteredItemCode)}_filter6(i){const n=i?.toLowerCase();return this.productList?.filter(p=>0===p?.item_code?.toLowerCase().indexOf(n))}isLastCart(i){return i===this.getCart().controls.length-1}oncheckVariant(i,n){console.log(i);const p=i.id;this.barcode[n]=i.sku,this.selecteProduct=i?.product,this.selectedProductName=i.product_title,this.selectBatch=i.batch,this.apiPurchaseTax=i?.product?.sale_tax?.amount_tax_slabs[0]?.tax?.tax_percentage||0,this.batchDiscount=i.batch[0]?.discount||0,this.isTaxAvailable[n]=i?.product?.sale_tax_including,this.batchCostPrice[n]=i?.batch[0]?.cost_price||0;let h=i?.batch[0]?.selling_price_offline||0,U=h-0*h/100,C=U-U*(100/118);this.taxIntoRupees[n]=C||0,this.originalCoastPrice=U+C,this.scrapEntryForm.get("cart_item").at(n).patchValue({barcode:p,item_code:i?.sku,item_name:i?.product_title,unit:i?.product?.unit?.title,qty:1,mrp:this.originalCoastPrice.toFixed(2)})}selecBatchtModel(i,n,p){const h=document.getElementById("batchModal");h&&(h.classList.remove("show"),h.style.display="none");const d=this.scrapEntryForm.get("cart_item").at(n);let v=i?.cost_price*i?.discount/100;console.log(v);let C=i?.cost_price-v+(i?.cost_price-v);this.getCart().controls[n].controls?.mrp.setValue(i?.mrp),console.log(C),i?.stock>0?d.patchValue({mrp:i?.mrp,qty:i?.stock}):this.toastrService.error("Stock is not available at this price")}closeModalBatch(){const i=document.getElementById("batchModal");i&&(i.classList.remove("show"),i.style.display="none")}openModalBatch(i){this.batchCartIndex=i;const n=document.getElementById("batchModal");n&&(n.classList.add("show"),n.style.display="block")}calculateSubtotal(){let i=0;for(let n=0;n<this.getCart().controls.length;n++){const p=this.getCart().controls[n].get("qty"),h=this.getCart().controls[n].get("mrp");p&&h&&(i+=(+h.value||0)*(+p.value||0))}return i}purchase(i){const n=this.calculatePurchaseEveryIndex(i);this.coastprice[i]=n.toFixed(2)}calculatePurchaseEveryIndex(i){return this.batchCostPrice[i]=this.coastprice[i],0}submit(){if(console.log(this.scrapEntryForm.value),this.calculateSubtotal(),this.scrapEntryForm.valid){this.loader=!0;let n=new FormData;n.append("date",this.scrapEntryForm.get("date")?.value),n.append("voucher_no",this.scrapEntryForm.get("voucher_no")?.value),n.append("updater_name",this.scrapEntryForm.get("updater_name")?.value);const p=this.scrapEntryForm.get("cart_item"),h=[];p.controls.forEach(d=>{const v=d,U={};Object.keys(v.controls).forEach(C=>{const b=v.controls[C];let rt=null===b.value||0===b.value.length?"":b.value;U[C]=isNaN(b.value)||""===rt?b.value:parseFloat(b.value)}),h.push(U)}),n.append("cart_item",JSON.stringify(h)),this.transactionService.addScrapEntry(n).subscribe(d=>{console.log(d),d.success?(this.loader=!1,this.toastrService.success(d.msg),this.router.navigate(["/transaction/scarp-entry-list"])):(this.loader=!1,this.toastrService.error(d.msg))},d=>{this.loader=!1,this.toastrService.error(d.message)})}else this.scrapEntryForm.markAllAsTouched(),this.toastrService.error("Please Submit Required Field")}getVariant(i){this.transactionService.searchProduct(i).subscribe(n=>{console.log(n),this.isSearch=!1,this.variantList=n,console.log(this.variantList)})}}return o.\u0275fac=function(i){return new(i||o)(t.Y36(c.qu),t.Y36(e.M),t.Y36(r.p),t.Y36(a._W),t.Y36(l.x),t.Y36(s.p),t.Y36(y.F0),t.Y36(f.R))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-add-scrap-entry"]],decls:62,vars:17,consts:[[1,"page-header"],[1,"page-title"],["id","purchaseForm",1,"card"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-3","col-sm-4","col-12"],[1,"form-group"],["type","date","formControlName","date",3,"ngClass"],["class","text-danger",4,"ngIf"],["formControlName","voucher_no"],["value","","selected","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","updater_name","placeholder","Enter Updater Name",3,"ngClass"],[1,"card"],[1,"table-responsive"],[1,"table","datanew"],["colspan","3"],["class","debitIntoCart",3,"click",4,"ngIf"],["formArrayName","cart_item"],[4,"ngFor","ngForOf"],[1,"col-lg-12"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],["routerLink","//transaction/scarp-entry-list",1,"btn","btn-cancel"],[1,"text-danger"],[3,"value"],[1,"debitIntoCart",3,"click"],[3,"formGroupName"],[1,"me-2"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-x-circle",2,"color","red",3,"click"],["d","M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"],["d","M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"],["style","color:green","xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","class","bi bi-plus-circle","viewBox","0 0 16 16",3,"click",4,"ngIf"],["type","text","placeholder","Search Barcode",1,"input",3,"value","keyup","blur"],["id",""],["colspan","1"],[1,"form-group",2,"margin-bottom","0"],[1,"w-100",2,"padding","0","width","100%","min-width","100%","border-top","none"],["type","text","placeholder","Search Product","aria-label","Search Products","matInput","","formControlName","item_name",2,"box-sizing","border-box",3,"matAutocomplete","input"],["autos","matAutocomplete"],[4,"ngIf"],["style","color:#FF9F43",4,"ngIf"],[3,"value",4,"ngIf"],["class","is-loading",4,"ngIf"],["type","text","placeholder","Enter Unit","formControlName","unit","readonly","",1,"input"],["class","text-danger d-block",4,"ngIf"],["type","number","placeholder","Enter Qty","formControlName","qty","min","0",1,"input"],["data-bs-toggle","tooltip","title","ion-information",1,"ion-information","circle",3,"click"],["id","batchModal","tabindex","-1","role","dialog","aria-labelledby","addressModalLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","staticBackdropLabel",1,"modal-title","fs-5"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["class","form-group",4,"ngIf"],["type","text","placeholder","Enter Reason","formControlName","reason",1,"input"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-plus-circle",2,"color","green",3,"click"],["d","M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"],["style","color:#FF9F43",3,"value","onSelectionChange",4,"ngIf"],[2,"color","#FF9F43",3,"value","onSelectionChange"],[2,"color","#FF9F43"],["routerLink","//product/addproduct",2,"color","#FF9F43"],[1,"is-loading"],[1,"text-danger","d-block"],[1,"boder","space-text"],[1,"boder"],["type","button",1,"btn","btn-primary","btn-sm",2,"float","right",3,"click"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h4"),t._uU(3,"Scrap Entry Add"),t.qZA(),t.TgZ(4,"h6"),t._uU(5,"Add/Update Scrap Entry"),t.qZA()()(),t.TgZ(6,"div",2)(7,"div",3)(8,"form",4),t.NdJ("ngSubmit",function(){return n.submit()}),t.TgZ(9,"div",5)(10,"div",6)(11,"div",7)(12,"label"),t._uU(13,"Date*"),t.qZA(),t._UZ(14,"input",8),t.YNc(15,Z,2,0,"span",9),t.qZA()(),t.TgZ(16,"div",6)(17,"div",7)(18,"label"),t._uU(19,"Voucher No*"),t.qZA(),t.TgZ(20,"select",10)(21,"option",11),t._uU(22,"Select Voucher No"),t.qZA(),t.YNc(23,M,2,2,"option",12),t.qZA(),t.YNc(24,N,2,0,"span",9),t.qZA()(),t.TgZ(25,"div",6)(26,"div",7)(27,"label"),t._uU(28,"Updater Name*"),t.qZA(),t._UZ(29,"input",13),t.YNc(30,B,2,0,"span",9),t.qZA()()(),t.TgZ(31,"div",14)(32,"div",3)(33,"div",15)(34,"table",16)(35,"thead")(36,"tr")(37,"th"),t._uU(38,"#"),t.qZA(),t._UZ(39,"th"),t.TgZ(40,"th"),t._uU(41,"Item Code"),t.qZA(),t.TgZ(42,"th"),t._uU(43,"Item Name"),t.qZA(),t.TgZ(44,"th"),t._uU(45,"Unit"),t.qZA(),t.TgZ(46,"th"),t._uU(47,"QTY"),t.qZA(),t.TgZ(48,"th"),t._uU(49,"Reason"),t.qZA(),t._UZ(50,"th"),t.qZA(),t.TgZ(51,"tr")(52,"th",17),t.YNc(53,O,2,0,"span",18),t.qZA()()(),t.TgZ(54,"tbody"),t.ynx(55,19),t.YNc(56,K,44,13,"ng-container",20),t.BQk(),t.qZA()()()()(),t.TgZ(57,"div",21),t.YNc(58,V,2,0,"button",22),t.YNc(59,j,3,0,"button",23),t.TgZ(60,"a",24),t._uU(61,"Cancel"),t.qZA()()()()()),2&i&&(t.xp6(8),t.Q6J("formGroup",n.scrapEntryForm),t.xp6(6),t.Q6J("ngClass",t.VKq(13,T,n.f.date.touched&&n.f.date.invalid)),t.uIk("min",n.minDate)("max",n.maxDate),t.xp6(1),t.Q6J("ngIf",n.date&&n.date.invalid&&n.date.touched),t.xp6(8),t.Q6J("ngForOf",n.prefixNo),t.xp6(1),t.Q6J("ngIf",n.voucher_no&&n.voucher_no.invalid&&n.voucher_no.touched),t.xp6(5),t.Q6J("ngClass",t.VKq(15,T,n.f.updater_name.touched&&n.f.updater_name.invalid)),t.xp6(1),t.Q6J("ngIf",n.updater_name&&n.updater_name.invalid&&n.updater_name.touched),t.xp6(23),t.Q6J("ngIf",n.isCart),t.xp6(3),t.Q6J("ngForOf",n.getCart().controls),t.xp6(2),t.Q6J("ngIf",!n.loader),t.xp6(1),t.Q6J("ngIf",n.loader))},dependencies:[m.mk,m.sg,m.O5,y.yS,c._Y,c.YN,c.Kr,c.Fj,c.wV,c.EJ,c.JJ,c.JL,c.qQ,c.sg,c.u,c.x0,c.CE,E.XC,E.ZL,P.ey,S.KE,$.Nt],styles:[".mat-autocomplete-trigger.mat-input-element.mat-form-field-autofill-control.ng-tns-c116-0.ng-untouched.ng-pristine.ng-valid.cdk-text-field-autofill-monitored.is-invalid[_ngcontent-%COMP%], .mat-autocomplete-trigger.form-control.ng-pristine.ng-invalid.ng-touched[_ngcontent-%COMP%], .input.ng-pristine.ng-invalid.ng-touched[_ngcontent-%COMP%], .ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%], .ng-pristine.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}select[_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], input[type=datetime-local][_ngcontent-%COMP%], .input[_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;padding:10px 15px;border-radius:5px}.circle[_ngcontent-%COMP%]{margin-top:10px;display:inline-block;width:18px;height:18px;border-radius:50%;border:1px solid #FF9F43;text-align:center;line-height:16px;color:#ff9f43}"]}),o})(),canActivate:[u(30597).l],data:{allowedRoles:["add_scarpentry"]}}];let X=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[y.Bz.forChild(H),y.Bz]}),o})();var tt=u(8468);let et=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.ez,X,tt.I,E.Bb,S.lN,$.c]}),o})()},30597:(I,x,u)=>{u.d(x,{l:()=>t});var m=u(94650),y=u(4392),c=u(97185),A=u(42917),_=u(80927);let t=(()=>{class e{constructor(a,l,s,f,E){this.router=a,this.Arout=l,this.toastr=s,this.profileService=f,this.coreService=E}canActivate(a,l){const s=JSON.parse(localStorage.getItem("auth"));if(this.profileService.userDetails$.subscribe(f=>{this.userDetails=f,this.permissions=this.userDetails?.permission}),s){const f=a.data.allowedRoles,E=s.some(S=>f.includes(S.codename));let P=this.coreService.profileData$.value;if(P&&P.username){this.userDetails=P,this.profileService.setUserDetails(this.userDetails),this.profileService.ProfileData$.next(P);const S=P?.permission,$=this.profileService.getUserDetails();(!$||$.length!==S.length)&&(this.profileService.setUserPermission(S),window.location.reload())}else this.coreService.getProfile().subscribe(S=>{this.userDetails=S,this.profileService.setUserDetails(this.userDetails),this.profileService.ProfileData$.next(S);const $=S?.permission,Z=this.profileService.getUserDetails();(!Z||Z.length!==$.length)&&(this.profileService.setUserPermission($),window.location.reload())});if(E)return!0}return this.toastr.error("User have Not Permission to Access This page"),this.router.navigate(["/dashboard"]),!1}}return e.\u0275fac=function(a){return new(a||e)(m.LFG(y.F0),m.LFG(y.gz),m.LFG(c._W),m.LFG(A.J),m.LFG(_.p))},e.\u0275prov=m.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);