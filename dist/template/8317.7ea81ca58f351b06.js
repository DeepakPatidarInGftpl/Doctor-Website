"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[8317],{98317:(R,g,r)=>{r.r(g),r.d(g,{AddRecieptVoucherModule:()=>J});var l=r(36895),p=r(88996),t=r(24006),f=r(68675),A=r(54004),e=r(94650),b=r(54270),y=r(97185),C=r(71071),m=r(47957),Z=r(3238),v=r(59549),_=r(44144),h=r(3848);function N(i,c){if(1&i){const n=e.EpF();e.TgZ(0,"mat-option",36),e.NdJ("onSelectionChange",function(){const s=e.CHM(n).$implicit,d=e.oxw();return e.KtG(d.oncheck(s.id))}),e._uU(1),e.qZA()}if(2&i){const n=c.$implicit;e.Q6J("value",n.mobile_no),e.xp6(1),e.Oqu(n.mobile_no)}}function I(i,c){1&i&&(e.TgZ(0,"mat-option",38),e._uU(1,"Please Enter 3 or more characters"),e.qZA())}function w(i,c){if(1&i&&(e.ynx(0),e.YNc(1,I,2,0,"mat-option",37),e.BQk()),2&i){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==n.customerControl.value?null:n.customerControl.value.length)<3)}}function F(i,c){1&i&&(e.TgZ(0,"span",39),e._uU(1,"Select customer "),e.qZA())}function T(i,c){1&i&&(e.TgZ(0,"button",40),e._uU(1,"Submit"),e.qZA())}function V(i,c){1&i&&(e.TgZ(0,"button",41),e._UZ(1,"span",42),e._uU(2," Submit"),e.qZA())}const u=function(i){return{"is-invalid":i}},k=[{path:"",component:(()=>{class i{constructor(n,o,a,s,d){this.fb=n,this.posService=o,this.toastr=a,this.router=s,this.transactionService=d,this.customerControlName="customer",this.customerControl=new t.NI,this.productOption=[],this.accountList=[],this.loaders=!1}get f(){return this.recieptAdvanceForm.controls}get g(){return this.recieptAdvanceForm.controls}get h(){return this.recieptVoucherForm.controls}ngOnInit(){this.recieptAdvanceForm=this.fb.group({customer:new t.NI("",[t.kI.required]),receipt_method:new t.NI("Advance",[t.kI.required]),payment_mode:new t.NI("",[t.kI.required]),amount:new t.NI("",[t.kI.required]),description:new t.NI("",[t.kI.required]),bill_no:new t.NI(""),card_detail:new t.cw({payment_account:new t.NI(""),customer_bank_name:new t.NI(""),card_payment_amount:new t.NI(""),card_holder_name:new t.NI(""),cart_transactions_no:new t.NI("")}),bank_detail:new t.cw({payment_account:new t.NI(""),account_no:new t.NI("")}),upi_detail:new t.cw({upi_no:new t.NI(""),payment_account:new t.NI("")})}),this.recieptAgainstForm=this.fb.group({customer:new t.NI("",[t.kI.required]),receipt_method:new t.NI("Against Bill",[t.kI.required]),payment_mode:new t.NI("",[t.kI.required]),amount:new t.NI("",[t.kI.required]),description:new t.NI("",[t.kI.required]),bill_no:new t.NI(""),card_detail:new t.cw({payment_account:new t.NI(""),customer_bank_name:new t.NI(""),card_payment_amount:new t.NI(""),card_holder_name:new t.NI(""),cart_transactions_no:new t.NI("")}),bank_detail:new t.cw({payment_account:new t.NI(""),account_no:new t.NI("")}),upi_detail:new t.cw({upi_no:new t.NI(""),payment_account:new t.NI("")})});const n=(new Date).toISOString().split("T")[0];this.recieptVoucherForm=this.fb.group({receipt_type:new t.NI(""),customer:new t.NI(""),date:new t.NI(n),receipt_voucher_no:new t.NI(""),mode_type:new t.NI(""),amount:new t.NI(""),note:new t.NI(""),payer:new t.NI(""),bank_payment:new t.NI(""),transaction_id:new t.NI(""),transaction_date:new t.NI(""),receipt_voucher_cart:this.fb.array([])}),this.filteredCustomer=this.customerControl.valueChanges.pipe((0,f.O)(""),(0,A.U)(o=>this._filter(o,!0))),this.getBank(),this.getAccount()}cart(){return this.fb.group({sale_bill:new t.NI(0),original_amount:new t.NI(0),paid_amount:new t.NI(0),pending_amount:new t.NI(0),payment:new t.NI(0)})}getCart(){return this.recieptVoucherForm.get("receipt_voucher_cart")}addCart(){this.getCart().push(this.cart())}removeCart(n){this.getCart().removeAt(n)}setRadioValue(n){this.recieptVoucherForm.get("mode_type").setValue(n)}getBank(){this.posService.getCompanyBank().subscribe(n=>{this.bankList=n})}getAccount(){this.transactionService.getAccount().subscribe(n=>{this.accountList=n})}_filter(n,o){const a="number"==typeof n?n.toString().toLowerCase():n.toLowerCase(),s=this.accountList.filter(o?d=>d.account_id.toString().toLowerCase().includes(a):d=>!d.account_id.toString().toLowerCase().includes(a));return!o&&0===s.length&&s.push({name:"No data found"}),s}get customer(){return this.recieptAdvanceForm.get("customer")}oncheck(n){this.recieptVoucherForm.patchValue({customer:n})}getSles(n){this.posService.getReceiptOrder(n).subscribe(o=>{this.salesList=o})}onSubmit(){if(console.log(this.recieptVoucherForm.value),this.recieptAdvanceForm.valid){const n=new FormData;switch(n.append("customer",this.recieptAdvanceForm.get("customer")?.value),n.append("receipt_method",this.recieptAdvanceForm.get("receipt_method")?.value),n.append("payment_mode",this.recieptAdvanceForm.get("payment_mode")?.value),n.append("amount",this.recieptAdvanceForm.get("amount")?.value),n.append("description",this.recieptAdvanceForm.get("description")?.value),n.append("bill_no",this.recieptAdvanceForm.get("bill_no")?.value),this.f.payment_mode.value){case"Card":n.append("card_detail",JSON.stringify(this.f.card_detail.value));break;case"Bank":n.append("bank_detail",JSON.stringify(this.f.bank_detail.value));break;case"UPI":n.append("upi_detail",JSON.stringify(this.f.upi_detail.value))}this.loaders=!0,this.posService.receiptPayment(n).subscribe(a=>{this.loaders=!1,a.isSuccess?(this.toastr.success(a.msg),this.router.navigate(["//bank/reciept"])):(this.loaders=!1,this.toastr.error(a.msg))},a=>{this.loaders=!1,this.toastr.error(a.error.payment_account[0],"Payment Account")})}else this.recieptAdvanceForm.markAllAsTouched()}onAgainstSubmit(){if(this.recieptAdvanceForm.valid){const n=new FormData;switch(n.append("customer",this.recieptAdvanceForm.get("customer")?.value),n.append("receipt_method",this.recieptAdvanceForm.get("receipt_method")?.value),n.append("payment_mode",this.recieptAdvanceForm.get("payment_mode")?.value),n.append("amount",this.recieptAdvanceForm.get("amount")?.value),n.append("description",this.recieptAdvanceForm.get("description")?.value),n.append("bill_no",this.recieptAdvanceForm.get("bill_no")?.value),this.f.payment_mode.value){case"Card":n.append("card_detail",JSON.stringify(this.f.card_detail.value));break;case"Bank":n.append("bank_detail",JSON.stringify(this.f.bank_detail.value));break;case"UPI":n.append("upi_detail",JSON.stringify(this.f.upi_detail.value))}this.loaders=!0,this.posService.receiptPayment(n).subscribe(a=>{this.loaders=!1,a.isSuccess?(this.toastr.success(a.msg),this.router.navigate(["//bank/reciept"])):(this.loaders=!1,this.toastr.error(a.msg))},a=>{this.loaders=!1,this.toastr.error(a.error.payment_account[0],"Payment Account")})}else this.recieptAdvanceForm.markAllAsTouched()}get receipt_method(){return this.recieptAdvanceForm.get("receipt_method")}get payment_mode(){return this.recieptAdvanceForm.get("payment_mode")}get amount(){return this.recieptAdvanceForm.get("amount")}get description(){return this.recieptAdvanceForm.get("description")}get bill_no(){return this.recieptAdvanceForm.get("bill_no")}}return i.\u0275fac=function(n){return new(n||i)(e.Y36(t.qu),e.Y36(b.v),e.Y36(y._W),e.Y36(p.F0),e.Y36(C.p))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-reciept-voucher"]],decls:96,vars:34,consts:[[1,"page-header"],[1,"page-title"],["label","Cash"],[1,"card"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-4","col-sm-4","col-12"],[1,"form-group"],["type","radio","formControlName","receipt_type",3,"ngModel"],["for",""],[1,"col-lg-4","col-md-6","col-12"],[1,"w-100",2,"padding","0","width","100%","min-width","100%","border-top","none"],["type","text","placeholder","Search Customer","aria-label","Customer","matInput","",2,"box-sizing","border-box",3,"formControl","matAutocomplete","ngClass"],["auto","matAutocomplete"],["style","color:#FF9F43",3,"value","onSelectionChange",4,"ngFor","ngForOf"],[4,"ngIf"],["class","text-danger",4,"ngIf"],["type","number","formControlName","date","id","date",3,"ngClass"],[1,"col-lg-10","col-sm-10","col-12"],[1,"card",3,"click"],[1,"display-flex"],[1,"display-block"],["type","radio","formControlName","mode_type","id","on-account-radio",3,"value"],["for","on-account-radio"],["type","radio","formControlName","mode_type","id","advance-payment-radio",3,"value"],["for","advance-payment-radio"],["type","radio","formControlName","mode_type","id","against-bill-radio",3,"value"],["for","against-bill-radio"],["type","number","formControlName","amount","id","amount",3,"ngClass"],["formControlName","note",3,"ngClass"],[1,"col-lg-12"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],["routerLink","//bank/reciept",1,"btn","btn-cancel"],["label","Bank"],[2,"color","#FF9F43",3,"value","onSelectionChange"],["class","is-loading",4,"ngIf"],[1,"is-loading"],[1,"text-danger"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(n,o){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4"),e._uU(3,"Reciept Voucher Add"),e.qZA(),e.TgZ(4,"h6"),e._uU(5,"Add/Update Reciept Voucher"),e.qZA()()(),e.TgZ(6,"mat-tab-group")(7,"mat-tab",2)(8,"div",3)(9,"div",4)(10,"form",5),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(11,"div",6)(12,"div",7)(13,"div",8)(14,"label"),e._uU(15,"Receipt Type*"),e.qZA(),e._UZ(16,"input",9),e.TgZ(17,"label",10),e._uU(18,"Cash"),e.qZA()()(),e.TgZ(19,"div",11)(20,"div",8)(21,"label"),e._uU(22,"Customer*"),e.qZA(),e.TgZ(23,"mat-form-field",12),e._UZ(24,"input",13),e.TgZ(25,"mat-autocomplete",null,14),e.YNc(27,N,2,2,"mat-option",15),e.ALo(28,"async"),e.YNc(29,w,2,1,"ng-container",16),e.ALo(30,"async"),e.qZA()(),e.YNc(31,F,2,0,"span",17),e.qZA()(),e.TgZ(32,"div",7)(33,"div",8)(34,"label"),e._uU(35,"Date*"),e.qZA(),e._UZ(36,"input",18),e.qZA()(),e.TgZ(37,"div",19)(38,"div",8)(39,"div",6)(40,"div",7)(41,"div",20),e.NdJ("click",function(){return o.setRadioValue("On Account")}),e.TgZ(42,"div",4)(43,"div",21)(44,"div",22),e._UZ(45,"input",23),e.TgZ(46,"label",24),e._uU(47,"On Account"),e.qZA()(),e.TgZ(48,"span"),e._uU(49,"Upfront Payment"),e.qZA()()()()(),e.TgZ(50,"div",7)(51,"div",20),e.NdJ("click",function(){return o.setRadioValue("Advance Payment")}),e.TgZ(52,"div",4)(53,"div",21)(54,"div",22),e._UZ(55,"input",25),e.TgZ(56,"label",26),e._uU(57,"Advance Payment"),e.qZA()(),e.TgZ(58,"span"),e._uU(59,"Will be offset by upcoming bills"),e.qZA()()()()(),e.TgZ(60,"div",7)(61,"div",20),e.NdJ("click",function(){return o.setRadioValue("Against Bill")}),e.TgZ(62,"div",4)(63,"div",21)(64,"div",22),e._UZ(65,"input",27),e.TgZ(66,"label",28),e._uU(67,"Against Bill"),e.qZA()(),e.TgZ(68,"span"),e._uU(69,"Offset against Current Bills"),e.qZA()()()()()()()(),e.TgZ(70,"div",7)(71,"div",8)(72,"label"),e._uU(73,"Amount*"),e.qZA(),e._UZ(74,"input",29),e.qZA()(),e.TgZ(75,"div",7)(76,"div",8)(77,"label"),e._uU(78,"Amount*"),e.qZA(),e._UZ(79,"input",29),e.qZA()(),e.TgZ(80,"div",7)(81,"div",8)(82,"label"),e._uU(83,"Amount*"),e.qZA(),e._UZ(84,"input",29),e.qZA()(),e.TgZ(85,"div",7)(86,"div",8)(87,"label"),e._uU(88,"Description*"),e.qZA(),e._UZ(89,"textarea",30),e.qZA()(),e.TgZ(90,"div",31),e.YNc(91,T,2,0,"button",32),e.YNc(92,V,3,0,"button",33),e.TgZ(93,"a",34),e._uU(94,"Cancel"),e.qZA()()()()()()(),e._UZ(95,"mat-tab",35),e.qZA()),2&n){const a=e.MAs(26);e.xp6(10),e.Q6J("formGroup",o.recieptVoucherForm),e.xp6(6),e.Q6J("ngModel",!0),e.xp6(8),e.Q6J("formControl",o.customerControl)("matAutocomplete",a)("ngClass",e.VKq(22,u,o.h.customer.touched&&o.h.customer.invalid)),e.xp6(3),e.Q6J("ngForOf",e.lcZ(28,18,o.filteredCustomer)),e.xp6(2),e.Q6J("ngIf",e.lcZ(30,20,o.filteredCustomer)),e.xp6(2),e.Q6J("ngIf",o.customer&&o.customer.invalid&&o.customer.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(24,u,o.h.date.touched&&o.h.date.invalid)),e.xp6(9),e.Q6J("value","On Account"),e.xp6(10),e.Q6J("value","Advance Payment"),e.xp6(10),e.Q6J("value","Against Bill"),e.xp6(9),e.Q6J("ngClass",e.VKq(26,u,o.h.amount.touched&&o.h.amount.invalid)),e.xp6(5),e.Q6J("ngClass",e.VKq(28,u,o.h.amount.touched&&o.h.amount.invalid)),e.xp6(5),e.Q6J("ngClass",e.VKq(30,u,o.h.amount.touched&&o.h.amount.invalid)),e.xp6(5),e.Q6J("ngClass",e.VKq(32,u,o.h.note.touched&&o.h.note.invalid)),e.xp6(2),e.Q6J("ngIf",!o.loaders),e.xp6(1),e.Q6J("ngIf",o.loaders)}},dependencies:[l.mk,l.sg,l.O5,p.yS,t._Y,t.Fj,t.wV,t._,t.JJ,t.JL,t.oH,t.sg,t.u,m.XC,m.ZL,Z.ey,v.KE,_.Nt,h.SP,h.uX,l.Ov],styles:[".ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;padding:10px 15px;border-radius:5px}"]}),i})()}];let S=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[p.Bz.forChild(k),p.Bz]}),i})();var U=r(8468);let J=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[l.ez,S,U.I,m.Bb,v.lN,_.c,h.Nh]}),i})()}}]);