"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[900],{55609:(U,C,s)=>{s.r(C),s.d(C,{PurchaseModule:()=>G});var m=s(36895),Z=s(88996),n=s(24006),T=s(68675),I=s(54004),e=s(94650),c=s(54270),r=s(97185),d=s(53506),u=s(47957),l=s(3238),f=s(59549),h=s(44144),g=s(3848);function v(a,i){1&a&&(e.TgZ(0,"span",28),e._uU(1,"Select Payment Mode"),e.qZA())}function y(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"mat-option",29),e.NdJ("onSelectionChange",function(){const b=e.CHM(t).$implicit,A=e.oxw();return e.KtG(A.oncheck(b.id))}),e._uU(1),e.qZA()}if(2&a){const t=i.$implicit;e.Q6J("value",t.name),e.xp6(1),e.Oqu(t.name)}}function _(a,i){1&a&&(e.TgZ(0,"mat-option",31),e._uU(1,"Please Enter 3 or more characters"),e.qZA())}function P(a,i){if(1&a&&(e.ynx(0),e.YNc(1,_,2,0,"mat-option",30),e.BQk()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",(null==t.supplierControl.value?null:t.supplierControl.value.length)<3)}}function w(a,i){1&a&&(e.TgZ(0,"span",28),e._uU(1,"Select supplier "),e.qZA())}function F(a,i){1&a&&(e.TgZ(0,"span",28),e._uU(1,"Enter Amount"),e.qZA())}function q(a,i){if(1&a&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&a){const t=i.$implicit;e.s9C("value",t.id),e.xp6(1),e.Oqu(t.name)}}function x(a,i){if(1&a&&(e.TgZ(0,"div")(1,"div",32)(2,"div",7)(3,"div",8)(4,"label"),e._uU(5,"Payment Account*"),e.qZA(),e.TgZ(6,"select",33)(7,"option",10),e._uU(8,"Select Payment Account"),e.qZA(),e.YNc(9,q,2,2,"option",34),e.qZA()()(),e.TgZ(10,"div",7)(11,"div",8)(12,"label"),e._uU(13,"Bank Name*"),e.qZA(),e._UZ(14,"input",35),e.qZA()(),e.TgZ(15,"div",7)(16,"div",8)(17,"label"),e._uU(18,"Card Holder Name*"),e.qZA(),e._UZ(19,"input",36),e.qZA()(),e.TgZ(20,"div",7)(21,"div",8)(22,"label"),e._uU(23,"Payment Amount*"),e.qZA(),e._UZ(24,"input",37),e.qZA()(),e.TgZ(25,"div",7)(26,"div",8)(27,"label"),e._uU(28,"Card Transactions no*"),e.qZA(),e._UZ(29,"input",38),e.qZA()()()()),2&a){const t=e.oxw();e.xp6(9),e.Q6J("ngForOf",t.bankList)}}function k(a,i){if(1&a&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&a){const t=i.$implicit;e.s9C("value",t.id),e.xp6(1),e.Oqu(t.name)}}function J(a,i){if(1&a&&(e.TgZ(0,"div")(1,"div",40)(2,"div",7)(3,"div",8)(4,"label"),e._uU(5,"Payment Account"),e.qZA(),e.TgZ(6,"select",33)(7,"option",10),e._uU(8,"Select Payment Account"),e.qZA(),e.YNc(9,k,2,2,"option",34),e.qZA()()(),e.TgZ(10,"div",7)(11,"div",8)(12,"label"),e._uU(13,"Account no"),e.qZA(),e._UZ(14,"input",41),e.qZA()()()()),2&a){const t=e.oxw();e.xp6(9),e.Q6J("ngForOf",t.bankList)}}function O(a,i){if(1&a&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&a){const t=i.$implicit;e.s9C("value",t.id),e.xp6(1),e.Oqu(t.name)}}function M(a,i){if(1&a&&(e.TgZ(0,"div")(1,"div",42)(2,"div",7)(3,"div",8)(4,"label"),e._uU(5,"UPI Id"),e.qZA(),e._UZ(6,"input",43),e.qZA()(),e.TgZ(7,"div",7)(8,"div",8)(9,"label"),e._uU(10,"Payment Account"),e.qZA(),e.TgZ(11,"select",33)(12,"option",10),e._uU(13,"Select Payment Account"),e.qZA(),e.YNc(14,O,2,2,"option",34),e.qZA()()()()()),2&a){const t=e.oxw();e.xp6(14),e.Q6J("ngForOf",t.bankList)}}function Y(a,i){1&a&&(e.TgZ(0,"span",28),e._uU(1,"Enter description"),e.qZA())}function Q(a,i){1&a&&(e.TgZ(0,"button",44),e._uU(1,"Submit"),e.qZA())}function B(a,i){1&a&&(e.TgZ(0,"button",45),e._UZ(1,"span",46),e._uU(2," Submit"),e.qZA())}const N=function(a){return{"is-invalid":a}};let D=(()=>{class a{constructor(t,o,p,b,A){this.fb=t,this.posService=o,this.toastr=p,this.purchaseService=b,this.router=A,this.supplierControlName="party",this.supplierControl=new n.NI,this.productOption=[],this.suppliers=[],this.loaders=!1}get f(){return this.recieptAdvanceForm.controls}get g(){return this.recieptAdvanceForm.controls}ngOnInit(){this.recieptAdvanceForm=this.fb.group({party:new n.NI("",[n.kI.required]),receipt_method:new n.NI("Advance"),payment_mode:new n.NI("",[n.kI.required]),amount:new n.NI("",[n.kI.required]),description:new n.NI("",[n.kI.required]),bill_no:new n.NI(""),card_detail:new n.cw({payment_account:new n.NI(""),customer_bank_name:new n.NI(""),card_payment_amount:new n.NI(""),card_holder_name:new n.NI(""),cart_transactions_no:new n.NI("")}),bank_detail:new n.cw({payment_account:new n.NI(""),account_no:new n.NI("")}),upi_detail:new n.cw({upi_no:new n.NI(""),payment_account:new n.NI("")})}),this.recieptAgainstForm=this.fb.group({customer:new n.NI("",[n.kI.required]),receipt_method:new n.NI("Against Bill",[n.kI.required]),payment_mode:new n.NI("",[n.kI.required]),amount:new n.NI("",[n.kI.required]),description:new n.NI("",[n.kI.required]),bill_no:new n.NI(""),card_detail:new n.cw({payment_account:new n.NI(""),customer_bank_name:new n.NI(""),card_payment_amount:new n.NI(""),card_holder_name:new n.NI(""),cart_transactions_no:new n.NI("")}),bank_detail:new n.cw({payment_account:new n.NI(""),account_no:new n.NI("")}),upi_detail:new n.cw({upi_no:new n.NI(""),payment_account:new n.NI("")})}),this.filteredSuppliers=this.supplierControl.valueChanges.pipe((0,T.O)(""),(0,I.U)(t=>this._filter(t,!0))),this.getBank(),this.getSuuplier()}getBank(){this.posService.getCompanyBank().subscribe(t=>{this.bankList=t})}_filter(t,o){const p="string"==typeof t?t.toLowerCase():t.toString().toLowerCase(),b=this.suppliers.filter(o?A=>A.name.toLowerCase().includes(p):A=>!A.name.toLowerCase().includes(p));return!o&&0===b.length&&b.push({name:"No data found"}),b}get supplier(){return this.recieptAdvanceForm.get("party")}getSuuplier(){this.purchaseService.getSupplier().subscribe(t=>{this.suppliers=t})}oncheck(t){const o=t;this.getSles(o),this.recieptAdvanceForm.patchValue({party:o})}getSles(t){this.posService.getReceiptOrder(t).subscribe(o=>{this.salesList=o})}onSubmit(){if(this.recieptAdvanceForm.valid){const t=new FormData;switch(t.append("party",this.recieptAdvanceForm.get("party")?.value),t.append("receipt_method",this.recieptAdvanceForm.get("receipt_method")?.value),t.append("payment_mode",this.recieptAdvanceForm.get("payment_mode")?.value),t.append("amount",this.recieptAdvanceForm.get("amount")?.value),t.append("description",this.recieptAdvanceForm.get("description")?.value),t.append("bill_no",this.recieptAdvanceForm.get("bill_no")?.value),this.f.payment_mode.value){case"Card":t.append("card_detail",JSON.stringify(this.f.card_detail.value));break;case"Bank":t.append("bank_detail",JSON.stringify(this.f.bank_detail.value));break;case"UPI":t.append("upi_detail",JSON.stringify(this.f.upi_detail.value))}this.loaders=!0,this.posService.purchasePayment(t).subscribe(p=>{this.loaders=!1,p.isSuccess?(this.toastr.success(p.msg),this.router.navigate(["//bank/purchase"]),this.ngOnInit()):(this.loaders=!1,this.toastr.error(p.msg))},p=>{this.loaders=!1,this.toastr.error(p.error.payment_account[0],"Payment Account")})}else this.recieptAdvanceForm.markAllAsTouched()}onAgainstSubmit(){if(this.recieptAdvanceForm.valid){const t=new FormData;switch(t.append("party",this.recieptAdvanceForm.get("party")?.value),t.append("receipt_method",this.recieptAdvanceForm.get("receipt_method")?.value),t.append("payment_mode",this.recieptAdvanceForm.get("payment_mode")?.value),t.append("amount",this.recieptAdvanceForm.get("amount")?.value),t.append("description",this.recieptAdvanceForm.get("description")?.value),t.append("bill_no",this.recieptAdvanceForm.get("bill_no")?.value),this.f.payment_mode.value){case"Card":t.append("card_detail",JSON.stringify(this.f.card_detail.value));break;case"Bank":t.append("bank_detail",JSON.stringify(this.f.bank_detail.value));break;case"UPI":t.append("upi_detail",JSON.stringify(this.f.upi_detail.value))}this.loaders=!0,this.posService.purchasePayment(t).subscribe(p=>{this.loaders=!1,p.isSuccess?(this.toastr.success(p.msg),this.router.navigate(["//bank/purchase"]),this.ngOnInit()):(this.loaders=!1,this.toastr.error(p.msg))},p=>{this.loaders=!1,this.toastr.error(p.error.payment_account[0],"Payment Account")})}else this.recieptAdvanceForm.markAllAsTouched()}get receipt_method(){return this.recieptAdvanceForm.get("receipt_method")}get payment_mode(){return this.recieptAdvanceForm.get("payment_mode")}get amount(){return this.recieptAdvanceForm.get("amount")}get description(){return this.recieptAdvanceForm.get("description")}get bill_no(){return this.recieptAdvanceForm.get("bill_no")}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(n.qu),e.Y36(c.v),e.Y36(r._W),e.Y36(d.x),e.Y36(Z.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-purchase"]],decls:59,vars:30,consts:[[1,"page-header"],[1,"page-title"],["label","Advance Payment"],[1,"card"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-4","col-sm-4","col-12"],[1,"form-group"],["formControlName","payment_mode",1,"form-select",3,"ngClass"],["value","","selected","","disabled",""],["value","Card"],["value","Cash"],["value","Bank"],["value","UPI"],["class","text-danger",4,"ngIf"],[1,"col-lg-4","col-md-6","col-12"],[1,"w-100",2,"padding","0","width","100%","min-width","100%","border-top","none"],["type","text","placeholder","Search Party","aria-label","Party","matInput","",2,"box-sizing","border-box",3,"formControl","matAutocomplete","ngClass"],["auto","matAutocomplete"],["style","color:#FF9F43",3,"value","onSelectionChange",4,"ngFor","ngForOf"],[4,"ngIf"],["type","number","formControlName","amount","id","amount",3,"ngClass"],["formControlName","description",3,"ngClass"],[1,"col-lg-12"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],["routerLink","//bank/purchase",1,"btn","btn-cancel"],[1,"text-danger"],[2,"color","#FF9F43",3,"value","onSelectionChange"],["class","is-loading",4,"ngIf"],[1,"is-loading"],["formGroupName","card_detail",1,"row"],["formControlName","payment_account",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],["type","text","formControlName","customer_bank_name"],["type","text","formControlName","card_holder_name"],["type","number","formControlName","card_payment_amount"],["type","text","formControlName","cart_transactions_no"],[3,"value"],["formGroupName","bank_detail",1,"row"],["type","text","formControlName","account_no"],["formGroupName","upi_detail",1,"row"],["type","text","formControlName","upi_no"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4"),e._uU(3,"Purchase"),e.qZA()()(),e.TgZ(4,"mat-tab-group")(5,"mat-tab",2)(6,"div",3)(7,"div",4)(8,"form",5),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(9,"div",6)(10,"div",7)(11,"div",8)(12,"label"),e._uU(13,"Payment Mode*"),e.qZA(),e.TgZ(14,"select",9)(15,"option",10),e._uU(16,"Select Payment Mode"),e.qZA(),e.TgZ(17,"option",11),e._uU(18,"Card"),e.qZA(),e.TgZ(19,"option",12),e._uU(20,"Cash"),e.qZA(),e.TgZ(21,"option",13),e._uU(22,"Bank"),e.qZA(),e.TgZ(23,"option",14),e._uU(24,"UPI"),e.qZA()(),e.YNc(25,v,2,0,"span",15),e.qZA()(),e.TgZ(26,"div",16)(27,"div",8)(28,"label"),e._uU(29,"Party Name*"),e.qZA(),e.TgZ(30,"mat-form-field",17),e._UZ(31,"input",18),e.TgZ(32,"mat-autocomplete",null,19),e.YNc(34,y,2,2,"mat-option",20),e.ALo(35,"async"),e.YNc(36,P,2,1,"ng-container",21),e.ALo(37,"async"),e.qZA()(),e.YNc(38,w,2,0,"span",15),e.qZA()(),e.TgZ(39,"div",7)(40,"div",8)(41,"label"),e._uU(42,"Amount*"),e.qZA(),e._UZ(43,"input",22),e.YNc(44,F,2,0,"span",15),e.qZA()(),e.YNc(45,x,30,1,"div",21),e.YNc(46,J,15,1,"div",21),e.YNc(47,M,15,1,"div",21),e.TgZ(48,"div",7)(49,"div",8)(50,"label"),e._uU(51,"Description*"),e.qZA(),e._UZ(52,"textarea",23),e.YNc(53,Y,2,0,"span",15),e.qZA()(),e.TgZ(54,"div",24),e.YNc(55,Q,2,0,"button",25),e.YNc(56,B,3,0,"button",26),e.TgZ(57,"a",27),e._uU(58,"Cancel"),e.qZA()()()()()()()()),2&t){const p=e.MAs(33);e.xp6(8),e.Q6J("formGroup",o.recieptAdvanceForm),e.xp6(6),e.Q6J("ngClass",e.VKq(22,N,o.f.payment_mode.touched&&o.f.payment_mode.invalid)),e.xp6(11),e.Q6J("ngIf",o.payment_mode&&o.payment_mode.invalid&&o.payment_mode.touched),e.xp6(6),e.Q6J("formControl",o.supplierControl)("matAutocomplete",p)("ngClass",e.VKq(24,N,o.f.party.touched&&o.f.party.invalid)),e.xp6(3),e.Q6J("ngForOf",e.lcZ(35,18,o.filteredSuppliers)),e.xp6(2),e.Q6J("ngIf",e.lcZ(37,20,o.filteredSuppliers)),e.xp6(2),e.Q6J("ngIf",o.supplier&&o.supplier.invalid&&o.supplier.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(26,N,o.f.amount.touched&&o.f.amount.invalid)),e.xp6(1),e.Q6J("ngIf",o.amount&&o.amount.invalid&&o.amount.touched),e.xp6(1),e.Q6J("ngIf","Card"===o.f.payment_mode.value),e.xp6(1),e.Q6J("ngIf","Bank"===o.f.payment_mode.value),e.xp6(1),e.Q6J("ngIf","UPI"===o.f.payment_mode.value),e.xp6(5),e.Q6J("ngClass",e.VKq(28,N,o.f.description.touched&&o.f.description.invalid)),e.xp6(1),e.Q6J("ngIf",o.description&&o.description.invalid&&o.description.touched),e.xp6(2),e.Q6J("ngIf",!o.loaders),e.xp6(1),e.Q6J("ngIf",o.loaders)}},dependencies:[m.mk,m.sg,m.O5,Z.yS,n._Y,n.YN,n.Kr,n.Fj,n.wV,n.EJ,n.JJ,n.JL,n.oH,n.sg,n.u,n.x0,u.XC,u.ZL,l.ey,f.KE,h.Nt,g.SP,g.uX,m.Ov],styles:[".ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;padding:10px 15px;border-radius:5px}"]}),a})();var L=s(30597);const S=JSON.parse(localStorage.getItem("auth"));let E;S&&S.map(i=>{"pos"===i.content_type.app_label&&"payments"===i.content_type.model&&"add_payments"==i.codename&&(E=i.codename)});const R=[{path:"",component:D,canActivate:[L.l],data:{allowedRoles:["add_payments"]}}];let V=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[Z.Bz.forChild(R),Z.Bz]}),a})();var j=s(8468);let G=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[m.ez,V,j.I,n.u5,n.UX,u.Bb,f.lN,h.c,g.Nh]}),a})()},65415:(U,C,s)=>{s.d(C,{G:()=>n,T:()=>I});var m=s(94650),n=function(){function e(c,r,d){this.el=c,this.vcr=r,this.renderer=d,this.dtOptions={}}return e.prototype.ngOnInit=function(){var c=this;this.dtTrigger?this.dtTrigger.subscribe(function(r){c.displayTable(r)}):this.displayTable(null)},e.prototype.ngOnDestroy=function(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)},e.prototype.displayTable=function(c){var r=this;c&&(this.dtOptions=c),this.dtInstance=new Promise(function(d,u){Promise.resolve(r.dtOptions).then(function(l){0===Object.keys(l).length&&0===$("tbody tr",r.el.nativeElement).length?u("Both the table and dtOptions cannot be empty"):setTimeout(function(){var h={rowCallback:function(g,v,y){if(l.columns){var _=l.columns;r.applyNgPipeTransform(g,_),r.applyNgRefTemplate(g,_,v)}l.rowCallback&&l.rowCallback(g,v,y)}};h=Object.assign({},l,h),r.dt=$(r.el.nativeElement).DataTable(h),d(r.dt)})})})},e.prototype.applyNgPipeTransform=function(c,r){r.filter(function(u){return u.ngPipeInstance&&!u.ngTemplateRef}).forEach(function(u){var l=u.ngPipeInstance,f=u.ngPipeArgs||[],h=r.findIndex(function(_){return _.data===u.data}),g=c.childNodes.item(h),v=$(g).text(),y=l.transform.apply(l,function(e,c,r){if(r||2===arguments.length)for(var l,d=0,u=c.length;d<u;d++)(l||!(d in c))&&(l||(l=Array.prototype.slice.call(c,0,d)),l[d]=c[d]);return e.concat(l||Array.prototype.slice.call(c))}([v],f,!1));$(g).text(y)})},e.prototype.applyNgRefTemplate=function(c,r,d){var u=this;r.filter(function(f){return f.ngTemplateRef&&!f.ngPipeInstance}).forEach(function(f){var h=f.ngTemplateRef,g=h.ref,v=h.context,y=r.findIndex(function(F){return F.data===f.data}),_=c.childNodes.item(y);$(_).html("");var P=Object.assign({},v,v?.userData,{adtData:d}),w=u.vcr.createEmbeddedView(g,P);u.renderer.appendChild(_,w.rootNodes[0])})},e.\u0275fac=function(r){return new(r||e)(m.Y36(m.SBq),m.Y36(m.s_b),m.Y36(m.Qsj))},e.\u0275dir=m.lG2({type:e,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}}),e}(),T=s(36895),I=function(){function e(){}return e.forRoot=function(){return{ngModule:e}},e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[T.ez]}),e}()}}]);