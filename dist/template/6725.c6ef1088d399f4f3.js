"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[6725],{16725:(F,d,s)=>{s.r(d),s.d(d,{NotificationsModule:()=>w});var g=s(36895),p=s(4392),h=s(61135),C=s(77579),v=s(78372),N=s(63900),P=s(70262),u=s(39646),M=s(82722),t=s(94650),x=s(1954);function O(o,c){1&o&&t._UZ(0,"div",23)}function Z(o,c){if(1&o){const i=t.EpF();t.TgZ(0,"div",14)(1,"div",15),t.NdJ("click",function(){const e=t.CHM(i).$implicit,l=t.oxw();return t.KtG(l.notificationRead(null==e?null:e.id))}),t.TgZ(2,"div",16)(3,"div",17),t._UZ(4,"img",18),t.TgZ(5,"div")(6,"h5",19),t._uU(7),t.qZA(),t.TgZ(8,"p",20),t._uU(9),t.qZA(),t.TgZ(10,"p",21),t._uU(11),t.qZA()()(),t.YNc(12,O,1,0,"div",22),t.qZA()()()}if(2&o){const i=c.$implicit;t.xp6(1),t.Q6J("ngClass",null!=i&&i.is_view?"":"unread-card-wrapper"),t.xp6(6),t.Oqu(null==i?null:i.title),t.xp6(2),t.Oqu(null==i?null:i.body),t.xp6(2),t.hij("",null==i?null:i.minutesAgo," minutes Ago"),t.xp6(1),t.Q6J("ngIf",!(null!=i&&i.is_view))}}const y=function(o,c){return{"active-page":o,disabled:c}};function b(o,c){if(1&o){const i=t.EpF();t.TgZ(0,"li",24),t.NdJ("click",function(){const e=t.CHM(i).$implicit,l=t.oxw();return t.KtG("..."!==e&&l.pageChange(e))}),t.TgZ(1,"a",9),t._uU(2),t.qZA()()}if(2&o){const i=c.$implicit,n=t.oxw();t.Q6J("ngClass",t.WLB(2,y,i===n.page,"..."===i)),t.xp6(2),t.Oqu(i)}}const T=[{path:"",component:(()=>{class o{constructor(i){this.notificationService=i,this.totalNotificationCount=0,this.page=1,this.itemsPerPage=10,this.notificationIds=[],this.notificationIdsSubject=new h.X([]),this.destroy$=new C.x,this.notificationIdsSubject.pipe((0,v.b)(3e3),(0,N.w)(n=>{if(n.length>0){let a=new FormData;return a.append("notification_id",JSON.stringify(n)),this.notificationService.updateNotificationPanelByIds(a).pipe((0,P.K)(e=>(console.error("API call failed",e),this.notificationIds=[],(0,u.of)(null))))}return(0,u.of)(null)}),(0,M.R)(this.destroy$)).subscribe(n=>{n&&(console.log("API response",n),this.getNotificationList(this.page),this.notificationIds=[])})}ngOnInit(){this.getNotificationList(this.page)}calculateMinutesAgo(i){const n=new Date(i),e=(new Date).getTime()-n.getTime();return Math.floor(e/6e4)}getNotificationList(i){this.notificationService.getNotificationPanel(i).subscribe(n=>{this.itemsPerPage=n?.notifications?.length,this.totalNotificationCount=n?.notifications_count,console.log(n),this.notificationList=n.notifications.map(a=>({...a,minutesAgo:this.calculateMinutesAgo(a?.schedule_time)})),console.log(this.notificationList)})}notificationRead(i){this.notificationIds.includes(i)||(this.notificationIds.push(i),this.notificationIdsSubject.next(this.notificationIds))}pageChange(i){i!==this.page&&(this.page=i,this.getNotificationList(this.page))}getPageNumbers(){const i=this.totalNotificationCount,n=this.page;let e,l;if(i<=5)e=1,l=i;else{const f=Math.floor(2.5),m=Math.ceil(2.5)-1;n<=f?(e=1,l=5):n+m>=i?(e=i-5+1,l=i):(e=n-f,l=n+m)}const r=Array.from(Array(l+1-e).keys()).map(f=>e+f);return e>1&&(r.unshift("..."),r.unshift(1)),(l<i-1||l===i-1)&&r.push("..."),r}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return o.\u0275fac=function(i){return new(i||o)(t.Y36(x.g))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-notifications"]],decls:21,vars:9,consts:[[1,"container-fluid","my-4"],[1,"mb-4"],[1,"text-bold"],[1,"notification-description-wrapper"],[1,"row","m-0"],["class","col-12 p-0",4,"ngFor","ngForOf"],[1,"d-flex","w-100","justify-content-end","my-3"],[1,"pagination-list"],[3,"click"],["href","javascript:void(0)"],[1,"fa","fa-angle-double-left"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"fa","fa-angle-double-right"],[1,"entries","f-right"],[1,"col-12","p-0"],[1,"card","card-wrapper","mb-4",3,"ngClass","click"],[1,"card-body","d-flex","align-items-center","justify-content-between"],[1,"d-flex","align-items-center"],["src","../../../assets/logo/logo.png","alt","logo-img","width","50","height","50",1,"rounded-circle","mr-3"],[1,"card-title","mb-1"],[1,"card-text","mb-1"],[1,"card-text"],["class","unread-notification-wrapper me-3",4,"ngIf"],[1,"unread-notification-wrapper","me-3"],[3,"ngClass","click"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),t._uU(3,"All Notifications"),t.qZA(),t.TgZ(4,"p",3),t._uU(5,"View your all activities"),t.qZA()(),t.TgZ(6,"div",4),t.YNc(7,Z,13,5,"div",5),t.qZA(),t.TgZ(8,"div",6)(9,"ul",7)(10,"li",8),t.NdJ("click",function(){return n.page>1&&n.pageChange(n.page-1)}),t.TgZ(11,"a",9),t._UZ(12,"i",10),t._uU(13," Previous "),t.qZA()(),t.YNc(14,b,3,5,"li",11),t.TgZ(15,"li",8),t.NdJ("click",function(){return n.page<n.totalNotificationCount&&n.pageChange(n.page+1)}),t.TgZ(16,"a",9),t._uU(17," Next "),t._UZ(18,"i",12),t.qZA()()()(),t.TgZ(19,"div",13),t._uU(20),t.qZA()()),2&i&&(t.xp6(7),t.Q6J("ngForOf",n.notificationList),t.xp6(3),t.ekj("disabled",1===n.page),t.xp6(4),t.Q6J("ngForOf",n.getPageNumbers()),t.xp6(1),t.ekj("disabled",n.page===n.totalNotificationCount),t.xp6(5),t.lnq(" Showing ",(n.page-1)*n.itemsPerPage+1," to ",n.page*n.itemsPerPage," of ",n.totalNotificationCount," entries "))},dependencies:[g.mk,g.sg,g.O5],styles:[".card-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{flex-shrink:0;margin-right:1rem}.notification-description-wrapper[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.pagination-list[_ngcontent-%COMP%]{list-style-type:none;display:flex;justify-content:center;border:1px solid #ddd;border-radius:4px}.pagination-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-block;padding:5px 0}.pagination-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#000;padding:6px 12px}.pagination-list[_ngcontent-%COMP%]   li.disabled[_ngcontent-%COMP%]{pointer-events:none;color:#ccc}.pagination-list[_ngcontent-%COMP%]   li.active-page[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background-color:#ff9f43;font-weight:700;color:#fff;border-color:#ff9f43}.pagination-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:not(:last-child){border-right:1px solid #ddd}.pagination-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child{border-left:1px solid #ddd}.unread-notification-wrapper[_ngcontent-%COMP%]{height:14px;width:14px;background:#FF9F43;border-radius:50%}.unread-card-wrapper[_ngcontent-%COMP%]{background-color:#f3f3f3}"]}),o})()}];let A=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.Bz.forChild(T),p.Bz]}),o})();var _=s(54333);let w=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.ez,A,_.JX]}),o})()}}]);