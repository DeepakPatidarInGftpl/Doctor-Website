"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[2111],{92111:(A,C,p)=>{p.r(C),p.d(C,{BatchVariantProductModule:()=>Y});var _=p(36895),d=p(89299),n=p(24006),e=p(94650),y=p(80927),k=p(97185);function h(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter MRP "),e.qZA())}function F(i,l){if(1&i&&(e.TgZ(0,"span",25),e._uU(1),e.qZA()),2&i){const r=e.oxw();e.xp6(1),e.Oqu(r.errorMrp)}}function m(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter Cost Price"),e.qZA())}function Z(i,l){if(1&i&&(e.TgZ(0,"span",25),e._uU(1),e.qZA()),2&i){const r=e.oxw();e.xp6(1),e.Oqu(r.errorCost)}}function f(i,l){if(1&i&&(e.TgZ(0,"span",25),e._uU(1),e.qZA()),2&i){const r=e.oxw();e.xp6(1),e.Oqu(r.errorCostSell)}}function g(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter discount (ex:0-100)"),e.qZA())}function b(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter Enter discount (ex:0-100)"),e.qZA())}function v(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter Selling Price Online "),e.qZA())}function P(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter Selling Price Offline "),e.qZA())}function T(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter Selling Price Dealer "),e.qZA())}function V(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter Selling Price Employee "),e.qZA())}function I(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter Stock"),e.qZA())}function B(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter opening stock"),e.qZA())}function U(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter Minimum Stock Threshold"),e.qZA())}function M(i,l){1&i&&(e.TgZ(0,"span",25),e._uU(1,"Enter Max Order Quantity"),e.qZA())}function N(i,l){1&i&&(e.TgZ(0,"button",26),e._uU(1,"Submit"),e.qZA())}function J(i,l){1&i&&(e.TgZ(0,"button",27),e._UZ(1,"span",28),e._uU(2,"Submit"),e.qZA())}const u=function(i){return{"is-invalid":i}},q=function(i){return{border:i}},L=[{path:"",component:(()=>{class i{constructor(r,t,o,s,a,c){this.coreService=r,this.fb=t,this.toastr=o,this.router=s,this.Arout=a,this.location=c,this.p=1,this.pageSize=5,this.itemsPerPage=5,this.loader=!1}get f(){return this.batchForm.controls}ngOnInit(){this.batchForm=this.fb.group({mrp:new n.NI(0,[n.kI.required]),cost_price:new n.NI(0,n.kI.pattern(/^[0-9]*$/)),selling_price_online:new n.NI(0,[n.kI.pattern(/^[0-9]*$/)]),selling_price_offline:new n.NI(0,n.kI.pattern(/^[0-9]*$/)),selling_price_dealer:new n.NI(0,[n.kI.pattern(/^[0-9]*$/)]),selling_price_employee:new n.NI(0,n.kI.pattern(/^[0-9]*$/)),stock:new n.NI(0,[n.kI.required,n.kI.pattern(/^[0-9]*$/)]),opening_stock:new n.NI(0,[n.kI.required,n.kI.pattern(/^[0-9]*$/)]),minimum_stock_threshold:new n.NI(0,[n.kI.required,n.kI.pattern(/^[0-9]*$/)]),max_order_quantity:new n.NI(0,[n.kI.pattern(/^[0-9]*$/)]),discount:new n.NI(0,[n.kI.pattern(/^(100|[0-9]{1,2})$/)]),additional_discount:new n.NI(0,[n.kI.pattern(/^(100|[0-9]{1,2})$/)])}),this.id=+this.Arout.snapshot.paramMap.get("id")}getBrand(){this.coreService.getVariantBrandById(this.id).subscribe(r=>{if(console.log(r),this.brandList=r?.product?.brand,console.log(this.brandList),this.brandList?.markup_percentage_employee>0){let t=this.batchForm.value?.cost_price,s=t+t*this.brandList?.markup_percentage_employee/100;this.batchForm.get("selling_price_employee")?.patchValue(s),this.checkMrpSelling(),this.checkCostSelling()}if(this.brandList?.markup_percentage_online>0){let t=this.batchForm.value?.cost_price,s=t+t*this.brandList?.markup_percentage_online/100;this.batchForm.get("selling_price_online")?.patchValue(s),this.checkMrpSelling(),this.checkCostSelling()}if(this.brandList?.markup_percentage_customer>0){let t=this.batchForm.value?.cost_price,s=t+t*this.brandList?.markup_percentage_customer/100;this.batchForm.get("selling_price_offline")?.patchValue(s),this.checkMrpSelling(),this.checkCostSelling()}if(this.brandList?.markup_percentage_wholesale>0){let t=this.batchForm.value?.cost_price,s=t+t*this.brandList?.markup_percentage_wholesale/100;this.batchForm.get("selling_price_dealer")?.patchValue(s),this.checkMrpSelling(),this.checkCostSelling()}})}checkCost(){let r=this.batchForm.value?.mrp,t=this.batchForm.value?.cost_price;console.log(this.batchForm.value),t<r?(this.errorCost="",this.getBrand(),this.batchForm.get("selling_price_employee")?.patchValue(t),this.batchForm.get("selling_price_online")?.patchValue(t),this.batchForm.get("selling_price_offline")?.patchValue(t),this.batchForm.get("selling_price_dealer")?.patchValue(t)):this.errorCost="Cost Price Should Be Less Than MRP"}checkMrpSelling(){let r=this.batchForm.value?.selling_price_offline,t=this.batchForm.value?.selling_price_online,o=this.batchForm.value?.selling_price_dealer,s=this.batchForm.value?.selling_price_employee,a=this.batchForm.value?.mrp;console.log(this.batchForm.value),r<=a&&t<=a&&o<=a&&s<=a?(this.errorMrp="",console.log(r<=a&&t<=a&&o<=a&&s<=a)):this.errorMrp="Selling Price Should Be Less Than Equal To MRP"}checkCostSelling(){let r=this.batchForm.value?.selling_price_offline,t=this.batchForm.value?.selling_price_online,o=this.batchForm.value?.selling_price_dealer,s=this.batchForm.value?.selling_price_employee,c=this.batchForm.value?.cost_price;console.log(this.batchForm.value),r>c&&t>c&&o>c&&s>c?(this.errorCostSell="",console.log(r>c&&t>c&&o>c&&s>c)):this.errorCostSell="Selling Price Should Be Grater Than Cost Price"}submit(){if(console.log(this.batchForm.value),this.batchForm.valid){let r=this.batchForm.value?.selling_price_offline,t=this.batchForm.value?.selling_price_online,o=this.batchForm.value?.selling_price_dealer,s=this.batchForm.value?.selling_price_employee,a=this.batchForm.value?.mrp,c=this.batchForm.value?.cost_price;c<a?(this.errorCost="",r>c&&t>c&&o>c&&s>c&&r<=a&&t<=a&&o<=a&&s<=a?(this.errorMrp="",this.loader=!0,this.coreService.addBatch(this.batchForm.value,this.id).subscribe(S=>{this.addRes=S,"True"==this.addRes.sucess?(this.loader=!1,this.toastr.success(this.addRes.msg),this.batchForm.reset(),this.location.back()):this.loader=!1},S=>{this.loader=!1})):this.toastr.error("Selling Price Should Be Grater Than Cost Price And Less Than Equal To MRP")):this.errorCost="Cost Price Should Be Less Than MRP"}else this.batchForm.markAllAsTouched(),this.toastr.error("Please Fill All The Required Fields")}get mrp(){return this.batchForm.get("mrp")}get cost_price(){return this.batchForm.get("cost_price")}get selling_price_offline(){return this.batchForm.get("selling_price_offline")}get selling_price_online(){return this.batchForm.get("selling_price_online")}get selling_price_vendor(){return this.batchForm.get("selling_price_dealer")}get selling_price_employee(){return this.batchForm.get("selling_price_employee")}get stock(){return this.batchForm.get("stock")}get minimum_stock_threshold(){return this.batchForm.get("minimum_stock_threshold")}get max_order_quantity(){return this.batchForm.get("max_order_quantity")}get variant(){return this.batchForm.get("variant")}get opening_stock(){return this.batchForm.get("opening_stock")}get discount(){return this.batchForm.get("discount")}get additional_discount(){return this.batchForm.get("additional_discount")}get employee_incentive(){return this.batchForm.get("employee_incentive")}get employee_incentive_type(){return this.batchForm.get("employee_incentive_type")}}return i.\u0275fac=function(r){return new(r||i)(e.Y36(y.p),e.Y36(n.qu),e.Y36(k._W),e.Y36(d.F0),e.Y36(d.gz),e.Y36(_.Ye))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-batch-variant-product"]],decls:91,vars:67,consts:[[1,"page-header"],[1,"page-title"],[1,"card"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-3","col-sm-3","col-12"],[1,"form-group"],["type","number","formControlName","mrp","id","mrp","placeholder","0",3,"ngClass","ngStyle","blur"],["class","text-danger",4,"ngIf"],["type","number","formControlName","cost_price","id","cost_price","placeholder","0",3,"ngClass","ngStyle","blur"],["type","text","formControlName","discount","id","discount","placeholder","0",3,"ngClass"],["type","text","formControlName","additional_discount","id","additional_discount","placeholder","0",3,"ngClass"],["type","number","formControlName","selling_price_online","id","selling_price_online","placeholder","0",3,"ngModel","ngClass"],["type","number","formControlName","selling_price_offline","id","selling_price_offline","placeholder","0",3,"ngModel","ngClass"],["type","number","formControlName","selling_price_dealer","id","selling_price_dealer","placeholder","0",3,"ngClass"],["type","number","formControlName","selling_price_employee","id","selling_price_employee","placeholder","0",3,"ngModel","ngClass"],["type","text","formControlName","stock","id","stock","placeholder","0",3,"ngClass"],["type","text","formControlName","opening_stock","id","opening_stock","placeholder","0",3,"ngClass"],["type","text","formControlName","minimum_stock_threshold","id","minimum_stock_threshold","placeholder","0",3,"ngClass"],["type","text","formControlName","max_order_quantity","id","max_order_quantity","placeholder","0",3,"ngClass"],[1,"col-lg-12"],["class","btn btn-submit me-2",4,"ngIf"],["class","btn btn-submit me-2","type","submit","disabled","",4,"ngIf"],[1,"btn","btn-cancel",3,"routerLink"],[1,"text-danger"],[1,"btn","btn-submit","me-2"],["type","submit","disabled","",1,"btn","btn-submit","me-2"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4"),e._uU(3," Add Batch"),e.qZA(),e.TgZ(4,"h6"),e._uU(5,"Create new Batch "),e.qZA()()(),e.TgZ(6,"div",2)(7,"div",3)(8,"form",4),e.NdJ("ngSubmit",function(){return t.submit()}),e.TgZ(9,"div",5)(10,"div",6)(11,"div",7)(12,"label"),e._uU(13,"MRP*"),e.qZA(),e.TgZ(14,"input",8),e.NdJ("blur",function(){return t.checkCost()})("blur",function(){return t.checkMrpSelling()}),e.qZA(),e.YNc(15,h,2,0,"span",9),e.YNc(16,F,2,1,"span",9),e.qZA()(),e.TgZ(17,"div",6)(18,"div",7)(19,"label"),e._uU(20,"Cost Price"),e.qZA(),e.TgZ(21,"input",10),e.NdJ("blur",function(){return t.checkCost()})("blur",function(){return t.checkMrpSelling()})("blur",function(){return t.checkCostSelling()}),e.qZA(),e.YNc(22,m,2,0,"span",9),e.YNc(23,Z,2,1,"span",9),e._UZ(24,"br"),e.YNc(25,f,2,1,"span",9),e.qZA()(),e.TgZ(26,"div",6)(27,"div",7)(28,"label"),e._uU(29,"Discount %"),e.qZA(),e._UZ(30,"input",11),e.YNc(31,g,2,0,"span",9),e.qZA()(),e.TgZ(32,"div",6)(33,"div",7)(34,"label"),e._uU(35,"Additional Discount %"),e.qZA(),e._UZ(36,"input",12),e.YNc(37,b,2,0,"span",9),e.qZA()(),e.TgZ(38,"div",6)(39,"div",7)(40,"label"),e._uU(41,"Selling Price Online"),e.qZA(),e._UZ(42,"input",13),e.YNc(43,v,2,0,"span",9),e.qZA()(),e.TgZ(44,"div",6)(45,"div",7)(46,"label"),e._uU(47,"Selling Price Offline"),e.qZA(),e._UZ(48,"input",14),e.YNc(49,P,2,0,"span",9),e.qZA()(),e.TgZ(50,"div",6)(51,"div",7)(52,"label"),e._uU(53,"Selling Price Dealer"),e.qZA(),e._UZ(54,"input",15),e.YNc(55,T,2,0,"span",9),e.qZA()(),e.TgZ(56,"div",6)(57,"div",7)(58,"label"),e._uU(59,"Selling Price Employee"),e.qZA(),e._UZ(60,"input",16),e.YNc(61,V,2,0,"span",9),e.qZA()(),e.TgZ(62,"div",6)(63,"div",7)(64,"label"),e._uU(65,"Stock*"),e.qZA(),e._UZ(66,"input",17),e.YNc(67,I,2,0,"span",9),e.qZA()(),e.TgZ(68,"div",6)(69,"div",7)(70,"label"),e._uU(71,"Opening Stock*"),e.qZA(),e._UZ(72,"input",18),e.YNc(73,B,2,0,"span",9),e.qZA()(),e.TgZ(74,"div",6)(75,"div",7)(76,"label"),e._uU(77,"Minimum Stock Threshold*"),e.qZA(),e._UZ(78,"input",19),e.YNc(79,U,2,0,"span",9),e.qZA()(),e.TgZ(80,"div",6)(81,"div",7)(82,"label"),e._uU(83,"Max Order Quantity"),e.qZA(),e._UZ(84,"input",20),e.YNc(85,M,2,0,"span",9),e.qZA()(),e.TgZ(86,"div",21),e.YNc(87,N,2,0,"button",22),e.YNc(88,J,3,0,"button",23),e.TgZ(89,"a",24),e._uU(90,"Cancel"),e.qZA()()()()()()),2&r&&(e.xp6(8),e.Q6J("formGroup",t.batchForm),e.xp6(6),e.Q6J("ngClass",e.VKq(37,u,t.f.mrp.touched&&t.f.mrp.invalid))("ngStyle",e.VKq(39,q,t.errorMrp?"1px solid red":"")),e.xp6(1),e.Q6J("ngIf",t.mrp&&t.mrp.invalid&&t.mrp.touched),e.xp6(1),e.Q6J("ngIf",t.errorMrp),e.xp6(5),e.Q6J("ngClass",e.VKq(41,u,t.f.cost_price.touched&&t.f.cost_price.invalid))("ngStyle",e.VKq(43,q,t.errorCost?"1px solid red":""))("ngStyle",e.VKq(45,q,t.errorCostSell?"1px solid red":"")),e.xp6(1),e.Q6J("ngIf",t.cost_price&&t.cost_price.invalid&&t.cost_price.touched),e.xp6(1),e.Q6J("ngIf",t.errorCost),e.xp6(2),e.Q6J("ngIf",t.errorCostSell),e.xp6(5),e.Q6J("ngClass",e.VKq(47,u,t.f.discount.touched&&t.f.discount.invalid)),e.xp6(1),e.Q6J("ngIf",t.discount&&t.discount.invalid&&t.discount.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(49,u,t.f.additional_discount.touched&&t.f.additional_discount.invalid)),e.xp6(1),e.Q6J("ngIf",t.additional_discount&&t.additional_discount.invalid&&t.additional_discount.touched),e.xp6(5),e.Q6J("ngModel",t.mrpN)("ngClass",e.VKq(51,u,t.f.selling_price_online.touched&&t.f.selling_price_online.invalid)),e.xp6(1),e.Q6J("ngIf",t.selling_price_online&&t.selling_price_online.invalid&&t.selling_price_online.touched),e.xp6(5),e.Q6J("ngModel",t.mrpN)("ngClass",e.VKq(53,u,t.f.selling_price_offline.touched&&t.f.selling_price_offline.invalid)),e.xp6(1),e.Q6J("ngIf",t.selling_price_offline&&t.selling_price_offline.invalid&&t.selling_price_offline.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(55,u,t.f.selling_price_dealer.touched&&t.f.selling_price_dealer.invalid)),e.xp6(1),e.Q6J("ngIf",t.selling_price_vendor&&t.selling_price_vendor.invalid&&t.selling_price_vendor.touched),e.xp6(5),e.Q6J("ngModel",t.mrpN)("ngClass",e.VKq(57,u,t.f.selling_price_employee.touched&&t.f.selling_price_employee.invalid)),e.xp6(1),e.Q6J("ngIf",t.selling_price_employee&&t.selling_price_employee.invalid&&t.selling_price_employee.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(59,u,t.f.stock.touched&&t.f.stock.invalid)),e.xp6(1),e.Q6J("ngIf",t.stock&&t.stock.invalid&&t.stock.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(61,u,t.f.opening_stock.touched&&t.f.opening_stock.invalid)),e.xp6(1),e.Q6J("ngIf",t.opening_stock&&t.opening_stock.invalid&&t.opening_stock.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(63,u,t.f.minimum_stock_threshold.touched&&t.f.minimum_stock_threshold.invalid)),e.xp6(1),e.Q6J("ngIf",t.minimum_stock_threshold&&t.minimum_stock_threshold.invalid&&t.minimum_stock_threshold.touched),e.xp6(5),e.Q6J("ngClass",e.VKq(65,u,t.f.max_order_quantity.touched&&t.f.max_order_quantity.invalid)),e.xp6(1),e.Q6J("ngIf",t.max_order_quantity&&t.max_order_quantity.invalid&&t.max_order_quantity.touched),e.xp6(2),e.Q6J("ngIf",!t.loader),e.xp6(1),e.Q6J("ngIf",t.loader),e.xp6(1),e.MGl("routerLink","//product/",t.id,""))},dependencies:[_.mk,_.O5,_.PC,d.yS,n._Y,n.Fj,n.wV,n.JJ,n.JL,n.sg,n.u],styles:["select[_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], input[type=button][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{border:1px solid rgba(145,158,171,.32);height:40px;width:100%;font-size:14px;font-weight:500;color:#637381;padding:10px 15px;border-radius:5px}"]}),i})(),canActivate:[p(30597).l],data:{allowedRoles:["add_batch"]}}];let O=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[d.Bz.forChild(L),d.Bz]}),i})(),Y=(()=>{class i{}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[_.ez,O,n.u5,n.UX]}),i})()},30597:(A,C,p)=>{p.d(C,{l:()=>k});var _=p(94650),d=p(89299),n=p(97185),e=p(42917),y=p(80927);let k=(()=>{class h{constructor(m,Z,f,g,b){this.router=m,this.Arout=Z,this.toastr=f,this.profileService=g,this.coreService=b}canActivate(m,Z){const f=JSON.parse(localStorage.getItem("auth"));if(this.profileService.userDetails$.subscribe(g=>{this.userDetails=g,this.permissions=this.userDetails?.permission}),f){const g=m.data.allowedRoles;console.log(g,"allowedRoles");const b=f.some(v=>g.includes(v.codename));if(console.log(b),this.coreService.getProfile().subscribe(v=>{this.userDetails=v,this.profileService.setUserDetails(this.userDetails);const P=v?.permission,T=this.profileService.getUserDetails();(!T||T.length!==P.length)&&(this.profileService.setUserPermission(P),window.location.reload())}),b)return!0}return this.toastr.error("User have Not Permission to Access This page"),this.router.navigate(["/dashboard"]),!1}}return h.\u0275fac=function(m){return new(m||h)(_.LFG(d.F0),_.LFG(d.gz),_.LFG(n._W),_.LFG(e.J),_.LFG(y.p))},h.\u0275prov=_.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()}}]);