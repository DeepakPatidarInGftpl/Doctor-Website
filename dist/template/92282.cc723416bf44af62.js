"use strict";(self.webpackChunktemplate=self.webpackChunktemplate||[]).push([[92282],{92282:(O,g,s)=>{s.r(g),s.d(g,{SigninModule:()=>Q});var l=s(36895),c=s(4392),r=s(24006),m=s(92340),e=s(94650),f=s(83631),h=s(77243),v=s(80927),u=s(97185),S=s(43672),C=s(23182);function b(o,t){if(1&o&&e._UZ(0,"img",25),2&o){const n=e.oxw();e.Q6J("src",n.liveUrl+n.logoData.data.logo,e.LSH)}}function w(o,t){1&o&&(e.TgZ(0,"span",26),e._uU(1,"Enter your username "),e.qZA())}function y(o,t){if(1&o&&(e.TgZ(0,"div",27),e._uU(1),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.hij(" ",n.CustomControler.message," ")}}function _(o,t){1&o&&(e.TgZ(0,"div"),e._uU(1," username is required. "),e.qZA())}function T(o,t){1&o&&(e.TgZ(0,"div"),e._uU(1," Please, enter valid username address. "),e.qZA())}function Z(o,t){if(1&o&&(e.TgZ(0,"div",27),e.YNc(1,_,2,0,"div",28),e.YNc(2,T,2,0,"div",28),e.qZA()),2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.f.username.errors&&n.f.username.errors.required),e.xp6(1),e.Q6J("ngIf",n.f.username.errors&&n.f.username.errors.username)}}function I(o,t){1&o&&(e.TgZ(0,"span",26),e._uU(1,"Enter your password "),e.qZA())}function k(o,t){if(1&o){const n=e.EpF();e.TgZ(0,"span",29),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.onClick())}),e.qZA()}}function J(o,t){if(1&o){const n=e.EpF();e.TgZ(0,"span",30),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.onClick())}),e.qZA()}}const N=function(o){return{color:o}};function x(o,t){if(1&o&&(e.TgZ(0,"div",31)(1,"div",32)(2,"span",33),e._uU(3,"Loading..."),e.qZA()()()),2&o){const n=e.oxw();e.xp6(1),e.Q6J("ngStyle",e.VKq(1,N,n.buttonColor))}}const A=function(o){return{"blur-background-wrapper":o}},d=function(o){return{"is-invalid":o}},U=function(){return{"hover-button":!0}},Y=function(o,t){return{"background-color":o,"border-color":t}},L=[{path:"",component:(()=>{class o{constructor(n,i,a,q,D,P,F,E){this.storage=n,this.renderer=i,this.authService=a,this.coreService=q,this.toastr=D,this.router=P,this.afMessaging=F,this.messagingService=E,this.show=!1,this.notificationLoading=!1,this.isSyncLoading=!1,this.buttonColor="#FF9F43",this.buttonHoverColor="#1B2850",this.img_url="assets/img/LoginImage.webp",this.liveUrl=m.N.api,this.loginStatus="",this.loaders=!1,this.subscription=this.storage.Loginvalue.subscribe(p=>{0!=p&&(this.CustomControler=p)})}get f(){return this.form.controls}ngOnInit(){this.form=new r.cw({username:new r.NI("",[r.kI.required]),password:new r.NI("",[r.kI.required])}),this.storage.Checkuser(),this.password="password",localStorage.getItem("token")&&this.router.navigate(["/dashboard"]),this.messagingService.receiveMessage(),this.messagingService.currentMessage.subscribe(n=>{n&&this.showNotification(n)})}ngAfterViewInit(){this.PageLoadData()}requestPermission(){this.messagingService.requestPermission().then(n=>{n?(this.deviceToken=n,this.updateUserDeviceToken(),console.log(n)):alert("You have not given notification access, so you will not be notified."),this.isSyncLoading=!1,this.authService.getSubscriptions().subscribe({next:i=>{console.log(i),0==i.IsActive?(localStorage.setItem("sp",i.IsActive),this.router.navigate(["/auth/subscription"],{replaceUrl:!0})):window.location.reload()}})}).catch(n=>{console.error("Error retrieving token:",n),alert("You have not given notification access, so you will not be notified."),window.location.reload(),this.isSyncLoading=!1})}PageLoadData(){this.authService.getLogoApi().subscribe({next:n=>{if(!n.success)throw Error("No Data Found");this.logoData=n,this.buttonColor=n.data.primary_colour,this.buttonHoverColor=n.data.secondary_colour,this.img_url=this.liveUrl+this.logoData.data.auth_image,this.applyDynamicStyles()},error(n){throw Error("No Data Found "+n)}})}applyDynamicStyles(){this.renderer.setStyle(document.documentElement,"$button-color",this.buttonColor,1),this.renderer.setStyle(document.documentElement,"$button-hover-color",this.buttonHoverColor,1)}showNotification(n){"granted"===Notification.permission?new Notification(n.notification?.title||"No title",{body:n.notification?.body||"No body",icon:n.notification?.icon||"assets/logo/logo.png"}):console.error("Notification permission not granted")}updateUserDeviceToken(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/firebase-messaging-sw.js").then(n=>{console.log("Service Worker registered with scope:",n.scope),this.deviceToken&&this.authService.updateUserDeviceToken({device_token:this.deviceToken}).subscribe(a=>{console.log(a)},a=>{console.error("Error updating device token:",a)})}).catch(n=>{console.error("Service Worker registration failed:",n)})}submit(){this.form.valid?(this.loaders=!0,this.authService.login(this.form.value).subscribe(n=>{this.loginRes=n,this.loginRes.token?(this.loaders=!1,this.toastr.success("Login Successfull"),this.isSyncLoading=!0,localStorage.setItem("token",this.loginRes?.token),localStorage.setItem("auth",JSON.stringify(this.loginRes?.permission)),this.coreService.getFinancialYearHeader().subscribe(i=>{console.warn(i),localStorage.setItem("financialYear",JSON.stringify(i?.id)),this.requestPermission()},i=>{this.isSyncLoading=!1})):this.loaders=!1},n=>{this.loaders=!1,0==n.error.User?this.toastr.error(n.error.msg):n.error.status&&this.toastr.error(n.error.status)})):(this.loaders=!1,this.form.markAllAsTouched(),console.log("invalid form"))}ngOnDestroy(){this.subscription.unsubscribe()}get username(){return this.form.get("username")}get passwords(){return this.form.get("password")}onClick(){"password"===this.password?(this.password="text",this.show=!0):(this.password="password",this.show=!1)}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(f.T),e.Y36(e.Qsj),e.Y36(h.u),e.Y36(v.p),e.Y36(u._W),e.Y36(c.F0),e.Y36(S.BG),e.Y36(C.M))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-signin"]],decls:37,vars:26,consts:[[1,"main-wrapper",3,"ngClass"],[1,"account-content"],[1,"login-wrapper"],[1,"login-content","w-50"],[1,"login-userset"],[1,"login-logo","logo-normal"],["alt","img",3,"src",4,"ngIf"],["routerLink","//dashboard",1,"login-logo","logo-white"],[1,"login-userheading"],[3,"formGroup","ngSubmit"],[1,"form-login"],[1,"form-addons"],["type","text","placeholder","Enter your username","formControlName","username","id","username",3,"ngClass"],["src","assets/img/icons/mail.svg","alt","img"],["class","text-danger",4,"ngIf"],["class","invalid-feedback",4,"ngIf"],[1,"pass-group"],["placeholder","Enter your password","formControlName","password","id","password",1,"pass-input",3,"type","ngClass"],["class","fas toggle-password fa-eye",3,"click",4,"ngIf"],["class","fas toggle-password fa-eye-slash",3,"click",4,"ngIf"],[1,"form-login",3,"ngClass"],["type","submit",1,"btn","btn-login","me-2",3,"ngStyle"],["id","addimg",1,"login-img","w-50"],["alt","bg-img",3,"src"],["class","spinner-container",4,"ngIf"],["alt","img",3,"src"],[1,"text-danger"],[1,"invalid-feedback"],[4,"ngIf"],[1,"fas","toggle-password","fa-eye",3,"click"],[1,"fas","toggle-password","fa-eye-slash",3,"click"],[1,"spinner-container"],["role","status",1,"spinner-border",3,"ngStyle"],[1,"sr-only"]],template:function(n,i){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e.YNc(6,b,1,1,"img",6),e.qZA(),e._UZ(7,"a",7),e.TgZ(8,"div",8)(9,"h3"),e._uU(10,"Login "),e.qZA(),e.TgZ(11,"h4"),e._uU(12,"Please login to your account"),e.qZA()(),e.TgZ(13,"form",9),e.NdJ("ngSubmit",function(){return i.submit()}),e.TgZ(14,"div",10)(15,"label"),e._uU(16,"Username"),e.qZA(),e.TgZ(17,"div",11),e._UZ(18,"input",12)(19,"img",13),e.qZA(),e.YNc(20,w,2,0,"span",14),e.YNc(21,y,2,1,"div",15),e.YNc(22,Z,3,2,"div",15),e.qZA(),e.TgZ(23,"div",10)(24,"label"),e._uU(25,"Password"),e.qZA(),e.TgZ(26,"div",16),e._UZ(27,"input",17),e.YNc(28,I,2,0,"span",14),e.YNc(29,k,1,0,"span",18),e.YNc(30,J,1,0,"span",19),e.qZA()(),e.TgZ(31,"div",20)(32,"button",21),e._uU(33,"Sign In"),e.qZA()()()()(),e.TgZ(34,"div",22),e._UZ(35,"img",23),e.qZA()()()(),e.YNc(36,x,4,3,"div",24)),2&n&&(e.Q6J("ngClass",e.VKq(16,A,i.isSyncLoading)),e.xp6(6),e.Q6J("ngIf",i.logoData),e.xp6(7),e.Q6J("formGroup",i.form),e.xp6(5),e.Q6J("ngClass",e.VKq(18,d,i.f.username.touched&&i.f.username.invalid)),e.xp6(2),e.Q6J("ngIf",i.username&&i.username.invalid&&i.username.touched),e.xp6(1),e.Q6J("ngIf","username"===(null==i.CustomControler?null:i.CustomControler.status)),e.xp6(1),e.Q6J("ngIf",i.f.username.touched&&i.f.username.invalid),e.xp6(5),e.Q6J("type",i.password)("ngClass",e.VKq(20,d,i.f.password.touched&&i.f.password.invalid)),e.xp6(1),e.Q6J("ngIf",i.passwords&&i.passwords.invalid&&i.passwords.touched),e.xp6(1),e.Q6J("ngIf",i.show),e.xp6(1),e.Q6J("ngIf",!i.show),e.xp6(1),e.Q6J("ngClass",e.DdM(22,U)),e.xp6(1),e.Q6J("ngStyle",e.WLB(23,Y,i.buttonColor,i.buttonColor)),e.xp6(3),e.Q6J("src",i.img_url,e.LSH),e.xp6(1),e.Q6J("ngIf",i.isSyncLoading))},dependencies:[l.mk,l.O5,l.PC,c.yS,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u],styles:['@charset "UTF-8";.ng-dirty.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%], .ng-pristine.ng-invalid.is-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}.spinner-container[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:40px}.spinner-border[_ngcontent-%COMP%]{width:150px;height:150px;color:var(--primary-color)}.blur-background-wrapper[_ngcontent-%COMP%]{filter:blur(3px)}.hover-button[_ngcontent-%COMP%]:hover{color:var(--primary-color)!important}']}),o})()}];let M=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[c.Bz.forChild(L),c.Bz]}),o})(),Q=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[l.ez,M,r.UX,u.Rh.forRoot()]}),o})()}}]);