<div class="page-header">
    <div class="page-title">
        <h4>Add Credit Note</h4>
        <h6>Create new Credit Note </h6>
    </div>
</div>
<!-- /add -->
<div class="card">
    <div class="card-body">
        <form [formGroup]="debitNoteForm" (ngSubmit)="submit()">
            <div class="row">
                <div class="col-lg-4 col-md-6 col-12">
                    <div class="form-group">
                        <label>Customor Name*</label>
                        <!-- <select formControlName="account"  required id="account" [ngClass]="{'is-invalid': f['account'].touched && f['account'].invalid}">
                            <option value="" selected disabled>Select Account</option>
                            <option value="{{account?.id}}" *ngFor="let account of accountList"> {{account?.accounts_type}}</option>
                        </select> -->

                        <mat-form-field class="w-100" style="padding: 0;width: 100%;min-width: 100%;border-top: none;">
                            <input type="text" placeholder="Enter A Customor Name" aria-label="from_account" matInput
                                [formControl]="fromAccountControl" [matAutocomplete]="auto"
                                style="box-sizing: border-box;">
                            <mat-autocomplete #auto="matAutocomplete">
                                <ng-container *ngFor="let account of filteredFromAccount | async">
                                    <mat-option *ngIf="account.is_active==true" [value]="(account?.account_id &&
                                    account?.company_name) ?
                                    (account?.company_name + ' (' +
                                    account?.account_id + ')') : account?.account_id"
                                        (onSelectionChange)="oncheck(account)" style="color:#FF9F43">{{
                                        (account?.account_id &&
                                        account?.company_name) ?
                                        (account?.company_name + ' (' +
                                        account?.account_id + ')') : account?.account_id
                                        }}</mat-option>
                                </ng-container>
                                <ng-container *ngIf="(filteredFromAccount | async) as accounts">
                                    <mat-option *ngIf="accounts.length === 0" [value]="'No data found'">
                                        <a routerLink="//account/accountlist" style="color:#FF9F43">+ Add Account</a>
                                    </mat-option>
                                    <mat-option *ngIf="fromAccountControl.value?.length < 3" class="is-loading">Please
                                        Enter 1 or more characters</mat-option>
                                </ng-container>
                            </mat-autocomplete>
                        </mat-form-field>
                        <span class="text-danger" *ngIf="account && account.invalid && account.touched">Select Account
                        </span>
                    </div>
                </div>

                <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Credit Note Date*</label>
                        <input type="date" formControlName="date" id="date" [attr.min]="minDate" [attr.max]="maxDate"
                            [ngClass]="{'is-invalid': f['date'].touched && f['date'].invalid}">
                        <span class="text-danger" *ngIf="date && date.invalid && date.touched">Select Date </span>
                    </div>
                </div>

                <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Credit Note No</label>
                        <!-- <input type="text" formControlName="credit_note_no" placeholder="Enter Credit Note No." id="credit_note_no" [ngModel]="prefixNo"[ngClass]="{ 'is-invalid': f['credit_note_no'].touched && f['credit_note_no'].invalid}"> -->
                        <select formControlName="credit_note_no">
                            <option value="" selected disabled>Select Credit Note No</option>
                            <option value="{{prefix.id}}" *ngFor="let prefix of prefixNo">{{prefix.prefix}}</option>
                        </select>
                        <span class="text-danger"
                            *ngIf="credit_note_no && credit_note_no.invalid && credit_note_no.touched">Enter Credit Note
                            No</span>
                    </div>
                </div>

                <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Select Sale Bill*</label>
                        <select formControlName="sale_bill_no" id="sale_bill_no"
                            [ngClass]="{'is-invalid': f['sale_bill_no'].touched && f['sale_bill_no'].invalid}">
                            <option value="" selected disabled>Select Sale Bill</option>
                            <option value="{{item?.id}}" *ngFor="let item of saleBillList">
                                {{item?.id}}</option>
                            <option *ngIf="!saleBillList?.length" value="" disabled>Select Sale Bill</option>
                        </select>

                        <!-- <mat-form-field class="w-100"
                            style="padding: 0; width: 100%; min-width: 100%; border-top: none;">
                            <input type="text" placeholder="Search Sale Bill" aria-label="Search sale Bills" matInput
                                [formControl]="billControl" (input)="getFilterBill($event.target.value)"
                                [matAutocomplete]="autos" style="box-sizing: border-box;" />
                            <mat-autocomplete #autos="matAutocomplete">
                                <ng-container *ngFor="let option of FiltersaleBillList">
                                    <mat-option *ngIf="option?.is_active==true" [value]="option?.id"
                                        (onSelectionChange)="oncheck2(option)" style="color:#FF9F43">
                                        {{ option?.id}}
                                    </mat-option>
                                </ng-container>
                                <mat-option *ngIf="FiltersaleBillList?.length === 0" [value]="'No data found'">
                                    <a routerLink="///sales/addsalesbill" style="color:#FF9F43">+ Add sale Bill</a>
                                </mat-option>
                                <mat-option *ngIf="billControl?.value?.length < 1" class="is-loading"> Please Enter 1 or
                                    more characters </mat-option>
                            </mat-autocomplete>
                        </mat-form-field> -->
                        <span class="text-danger"
                            *ngIf="sale_bill_no && sale_bill_no.invalid && sale_bill_no.touched">Select Sale Bill No.
                        </span>
                    </div>
                </div>

                <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Amount</label>
                        <input type="number" formControlName="amount" placeholder="Enter Amount"
                            [ngClass]="{ 'is-invalid': f['amount'].touched && f['amount'].invalid}">
                        <span class="text-danger" *ngIf="Amount && Amount.invalid && Amount.touched">Enter Amount</span>
                    </div>
                </div>
                <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Round Off</label>
                        <input type="number" formControlName="roundoff" placeholder="Enter Round off"
                            [ngClass]="{ 'is-invalid': f['roundoff'].touched && f['roundoff'].invalid}">
                        <span class="text-danger" *ngIf="roundoff && roundoff.invalid && roundoff.touched">Enter Round
                            Off</span>
                    </div>
                </div>

                <!-- <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Tax %</label>
                        <input type="number" formControlName="tax" placeholder="Enter Tax"
                            [ngClass]="{ 'is-invalid': f['tax'].touched && f['tax'].invalid}">
                        <span class="text-danger" *ngIf="tax && tax.invalid && tax.touched">Enter Tax ex: (1-100)</span>
                    </div>
                </div> -->

                <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Tax Percentage</label>
                        <select formControlName="tax" (change)="onChangePercentage($event)">
                            <option value="" selected disabled>Select Tax Percentage
                            </option>
                            <option *ngFor="let prefix of taxSlabList;" [value]="prefix?.slab_title">
                                {{prefix?.slab_title}}
                            </option>
                        </select>
                        <span class="text-danger" *ngIf="tax && tax.invalid && tax.touched">Select Tax
                            Percentage</span>
                    </div>
                </div>

                <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Total</label>
                        <input type="number" formControlName="total" placeholder="Enter Total" id="total"
                            [ngClass]="{ 'is-invalid': f['total'].touched && f['total'].invalid}">
                        <span class="text-danger" *ngIf="total && total.invalid && total.touched">Enter Total</span>
                    </div>
                </div>

                <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Reason</label>
                        <input type="text" formControlName="reason" placeholder="Enter Reason"
                            [ngClass]="{ 'is-invalid': f['reason'].touched && f['reason'].invalid}">
                        <span class="text-danger" *ngIf="reason && reason.invalid && reason.touched">Enter Reason</span>
                    </div>
                </div>

                <div class="col-lg-4 col-sm-4 col-12">
                    <div class="form-group">
                        <label>Note</label>
                        <textarea formControlName="note" placeholder="Enter Note"
                            [ngClass]="{ 'is-invalid': f['note'].touched && f['note'].invalid}"></textarea>
                        <span class="text-danger" *ngIf="note && note.invalid && note.touched">Enter Note</span>
                    </div>
                </div>

                <div class="col-lg-12">
                    <button class="btn btn-submit me-2" *ngIf="!loaders">Submit</button>
                    <button class="btn btn-submit me-2" type="submit" *ngIf="loaders" disabled>
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;
                        Submit</button>
                    <a routerLink="//transaction/creditnoteList" class="btn btn-cancel text-white">Cancel</a>
                </div>
            </div>
        </form>
    </div>
</div>
<!-- /add -->