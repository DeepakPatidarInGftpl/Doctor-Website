<div class="page-header">
    <div class="page-title">
        <h4> Add Employee</h4>
        <h6>Create new Employee </h6>
    </div>
</div>

<!-- /add -->
<div class="card">
    <div class="card-body">
        <form [formGroup]="employeeForm" (ngSubmit)="submit()">
            <div class="row">
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label> Name*</label>
                        <input type="text" formControlName="name" placeholder="Enter Name" id="name" [ngClass]="{'is-invalid': f['name'].touched && f['name'].invalid}">
                        <span class="text-danger" *ngIf="name && name.invalid && name.touched">Enter your name </span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Mobile No*</label>
                        <input type="text" formControlName="mobile_no" placeholder="Enter Mobile No." maxlength="10" minlength="10" id="mobile_no"
                            [ngClass]="{'is-invalid': f['mobile_no'].touched && f['mobile_no'].invalid}" [ngStyle]="{'border': mobileError ? '1px solid red' : ''}">
                        <span class="text-danger" *ngIf="mobile && mobile.invalid && mobile.touched">Enter your 10
                            Digits Mobile Number</span>
                            <span class="text-danger" *ngIf="mobileError">{{mobileError}}</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Whatsapp No.</label>
                        <input type="text" formControlName="whatsapp_no" placeholder="Enter Whatsapp No." maxlength="10" minlength="10" id="whatsapp_no"
                            [ngClass]="{'is-invalid': f['whatsapp_no'].touched && f['whatsapp_no'].invalid}">
                        <span class="text-danger" *ngIf="whatsapp_no && whatsapp_no.invalid && whatsapp_no.touched">Enter your 10 Digits Whatsapp Number</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" formControlName="email" id="email" placeholder="Enter Email" [ngClass]="{'is-invalid': f['email'].touched && f['email'].invalid}">
                        <span class="text-danger" *ngIf="email && email.invalid && email.touched">Enter Valid Email</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Remark</label>
                        <input type="text" formControlName="remark" placeholder="Enter Remark" id="remark" [ngClass]="{'is-invalid': f['remark'].touched && f['remark'].invalid}">
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Date of Birth</label>
                        <input type="date" formControlName="dob" placeholder="Select Date Of Birth" id="dob" [ngClass]="{'is-invalid': f['dob'].touched && f['dob'].invalid}">
                        <span class="text-danger" *ngIf="dateError">{{dateError}}</span>
                        <span class="text-danger" *ngIf="dob && dob.invalid && dob.touched">Date (format:dd/mm/yyyy)</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Anniversary</label>
                        <input type="date" formControlName="anniversary" placeholder="Select Anniversary" id="anniversary" [ngClass]="{'is-invalid': f['anniversary'].touched && f['anniversary'].invalid}">
                        <span class="text-danger" *ngIf="dateError">{{dateError}}</span>
                        <span class="text-danger" *ngIf="anniversary && anniversary.invalid && anniversary.touched">Date (format:dd/mm/yyyy)</span>
                    </div>
                </div>

                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Pan Number</label>
                        <input type="text" formControlName="pan_no" placeholder="Enter Pan No." id="pan_no" [ngClass]="{'is-invalid': f['pan_no'].touched && f['pan_no'].invalid}">
                        <span class="text-danger" *ngIf="pan_no && pan_no.invalid && pan_no.touched">Enter your Pan Number</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Credit Limit</label>
                        <input type="text" formControlName="credit_limit" placeholder="Credit Limit" id="credit_limit" [ngClass]="{'is-invalid': f['credit_limit'].touched && f['credit_limit'].invalid}">
                    </div>
                </div>

                <div formArrayName="address">
                    <div *ngFor="let d of getAddresss().controls; let i=index" style="border: 1px solid rgba(145, 158, 171, 0.32); margin-top: 10px;">
                        <div [formGroupName]="i" class="row m-2">
                            <div class="col-lg-3 col-sm-3">
                                <div class="form-group">
                                    <label>Address Line 1</label>
                                    <input type="text" formControlName="address_line_1" placeholder="Enter Address Line 1">
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Address Line 2</label>
                                    <input type="text" formControlName="address_line_2" placeholder="Enter Address Line 2">
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Select Country*</label>
                                    <select formControlName="country"  #countryValue
                                        (change)="selectState(countryValue.value,i)" id="country">
                                        <option value="" selected disabled>Select Country</option>
                                        <option value="{{country.id}}" *ngFor="let country of country">
                                            {{country.country_name}}
                                        </option>
                                    </select>
                                    <span class="text-danger" *ngIf="countryy(i).invalid && countryy(i).touched">Select
                                        Country</span>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Select State*</label>
                                    <select formControlName="state"  #stateValue
                                        (change)="selectCity(stateValue.value,i)">
                                        <option value="" selected disabled>Select State</option>
                                        <option value="{{state.id}}" *ngFor="let state of state[i]">{{state.state}}
                                        </option>
                                    </select>
                                    <span class="text-danger"
                                        *ngIf="statee(i).invalid && statee(i).touched && state[i]?.length>0">Select
                                        State</span>
                                    <span class="text-danger"
                                        *ngIf="statee(i).invalid && statee(i).touched && state[i]?.length<=0">Please Select Country</span>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Select City*</label>
                                    <select formControlName="city"  id="city">
                                        <option value="" selected disabled>Select City</option>
                                        <option value="{{city.id}}" *ngFor="let city of city[i]">{{city.city}}</option>
                                    </select>
                                    <span class="text-danger"
                                        *ngIf="cityy(i).invalid && cityy(i).touched && city[i]?.length>0">Select
                                        City</span>
                                    <span class="text-danger" *ngIf="cityy(i).invalid && cityy(i).touched && city[i]?.length<=0">Please Select State</span>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Pincode</label>
                                    <input type="text" formControlName="pincode" placeholder="Enter Pincode" maxlength="6" minlength="6" id="pincode">
                                    <span class="text-danger" *ngIf="pincode(i).invalid && pincode(i).touched">Enter your 6 digits pincode number</span>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Select Address Type</label>
                                    <select formControlName="address_type" class="inp">
                                        <option value="" selected disabled>Select Address Type</option>
                                        <option value="Shipping">Shipping</option>
                                        <option value="Billing">Billing</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12 d-flex align-items-center">
                                <span (click)="removeAddress(i)" class="btn" style="color: red;" *ngIf="i>0"><svg
                                        style="width:20px; height:20px" xmlns="http://www.w3.org/2000/svg" width="16"
                                        height="16" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">
                                        <path
                                            d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                        <path
                                            d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
                                    </svg></span>
                            </div>
                        </div>
                    </div>
                    <div class="w-100 text-right my-3">
                        <span (click)="addAddress()" class="addMore" style="background: #FF9F43; color: white; border-radius: 2px;">+ Add More Address</span>
                    </div>
                </div>

                <div formArrayName="bank_id">
                    <div *ngFor="let d of getBanks().controls; let i=index" style="border: 1px solid rgba(145, 158, 171, 0.32); margin-top: 10px;">
                        <div [formGroupName]="i" class="row m-2">
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Bank Holder Name*</label>
                                    <input type="text" formControlName="account_holder_name" placeholder="Enter Bank Holder Name">
                                    <span class="text-danger"
                                        *ngIf="getBankHolderName(i)?.invalid && getBankHolderName(i)?.touched">Enter
                                        Bank Holder name</span>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Bank Name*</label>
                                    <input type="text" formControlName="bank_name" placeholder="Enter Bank Name">
                                    <span class="text-danger"
                                        *ngIf="getBankName(i)?.invalid && getBankName(i)?.touched">Enter your Bank
                                        Name</span>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Branch</label>
                                    <input type="text" formControlName="branch_name" placeholder="Enter Branch Name">
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12">
                                <div class="form-group">
                                    <label>Account No.*</label>
                                    <input type="text" formControlName="account_no" placeholder="Enter Account No.">
                                    <span class="text-danger"
                                        *ngIf="getAccountNo(i)?.invalid && getAccountNo(i)?.touched">Enter valid Account
                                        No.</span>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3">
                                <div class="form-group">
                                    <label>IFSC Code*</label>
                                    <input type="text" formControlName="bank_ifsc_code" placeholder="Enter IFSC Code">
                                    <span class="text-danger"
                                        *ngIf="getIfscCode(i)?.invalid && getIfscCode(i)?.touched">Enter your IFSC
                                        Code</span>
                                </div>
                            </div>
                            <div class="col-lg-3 col-sm-3 col-12 d-flex align-items-center">
                                <span (click)="removeBank(i)" class="btn" style="color: red;" *ngIf="i>0"><svg
                                        style="width:20px; height:20px" xmlns="http://www.w3.org/2000/svg" width="16"
                                        height="16" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">
                                        <path
                                            d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                        <path
                                            d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
                                    </svg></span>
                            </div>
                        </div>
                    </div>
                    <div class="w-100 text-right my-3">
                        <span (click)="addBank()" class="addMore"
                            style="background: #FF9F43; color: white; border-radius: 2px;">+ Add More Banks</span>
                    </div>
                </div>

                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group row">
                      <div class="col-lg-12">
                        <label>Opening Balance*</label>
                        <div class="input-group">
                          <div>
                            <select formControlName="opening_balance_type" class=" border hov" required id="opening_balance_type"
                              [ngClass]="{'is-invalid': f['opening_balance_type'].touched && f['opening_balance_type'].invalid}">
                              <option class="unhov" value="" selected disabled>Select Balance type</option>
                              <option class="unhov" value="Cr">Cr</option>
                              <option class="unhov" value="Dr">Dr</option>
                            </select>
                            <span class="text-danger d-block"
                              *ngIf="opening_balance_type && opening_balance_type.invalid && opening_balance_type.touched">Select
                              Balance Type</span>
                          </div>
                          <div>
                            <input type="text" formControlName="opening_balance" id="opening_balance"
                              [ngClass]="{'is-invalid': f['opening_balance'].touched && f['opening_balance'].invalid}">
                            <span class="text-danger ml-5 pl-5"
                              *ngIf="opening_balance && opening_balance.invalid && opening_balance.touched">
                              Enter your Balance</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Commision</label>
                        <input type="text" formControlName="commision" id="commision" placeholder="Enter Commision"
                            [ngClass]="{'is-invalid': f['commision'].touched && f['commision'].invalid}">
                        <span class="text-danger" *ngIf="commision && commision.invalid && commision.touched">Enter your
                            Commision value (ex-123)</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Wages</label>
                        <input type="text" formControlName="wages" id="wages" placeholder="Enter Wages"
                            [ngClass]="{'is-invalid': f['wages'].touched && f['wages'].invalid}">
                        <span class="text-danger" *ngIf="wages && wages.invalid && wages.touched">Enter Valid Wages
                            value (ex-123)</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Extra Wages</label>
                        <input type="text" formControlName="extra_wages" id="extra_wages" placeholder="Enter Extra Wages"
                            [ngClass]="{'is-invalid': f['extra_wages'].touched && f['extra_wages'].invalid}">
                        <span class="text-danger"
                            *ngIf="extra_wages && extra_wages.invalid && extra_wages.touched">Enter Valid Extra Wages
                            value (ex-123)</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Target</label>
                        <input type="text" formControlName="target" id="target" placeholder="Enter Target"
                            [ngClass]="{'is-invalid': f['target'].touched && f['target'].invalid}">
                        <span class="text-danger" *ngIf="target && target.invalid && target.touched">Enter Valid Target
                            value (ex-123)</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>UserName*</label>
                        <input type="text" formControlName="username" id="username" placeholder="Enter UserName"
                            [ngClass]="{'is-invalid': f['username'].touched && f['username'].invalid}" [ngStyle]="{'border': userError ? '1px solid red' : ''}">
                        <span class="text-danger" *ngIf="username && username.invalid && username.touched">Enter your
                            UserName</span>
                            <span class="text-danger" *ngIf="userError">{{userError}}</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Password*</label>
                        <input type="text" formControlName="password" id="password" placeholder="Enter Password"
                            [ngClass]="{'is-invalid': f['password'].touched && f['password'].invalid}">
                        <span class="text-danger" *ngIf="password && password.invalid && password.touched">Enter your
                            password</span>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-3 col-12">
                    <div class="form-group">
                        <label>Select User Role</label>
                        <select formControlName="role" id="role" [ngClass]="{
                        'is-invalid': f['role'].touched && f['role'].invalid}">
                            <option value="" selected disabled>Select User Role</option>
                            <option value="{{userRole.id}}" *ngFor="let userRole of groupList">{{userRole.name}}</option>
                        </select>
                        <span class="text-danger" *ngIf="role && role.invalid && role.touched">Select User role</span>
                    </div>
                </div>
                <!-- <div class="col-lg-3 col-sm-3 col-12">
                <div class="form-group">
                    <label>Permission Group</label>
                    <input type="text" formControlName="permission_group" id="permission_group"
                    [ngClass]="{
                      'is-invalid': f['permission_group'].touched && f['permission_group'].invalid
                    }">
                    <span class="text-danger"*ngIf="permission_group && permission_group.invalid && permission_group.touched">Enter Permission group</span>            
                </div>
            </div>

          <div class="col-lg-12 col-sm-12 col-12">
                <div class="form-group">
                    <label>Permission*</label>
                    <div class="dropdown">
                        <button type="button" class="dropdown-toggle button" type="button"
                            data-bs-toggle="dropdown" aria-expanded="false">Select Permission</button>
                        <ul class="dropdown-menu" style="width: 100%;">
                            <li><a class="dropdown-item" *ngFor="let permission of permissionDetails; let i=index">
                                    <input type="checkbox" [value]="permission.id" (change)="onCheckChange($event)" formArrayName="permissions"
                                        style="margin-right: 5px;" [id]="'checkboxSub-' + i">
                                    <label [for]="'checkboxSub-' + i" style="margin-bottom: 0;"
                                        (click)="onLabelClick($event)">{{permission?.name}}</label>
                                </a></li>
                        </ul>
                    </div>
                    <p *ngIf="selectedPermission>0">{{selectedPermission + ' Subcategory Selected'}}</p>
               </div>
            </div>  -->

                <div class="col-lg-3 col-sm-3 col-12 d-flex align-items-center">
                    <div class="form-group mt-4">
                        <div class="d-flex ">
                            <input type="checkbox" formControlName="login_access" [id]="'checkboxTax-'"
                                [ngModel]="true">
                            <label [for]="'checkboxTax-'" class="d_flex"
                                style="margin-bottom: 0; margin-left: 5px;">Login Access</label>
                        </div>
                        <div class="d-flex ">
                            <input type="checkbox" formControlName="apply_tds" [id]="'checkboxMeasure-'"
                                [ngModel]="true">
                            <label [for]="'checkboxMeasure-'" class="d_flex"
                                style="margin-bottom: 0; margin-left: 5px;">Apply TDS</label>
                        </div>
                    </div>
                </div>

                <div class="col-lg-12">
                    <button class="btn btn-submit me-2" *ngIf="!loader">Submit</button>
                    <button class="btn btn-submit me-2" type="submit" *ngIf="loader" disabled>
                    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp; Submit</button>
                    <a routerLink="//contacts/employee" class="btn btn-cancel">Cancel</a>
                </div>
            </div>
        </form>
    </div>
</div>
<!-- /add -->